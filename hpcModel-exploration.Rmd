---
title: "Human-Plant Coevolution (HPC) model<br>General exploration and parameter sensitivity analysis"
authors: "Andreas Angourakis & JonÃ s Alcaina"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
description: "The Human-Plant Coevolution (HPC) model represents the dynamics of coevolution between a human and a plant population. The model consists of an ecological positive feedback system (mutualism), which can be reinforced by positive evolutionary feedback (coevolution). The model is the result of wiring together relatively simple simulation models of population ecology and evolution, through a computational implementation in R."
url: 'https://andros-spica.github.io/hpcModel/'
github-repo: Andros-Spica/hpcModel
cover-image: images/hpcModel-logo_v2.png
documentclass: book
always_allow_html: yes
urlcolor: blue
params:
  ispdf: TRUE
---

# _______ { - }

```{r cover-logo, echo=FALSE, eval=!params$ispdf, out.width = '100%'}
knitr::include_graphics("images/hpcModel-logo_v2.png")
```

# Model overview { - }

The Human-Plant Coevolution (HPC) model represents the dynamics of coevolution between a human and a plant population. The model consists of an ecological positive feedback system (mutualism), which can be reinforced by positive evolutionary feedback (coevolution). The model is the result of wiring together relatively simple simulation models of population ecology and evolution, through a computational implementation in R.

\newpage

**_Parameters_**

 R notation     | Math notation | Description
 -------------- | ------------- | ---------------------
 `iniH`, `iniP` | $ini_{H},\,ini_{P}$ | **initial populations of humans and plants**  
 `n.H`, `n.P`   | $n_{H},\,n_{P}$ | **number of types of humans and plants**. The number of phenotypic variants of each population that relate to human-plant coevolution. Types are arbitrarily ordered from type $1$ (*less* mutualistic) to type $n$ (*more* mutualistic).  
 `v.H`, `v.P`   | $v_{H},\,v_{P}$ | **level of undirected variation in humans and plants**. For any value greater than zero, these parameters regulate how even is the distribution of a population among its types.  
 `r.H`, `r.P`   | $r_{H},\,r_{P}$ | **intrinsic growth rates for human and plant populations**. The maximum rate at which a population grows when there are no external constraints.  
 `mU.PnH`       | $\bar{U}_{P_{n}H}$ | utility per capita of **type** $n$ **plants** to **humans**  
 `mU.HnP`       | $\bar{U}_{H_{n}P}$ | utility per capita of **type** $n$ **humans** to **plants**  
 `mU.P1H`       | $\bar{U}_{P_{1}H}$ | utility per capita of **type** $1$ **plants** to **humans**  
 `mU.H1P`       | $\bar{U}_{H_{1}P}$ | utility per capita of **type** $1$ **humans** to **plants**  
 `U.bH1`       | $U_{bH_{1}}$ | utility of **other resources** to **type** $1$ **humans** or the baseline carrying capacity for humans of type $1$; i.e. that independent of plants.    
 `U.bP1`       | $U_{bP_{1}}$ | utility of **other resources** to **type** $1$ **plants** or the baseline carrying capacity for plants of type $1$; i.e. that independent of humans.   (non-anthropic space)  
 `U.bHn`       | $U_{bH_{n}}$ | utility of **other resources** to **type** $n$ **humans** or the baseline carrying capacity for humans of type $n$, i.e. that independent of plants  
 `U.bPn`       | $U_{bP_{n}}$ | utility of **other resources** to **type** $n$ **plants** or the baseline carrying capacity for plants of type $n$; i.e. that independent of humans.  
 `MaxArea`      | $MaxArea$ | **Maximum contiguous area to be used by plants**. It is used as the maximum carrying capacity for plants.  

Table: Parameters

\newpage

R notation              | Math notation | Description 
 ---------------------- | ------------- | ---------------------
 `H`, `P`               | $H[t],\,P[t]$ | **Human and plant populations** at time $t$. Population units are abstract, arbitrarily defined units that can express individuals, working hours, households, etc. (humans), and sprouts, certain amount of biomass, soil surface, etc. (plants)  
 `K.H`, `K.P`           | $K_{H}[t],\,K_{P}[t]$ | **Carrying capacity** to human and plant populations or maximum population at time $t$, expressed in population units  
 `U.HP`, `U.PH`         | $U_{HP}[t],\,U_{PH}[t]$ | **Utility of one population to the other** or the total contribution of a population to the maximum population at time $t$, expressed in population units  
 `U.bH`, `U.bP`         | $U_{bH}[t],\,U_{bP}[t]$ | **Utility of other resources to a population** at time $t$, expressed in population units (baseline carrying capacity)  
 `types.H`, `types.P`         | $types_{H},\,types_{P}$ | Population types, arbitrarily ordered from $1$ to $n$ (vector or array).  
 `pop.H`, `pop.P`         | $pop_{H_{i}}[t],\,pop_{P_{i}}[t]$ | **Proportion of a population** belonging to type $i$ at time $t$ (vector or array).  
 `mU.HP.per.type`, `mU.PH.per.type`         | $\bar{U}_{H_{i}P},\,\bar{U}_{P_{i}H}$ | **Utility per capita** of type $i$ individuals of one population to the other (vector or array).  
 `U.bH.per.type`, `U.bP.per.type`         | $U_{bH_{i}},\,U_{bP_{i}}$ | **Utility of other resources** to type $i$ individuals of a population (vector or array).  
 `fitness.H`, `fitness.P`         | $fitness_{H_{i}}[t],\,fitness_{P_{i}}[t]$ | **Fitness score** of type $i$ individuals of a population at time $t$ (vector or array).  
 `d.H`, `d.P`         | $\Delta H[t],\,\Delta P[t]$ | **Population change** (*delta*) at time $t$ in respect to time $t -1$ (vector or array).  

Table: Variables

\newpage

 R notation             | Math notation | Description        
 ---------------------- | ------------- | ---------------------
 `coevo.H`, `coevo.P`   | $coevo_{H},\,coevo_{P}$ | **Coevolution coefficients**. A coefficient representing the distribution of the proportion of a population  per type ($pop_{A_1}$ to $pop_{A_n}$) weighted by type index ($1$ to $n$). Each indicates *if* and *how much* the population distribution has been modified by the coevolutionary process. Their values range between -1, the entire population is of type $1$, and 1, the entire population is of type $n$.  
 `depend.H`, `depend.P` | $depend_{H},\,depend_{P}$ | **Dependency coefficients**. The slope of the linear model of the fitness score per type ($fitness_{A_1}$ to $fitness_{A_n}$) using type index ($1$ to $n$). Indicate *if* and *how much* the overall fitness score of a population is dependent on the other population.  
 `timing.H`, `timing.P` | $timing_{H},\,timing_{P}$ | **Iterations past** until **coevolution** successfully changes the proportions of population per type; generally, when $pop_{A_1}\gg pop_{A_n}$ or, more specifically, $coevo_A>timing.threshold$.  
 `time`                 | $t_{end}$ | **Iterations past** until the **end state** (*stationary point*)

Table: Variables (output only)

<!--chapter:end:index.Rmd-->

---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Single runs

```{r 1_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(kableExtra)
```

```{r 1_table-functions}
source("library/plotting/run.table.R")
source("library/plotting/exp.table.R")
```

```{r 1_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
iniH.default = 10
iniP.default = 10
# number of discrete types
n.H.default = 30
n.P.default = 30    
# undirected variation 
v.H.default = 0.15
v.P.default = 0.15
# intrinsic growth rate 
r.H.default = 0.04
r.P.default = 0.1
# Utility per capita of individuals of type N
mU.PnH.default = 1.5
mU.HnP.default = 1
# Utility per capita of individuals of type 1
mU.P1H.default = 0.15                           
mU.H1P.default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
U.bHn.default = 10                               
U.bPn.default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
U.bH1.default = 80                               
U.bP1.default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
MaxArea.default = 200
# settings 
# simulation flow & data
maxIt.default = 5000
tol.default = 6
timing.threshold.default = 0.5
saveTrajectories.default = TRUE
messages.default = TRUE
```

```{r 1_plot-functions, include=FALSE}
# this chunk is specific for this exploration 

# for creating animates GIF, you need to install purrr and magick packages.

runPlot.dir <- "plots/runPlot/" # directory holding animation files

source("library/plotting/plot.trajectory.R")
source("library/plotting/animate.trajectory.R")
```

Attractors are system stable states, in which all variables become, at some level, predictable (i.e., they attract trajectories). For most of the conditions explored, the HPC model displays stationary points, which are attractors where variables converge and do not change unless the system is perturbed.

Another kind of attractor, oscillations, exists. A special case of oscillation occurs when either the iteration unit or at least one of the intrinsic growth rates are greater than the unit ( dt > 1 or rA > 1 ). Such behaviour is a common feature of logistic growth models and was already observed and analysed by Hastings (1997). More interestingly, certain, less extreme parameter configurations also produce oscillatory states (see last section in this chapter). 


\newpage

## Fast coevolution (default)

```{r 1_run.coevo.coeta-name, cache=TRUE}
run.coevo.coeta.name <- "coevo.coeta"
```

```{r 1_run.coevo.coeta, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.coevo.coeta-name')}

run.coevo.coeta <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.save = FALSE
)
```

```{r 1runcoevocoetaparshtml, eval=!params$ispdf, cache=TRUE, dependson=c('1_table-functions', 'run.coevo.coeta'), fig.align='center', results='asis'}
run.table(run.coevo.coeta, caption = 'Parameter setting')
```

```{r 1runcoevocoetaparspdf, eval=params$ispdf, cache=TRUE, dependson=c('1_table-functions', 'run.coevo.coeta'), fig.align='center', results='asis'}
run.table(run.coevo.coeta, caption = 'Parameter setting', output = "latex")
```

\vspace{1cm}

 Abbreviation | Value                                                            
 ------------ | ---------------------
 `time`       | `r run.coevo.coeta$END$time`
 `coevo.H`    | `r run.coevo.coeta$END$coevo.H`
 `coevo.P`    | `r run.coevo.coeta$END$coevo.P`
 `depend.H`   | `r run.coevo.coeta$END$depend.H`
 `depend.P`   | `r run.coevo.coeta$END$depend.P`
 `timing.H`   | `r run.coevo.coeta$END$timing.H`
 `timing.P`   | `r run.coevo.coeta$END$timing.P`

Table: Output variables (values at end state)

\newpage

```{r 1runcoevocoetaplot, cache=TRUE, dependson='run.coevo.coeta', fig.width=8, fig.height=8, fig.cap='Plotting the end state, i.e. both populations become stationary'}
hpcModel.plot(run.coevo.coeta, scale.override = 1)
```

\newpage

```{r 1_run.coevo.coeta-ggplot, warning=FALSE, cache=TRUE, dependson=c('1_plot-functions', 'run.coevo.coeta')}
run.coevo.coeta.melted <-
  data.frame(H = run.coevo.coeta$TRAJECTORIES$H, 
             P = run.coevo.coeta$TRAJECTORIES$P)[!is.na(run.coevo.coeta$TRAJECTORIES$H), ]

run.coevo.coeta.melted$time <- 1:nrow(run.coevo.coeta.melted)

run.coevo.coeta.melted <- melt(run.coevo.coeta.melted, measure.vars = c('H', 'P'))

plotScale = 10
#svg('plots/1_singleRun-ggplot.svg', width=plotScale, height=plotScale)
png(paste0("plots/1_singleRun-ggplot-", run.coevo.coeta.name, ".png"), 
    width = 200 * plotScale, height = 100 * plotScale)
plot.trajectory(run.coevo.coeta.melted, plotScale = plotScale)
invisible(dev.off())
```

```{r 1runcoevocoetaggplotprint, echo=FALSE, dependson='run.coevo.coeta-ggplot', out.width = '100%', fig.cap='Plotting population trajectories with ggplot2'}
knitr::include_graphics(paste0("plots/1_singleRun-ggplot-", run.coevo.coeta.name, ".png"))
```

\newpage

```{r 1_run.coevo.coeta-frames, include=FALSE, dependson=c('1_default-values', '1_run.coevo.coeta-name')}
run.coevo.coeta2 <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default,   
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.coevo.coeta.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.coevo.coeta.name)
```

```{r 1runcoevocoetaanimation, eval=!params$ispdf, dependson='run.coevo.coeta-frames', fig.cap='Animated GIF showing the sequence of states throughout the simulation (only on the html version)'}
knitr::include_graphics(paste0(runPlot.dir, run.coevo.coeta.name, "-anim.gif"))
```

\FloatBarrier
\newpage

## No coevolution

```{r 1_run.no.coevo-name, cache=TRUE}
run.no.coevo.name <- "no.coevo"
```

```{r 1_run.no.coevo, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.no.coevo-name')}

run.no.coevo <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = 0, # utility of type 1 plants has utility zero                      
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.no.coevo.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.no.coevo.name)
```

```{r 1_run.no.coevo-animation, eval=!params$ispdf, dependson='run.no.coevo'}
knitr::include_graphics(paste0(runPlot.dir, run.no.coevo.name, "-anim.gif"))
```

```{r 1_run.no.coevo-plot, cache=TRUE, eval=params$ispdf, dependson='run.no.coevo', fig.width=8, fig.height=8}
hpcModel.plot(run.no.coevo, scale.override = 1)
```

\newpage

## Coevolution with early cultivation

```{r 1_run.coevo.early.cult-name, cache=TRUE}
run.coevo.early.cult.name <- "coevo.early.cult"
```

```{r 1_run.coevo.early.cult, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.coevo.early.cult-name')}

run.coevo.early.cult <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = 2, # utility type n plant is higher than default
  mU.HnP = mU.HnP.default,
  mU.P1H = 1, # lutility type 1 plant is higher than default
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.coevo.early.cult.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.coevo.early.cult.name)
```

```{r 1_run.coevo.early.cult-animation, eval=!params$ispdf, dependson='run.coevo.early.cult'}
knitr::include_graphics(paste0(runPlot.dir, run.coevo.early.cult.name, "-anim.gif"))
```

```{r 1_run.coevo.early.cult-plot, cache=TRUE, eval=params$ispdf, dependson='run.coevo.early.cult', fig.width=8, fig.height=8}
hpcModel.plot(run.coevo.early.cult, scale.override = 1)
```

\newpage

## Coevolution with early domestication

```{r 1_run.coevo.early.dom-name, cache=TRUE}
run.coevo.early.dom.name <- "coevo.early.dom"
```

```{r 1_run.coevo.early.dom, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.coevo.early.dom-name')}

run.coevo.early.dom <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = 1, # utility type n plant is the same than type 1 plants
  mU.HnP = mU.HnP.default,
  mU.P1H = 1, # utility type 1 plant is the same than type n plants
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = 20, # baseline carrying capacity of type 1 plant is the same than type n plants
  MaxArea = MaxArea.default,
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.coevo.early.dom.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.coevo.early.dom.name)
```

```{r 1_run.coevo.early.dom-animation, eval=!params$ispdf, dependson='run.coevo.early.dom'}
knitr::include_graphics(paste0(runPlot.dir, run.coevo.early.dom.name, "-anim.gif"))
```

```{r 1_run.coevo.early.dom-plot, cache=TRUE, eval=params$ispdf, dependson='run.coevo.early.dom', fig.width=8, fig.height=8}
hpcModel.plot(run.coevo.early.dom, scale.override = 1)
```

\newpage

## Cultivation without domestication

```{r 1_run.cult.without.dom-name, cache=TRUE}
run.cult.without.dom.name <- "cult.without.dom"
```

```{r 1_run.cult.without.dom, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.cult.without.dom-name')}

run.cult.without.dom <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = 2.5, # utility type n plant is higher than default
  mU.HnP = 0.45, # utility type n humans is lower than default
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.cult.without.dom.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.cult.without.dom.name)
```

```{r 1_run.cult.without.dom-animation, eval=!params$ispdf, dependson='run.cult.without.dom'}
knitr::include_graphics(paste0(runPlot.dir, run.cult.without.dom.name, "-anim.gif"))
```

```{r 1_run.cult.without.dom-plot, cache=TRUE, eval=params$ispdf, dependson='run.cult.without.dom', fig.width=8, fig.height=8}
hpcModel.plot(run.cult.without.dom, scale.override = 1)
```

\newpage

## Coevolution with population "bleep"

```{r 1_run.coevo.bleep-name, cache=TRUE}
run.coevo.bleep.name <- "coevo.bleep"
```

```{r 1_run.coevo.bleep, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.coevo.bleep-name')}

run.coevo.bleep <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = 110, # MaxArea is lower than default
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.coevo.bleep.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.coevo.bleep.name)
```

```{r 1_run.coevo.bleep-animation, eval=!params$ispdf, dependson='run.coevo.bleep'}
knitr::include_graphics(paste0(runPlot.dir, run.coevo.bleep.name, "-anim.gif"))
```

```{r 1_run.coevo.bleep-plot, cache=TRUE, eval=params$ispdf, dependson='run.coevo.bleep', fig.width=8, fig.height=8}
hpcModel.plot(run.coevo.bleep, scale.override = 1)
```

\newpage

## Coevolution with population "boom"

```{r 1_run.coevo.boom-name, cache=TRUE}
run.coevo.boom.name <- "coevo.boom"
```

```{r 1_run.coevo.boom, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.coevo.boom-name')}

run.coevo.boom <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = 2, # utility type n plant is higher than default
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = 500, # MaxArea is higher than default
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.coevo.boom.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.coevo.boom.name)
```

```{r 1_run.coevo.boom-animation, eval=!params$ispdf, dependson='run.coevo.boom'}
knitr::include_graphics(paste0(runPlot.dir, run.coevo.boom.name, "-anim.gif"))
```

```{r 1_run.coevo.boom-plot, cache=TRUE, eval=params$ispdf, dependson='run.coevo.boom', fig.width=8, fig.height=8}
hpcModel.plot(run.coevo.boom, scale.override = 1)
```

\newpage

## Coevolution with long population "boom"

```{r 1_run.coevo.long.boom-name, cache=TRUE}
run.coevo.long.boom.name <- "coevo.long.boom"
```

```{r 1_run.coevo.long.boom, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.coevo.long.boom-name')}

run.coevo.long.boom <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = 1, # utility type n plant is the same than type 1 plants
  mU.HnP = mU.HnP.default,
  mU.P1H = 1, # utility type 1 plant is the same than type n plants
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = 1000, # MaxArea is much higher than default
  maxIt = 2000, # this is a dangerously long simulation!!!
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.coevo.long.boom.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.coevo.long.boom.name)
```

```{r 1_run.coevo.long.boom-animation, eval=!params$ispdf, dependson='run.coevo.long.boom'}
knitr::include_graphics(paste0(runPlot.dir, run.coevo.long.boom.name, "-anim.gif"))
```

```{r 1_run.coevo.long.boom-plot, cache=TRUE, eval=params$ispdf, dependson='run.coevo.long.boom', fig.width=8, fig.height=8}
hpcModel.plot(run.coevo.long.boom, scale.override = 1)
```

\newpage

## Semi-coevolution (stationary point)

```{r 1_run.semicoevo-name, cache=TRUE}
run.semicoevo.name <- "semicoevo"
```

```{r 1_run.semicoevo, cache=TRUE, include=FALSE, dependson=c('1_default-values', 'run.semicoevo-name')}

run.semicoevo <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = 0.5, # utility type n plant is the same than type 1 plants and lower than default
  mU.HnP = mU.HnP.default,
  mU.P1H = 0.5, # utility type 1 plant is the same than type n plants and higher than default
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.semicoevo.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.semicoevo.name)
```

```{r 1_run.semicoevo-animation, eval=!params$ispdf, dependson='run.semicoevo'}
knitr::include_graphics(paste0(runPlot.dir, run.semicoevo.name, "-anim.gif"))
```

```{r 1_run.semicoevo-plot, cache=TRUE, eval=params$ispdf, dependson='run.semicoevo', fig.width=8, fig.height=8}
hpcModel.plot(run.semicoevo, scale.override = 1)
```

\newpage

## Semi-coevolution (oscillations)

```{r 1_run.semicoevo.osc1-name, cache=TRUE}
run.semicoevo.osc1.name <- "semicoevo.osc1"
```

```{r 1_run.semicoevo.osc1-frames, include=FALSE, dependson=c('1_default-values', '1_run.semicoevo.osc1-name')}
run.semicoevo.osc1 <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,#10,         
  n.P = n.P.default,#10,        
  v.H = v.H.default,
  v.P = v.P.default, 
  r.H = r.H.default,
  r.P = r.P.default, 
  mU.PnH = 0.5, # utility type n plant is the same than type 1 plants and lower than default
  mU.HnP = 0.9, # utility type n humans is lower than default
  mU.P1H = 0.5, # utility type 1 plant is the same than type n plants and higher than default
  mU.H1P = mU.H1P.default,                                   
  U.bHn = 20, # baseline carrying capacity for type n humans is higher than default
  U.bPn = U.bPn.default, 
  U.bH1 = 100, # baseline carrying capacity for type 1 humans is higher than default
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = 2000, # limit iterations
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.semicoevo.osc1.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.semicoevo.osc1.name)
```

```{r 1_run.semicoevo.osc1-animation, eval=!params$ispdf, dependson='run.semicoevo.osc1'}
knitr::include_graphics(paste0(runPlot.dir, run.semicoevo.osc1.name, "-anim.gif"))
```

```{r 1_run.semicoevo.osc1-plot, cache=TRUE, eval=params$ispdf, dependson='run.semicoevo.osc1', fig.width=8, fig.height=8}
hpcModel.plot(run.semicoevo.osc1, scale.override = 1)
```

```{r 1_run.semicoevo.osc2-name, cache=TRUE}
run.semicoevo.osc2.name <- "semicoevo.osc2"
```

```{r 1_run.semicoevo.osc2-frames, include=FALSE, dependson=c('1_default-values', '1_run.semicoevo.osc2-name')}
run.semicoevo.osc2 <- hpcModel.run(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = 10,         
  n.P = 10,        
  v.H = v.H.default,
  v.P = v.P.default, 
  r.H = 0.15,
  r.P = 0.15, 
  mU.PnH = 1,
  mU.HnP = 0.5, # utility type n humans is the same than type 1
  mU.P1H = 0.2,
  mU.H1P = 0.5,
  U.bHn = 10,
  U.bPn = 10, 
  U.bH1 = 100,
  U.bP1 = 100,
  MaxArea = MaxArea.default, 
  maxIt = 2000, # limit iterations
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  saveTrajectories = saveTrajectories.default,
  messages = messages.default, 
  # plotting
  plot.preview = FALSE, 
  plot.sleep = 0.05,
  plot.save = TRUE,
  plot.saveEvery = 5,
  plot.directory = runPlot.dir,
  plot.fileName = paste0(run.semicoevo.osc2.name, "-runPlot")
)

# Generate an animated GIF using the images in plot.directory folder
animate.trajectory(runPlot.dir, run.semicoevo.osc2.name)
```

```{r 1_run.semicoevo.osc2-animation, eval=!params$ispdf, dependson='run.semicoevo.osc2'}
knitr::include_graphics(paste0(runPlot.dir, run.semicoevo.osc2.name, "-anim.gif"))
```

```{r 1_run.semicoevo.osc2-plot, cache=TRUE, eval=params$ispdf, dependson='run.semicoevo.osc2', fig.width=8, fig.height=8}
hpcModel.plot(run.semicoevo.osc2, scale.override = 1)
```

<!--chapter:end:1_singleRunExploration.Rmd-->

---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# One parameter exploration

```{r 2_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(kableExtra)
```

```{r 2_table-functions}
source("library/plotting/run.table.R")
source("library/plotting/exp.table.R")
```

```{r 2_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
iniH.default = 10
iniP.default = 10
# number of discrete types
n.H.default = 30
n.P.default = 30    
# undirected variation 
v.H.default = 0.15
v.P.default = 0.15
# intrinsic growth rate 
r.H.default = 0.04
r.P.default = 0.1
# Utility per capita of individuals of type N
mU.PnH.default = 1.5
mU.HnP.default = 1
# Utility per capita of individuals of type 1
mU.P1H.default = 0.15                           
mU.H1P.default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
U.bHn.default = 10                               
U.bPn.default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
U.bH1.default = 80                               
U.bP1.default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
MaxArea.default = 200
# settings 
# simulation flow & data
maxIt.default = 5000
tol.default = 6
timing.threshold.default = 0.5
saveTrajectories.default = TRUE
messages.default = TRUE
```

```{r 2_plot-functions, include=FALSE}
# this chunk is specific for this exploration 
source("library/plotting/bifurcation.plot.R")
```

\newpage

## Full example (table+plot alternatives)

### utility per capita **of** type n plants **to** humans ($\bar{U}_{P_{n}H}$):

```{r 2_mU.PnH-values, cache=TRUE}
exp.mU.PnH.name <- "mU.PnH"
SEQ.mU.PnH <- seq(0.5, 2.5, length.out = 100)
```

```{r 2_mU.PnH, cache=TRUE, dependson=c('2_default-values', '2_mU.PnH-values'), include=FALSE}
exp.mU.PnH <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = SEQ.mU.PnH, ###
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2mUPnHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('2_table-functions', '2_mU.PnH')}
exp.table(exp.mU.PnH, caption = 'Parameter setting')
```

```{r 2mUPnHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('2_table-functions', '2_mU.PnH')}
exp.table(exp.mU.PnH, caption = 'Parameter setting', output = "latex")
```

```{r 2_mU.PnH-bifplot1, cache=TRUE, dependson=c('2_plot-functions', '2_mU.PnH'), include=FALSE}
plotScale = 10
#svg('paste0("plots/2_onePar-", exp1.name, "_ggbifplot.png"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.PnH.name, "_ggbifplot.png"),
    width = 200 * plotScale, height = 100 * plotScale)
bifurcation.plot.simple(SEQ.mU.PnH, 
                        cbind(exp.mU.PnH$coevo.H, exp.mU.PnH$coevo.P),
                        legendPos = c(2.2, 0),
                        xlab = expression(paste('utility per capita of type n plants to humans (', bar('U')['PnH'], ')')),
                        ylab = "coevolution coefficient",
                        variableNames = c("Humans", "Plants"),
                        cex = plotScale
                        )
dev.off()
```

```{r 2mUPnHbifplot1print, echo=FALSE, dependson='2_mU.PnH-bifplot1', out.width = '100%', fig.cap='Bifurcation plot (ggplot2)'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.PnH.name, "_ggbifplot.png"))
```

```{r 2_mU.PnH-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_mU.PnH'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.mU.PnH.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.PnH.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.mU.PnH, exp.mU.PnH$coevo.H), 
                      cbind(SEQ.mU.PnH, exp.mU.PnH$coevo.P), 
                      parameterLabel = expression(paste('utility per capita of type n plants to humans (', bar('U')['PnH'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_mU.PnH-bifplot2-print, echo=FALSE, dependson='2_mU.PnH-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.PnH.name, "_bifplot-pair.png"))
```

\newpage

## Exploration on 'default' setting for each parameter:

### Initial populations of humans and plants ($init_{H},\,init_{P}$)

```{r 2_init-values, cache=TRUE}
exp.init.H.name <- "init.H"
exp.init.P.name <- "init.P"
SEQ.init.H <- 5:100
SEQ.init.P <- 5:100
```

```{r 2_init.H, cache=TRUE, dependson=c('2_default-values', '2_init-values'), include=FALSE}
exp.init.H <- hpcModel.exploration(
  iniH = SEQ.init.H, ###
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_init.P, cache=TRUE, dependson=c('2_default-values', '2_init-values'), include=FALSE}
exp.init.P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = SEQ.init.P, ###
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_init.H-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_init.H'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.init.H.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.init.H.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.init.H, exp.init.H$coevo.H), 
                      cbind(SEQ.init.H, exp.init.H$coevo.P), 
                      parameterLabel = expression(paste('Initial human population (',
                                                'ini'['H'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_init.P-bifplot2, cache=TRUE, dependson='2_init.P', results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.init.P.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.init.P.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.init.P, exp.init.P$coevo.H), 
                      cbind(SEQ.init.P, exp.init.P$coevo.P), 
                      parameterLabel = expression(paste('Initial plant population (',
                                                'ini'['P'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_init.H-bifplot2-print, echo=FALSE, dependson='2_init.H-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.init.H.name, "_bifplot-pair.png"))
```

```{r 2_init.P-bifplot2-print, echo=FALSE, dependson='2_init.P-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.init.P.name, "_bifplot-pair.png"))
```

### Number of types of humans and plants ($n_{H},\,n_{P}$):

```{r 2_n-values, cache=TRUE}
exp.n.H.name <- "n.H"
exp.n.P.name <- "n.P"
SEQ.n.H <- 5:40
SEQ.n.P <- 5:40
```

```{r 2_n.H, cache=TRUE, dependson=c('2_default-values','2_n-values'), include=FALSE}
exp.n.H <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = SEQ.n.H, ###
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_n.P, cache=TRUE, dependson=c('2_default-values', '2_n-values'), include=FALSE}
exp.n.P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = SEQ.n.P, ###
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_n.H-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_n.H'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp1.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.n.H.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.n.H, exp.n.H$coevo.H), 
                      cbind(SEQ.n.H, exp.n.H$coevo.P), 
                      parameterLabel = expression(paste('number of human types (',
                                                'n'['H'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_n.P-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_n.P'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.n.P.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.n.P.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.n.P, exp.n.P$coevo.H), 
                      cbind(SEQ.n.P, exp.n.P$coevo.P), 
                      parameterLabel = expression(paste('number of plant types (',
                                                'n'['P'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_n.H-bifplot2-print, echo=FALSE, dependson='2_n.H-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.n.H.name, "_bifplot-pair.png"))
```

```{r 2_n.P-bifplot2-print, echo=FALSE, dependson='2_n.P-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.n.P.name, "_bifplot-pair.png"))
```

### level of undirected variation in humans and plants ($v_{H},\,v_{P}$):

```{r 2_v-values, cache=TRUE}
exp.v.H.name <- "v.H"
exp.v.P.name <- "v.P"
SEQ.v.H <- seq(0.05, 0.25, length.out = 100)
SEQ.v.P <- seq(0.05, 0.25, length.out = 100)
```

```{r 2_v.H, cache=TRUE, dependson=c('2_default-values', '2_v-values'), include=FALSE}
exp.v.H <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = SEQ.v.H, ###
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_v.P, cache=TRUE, dependson=c('2_default-values', '2_v-values'), include=FALSE}
exp.v.P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = SEQ.v.P, ###
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_v.H-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_v.H'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.v.H.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.v.H.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.v.H, exp.v.H$coevo.H), 
                      cbind(SEQ.v.H, exp.v.H$coevo.P), 
                      parameterLabel = expression(paste('undirected variation in humans (',
                                                'v'['H'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_v.P-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_v.P'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.v.P.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.v.P.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.v.P, exp.v.P$coevo.H), 
                      cbind(SEQ.v.P, exp.v.P$coevo.P), 
                      parameterLabel = expression(paste('undirected variation in plants (',
                                                'v'['P'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_v.H-bifplot2-print, echo=FALSE, dependson='2_v.H-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.v.H.name, "_bifplot-pair.png"))
```

```{r 2_v.P-bifplot2-print, echo=FALSE, dependson='2_v.P-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.v.P.name, "_bifplot-pair.png"))
```

### intrinsic growth rates for human and plant populations ($r_{H},\,r_{P}$):

```{r 2_r-values, cache=TRUE}
exp.r.H.name <- "r.H"
exp.r.P.name <- "r.P"
SEQ.r.H <- seq(0.01, 0.25, length.out = 100)
SEQ.r.P <- seq(0.01, 0.25, length.out = 100)
```

```{r 2_r.H, cache=TRUE, dependson=c('2_default-values', '2_r-values'), include=FALSE}
exp.r.H <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = SEQ.r.H, ###
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_r.P, cache=TRUE, dependson=c('2_default-values', '2_r-values'), include=FALSE}
exp.r.P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = SEQ.r.P, ###
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_r.H-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_r.H'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.r.H.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.r.H.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.r.H, exp.r.H$coevo.H), 
                      cbind(SEQ.r.H, exp.r.H$coevo.P), 
                      parameterLabel = expression(paste('human instrinsic growth rate (',
                                                'r'['H'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_r.P-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_r.P'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.r.P.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.r.P.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.r.P, exp.r.P$coevo.H), 
                      cbind(SEQ.r.P, exp.r.P$coevo.P), 
                      parameterLabel = expression(paste('plant instrinsic growth rate (',
                                                'r'['P'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_r.H-bifplot2-print, echo=FALSE, dependson='2_r.H-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.r.H.name, "_bifplot-pair.png"))
```

```{r 2_r.P-bifplot2-print, echo=FALSE, dependson='2_r.P-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.r.P.name, "_bifplot-pair.png"))
```

### utility per capita **of** type n plants **to** humans ($\bar{U}_{P_{n}H}$):

```{r 2_mU.PnH-bifplot2-print2, echo=FALSE, dependson='2_mU.PnH-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.PnH.name, "_bifplot-pair.png"))
```

### utility per capita **of** type n human **to** plants ($\bar{U}_{H_{n}P}$):

```{r 2_mU.HnP-values, cache=TRUE}
exp.mU.HnP.name <- "mU.HnP"
SEQ.mU.HnP <- seq(0, 1.5, length.out = 100)
```

```{r 2_mU.HnP, cache=TRUE, dependson=c('2_default-values', '2_mU.HnP-values'), include=FALSE}
exp.mU.HnP <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = SEQ.mU.HnP, ###
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_mU.HnP-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_mU.HnP'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.mU.HnP.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.HnP.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.mU.HnP, exp.mU.HnP$coevo.H), 
                      cbind(SEQ.mU.HnP, exp.mU.HnP$coevo.P), 
                      parameterLabel = expression(paste('utility per capita of type n human to plants (', bar('U')['HnP'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_mU.HnP-bifplot2-print, echo=FALSE, dependson='2_mU.HnP-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.HnP.name, "_bifplot-pair.png"))
```

### utility per capita **of** type 1 plants **to** humans ($\bar{U}_{P_{1}H}$):

```{r 2_mU.P1H-values, cache=TRUE}
exp.mU.P1H.name <- "mU.P1H"
SEQ.mU.P1H <- seq(0, 0.5, length.out = 100)
```

```{r 2_mU.P1H, cache=TRUE, dependson=c('2_default-values', '2_mU.P1H-values'), include=FALSE}
exp.mU.P1H <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = SEQ.mU.P1H, ###
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_mU.P1H-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_mU.P1H'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.mU.P1H.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.P1H.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.mU.P1H, exp.mU.P1H$coevo.H), 
                      cbind(SEQ.mU.P1H, exp.mU.P1H$coevo.P), 
                      parameterLabel = expression(paste('utility per capita of type 1 plants to humans (', bar('U')['P1H'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_mU.P1H-bifplot2-print, echo=FALSE, dependson='2_mU.P1H-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.P1H.name, "_bifplot-pair.png"))
```

### utility per capita **of** type 1 humans **to** plants ($\bar{U}_{H_{1}P}$):

```{r 2_mU.H1P-values, cache=TRUE}
exp.mU.H1P.name <- "mU.H1P"
SEQ.mU.H1P <- seq(0, 2, length.out = 100)
```

```{r 2_mU.H1P, cache=TRUE, dependson=c('2_default-values', '2_mU.H1P-values'), include=FALSE}
exp.mU.H1P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = SEQ.mU.H1P, ###
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_mU.H1P-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_mU.H1P'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.mU.H1P.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.H1P.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.mU.H1P, exp.mU.H1P$coevo.H), 
                      cbind(SEQ.mU.H1P, exp.mU.H1P$coevo.P), 
                      parameterLabel = expression(paste('utility per capita of type 1 humans to plants (', bar('U')['H1P'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_mU.H1P-bifplot2-print, echo=FALSE, dependson='2_mU.H1P-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.H1P.name, "_bifplot-pair.png"))
```

### utility **of** other resources **to** humans of type 1 ($U_{bH_{1}}$):

```{r 2_U.bH1-values, cache=TRUE}
exp.U.bH1.name <- "U.bH1"
SEQ.U.bH1 <- seq(5, 400, length.out = 100)
```

```{r 2_U.bH1, cache=TRUE, dependson=c('2_default-values', '2_U.bH1-values'), include=FALSE}
exp.U.bH1 <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = SEQ.U.bH1, ###
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_U.bH1-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_U.bH1-exp1'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp1.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.U.bH1.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.U.bH1, exp.U.bH1$coevo.H), 
                      cbind(SEQ.U.bH1, exp.U.bH1$coevo.P), 
                      parameterLabel = expression(paste('Baseline carrying capacity for type 1 humans (', bar(U)['bH'[1]], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_U.bH1-bifplot2-print, echo=FALSE, dependson='2_U.bH1-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.U.bH1.name, "_bifplot-pair.png"))
```

### utility **of** non-anthropic space **to** type 1 plants ($U_{bP_{1}}$):

```{r 2_U.bP1-values, cache=TRUE}
exp.U.bP1.name <- "U.bP1"
SEQ.U.bP1 <- seq(5, 400, length.out = 100)
```

```{r 2_U.bP1, cache=TRUE, dependson=c('2_default-values', '2_U.bP1-values'), include=FALSE}
exp.U.bP1 <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = SEQ.U.bP1, ###
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_U.bP1-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_U.bP1'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.U.bP1.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.U.bP1.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.U.bP1, exp.U.bP1$coevo.H), 
                      cbind(SEQ.U.bP1, exp.U.bP1$coevo.P), 
                      parameterLabel = expression(paste('utility of non-anthropic space to type 1 plants (', bar('U')['bP1'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_U.bP1-bifplot2-print, echo=FALSE, dependson='2_U.bP1-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.U.bP1.name, "_bifplot-pair.png"))
```

### utility **of** other resources **to** type n humans ($U_{bH_{n}}$):

```{r 2_U.bHn-values, cache=TRUE}
exp.U.bHn.name <- "U.bHn"
SEQ.U.bHn <- seq(5, 400, length.out = 100)
```

```{r 2_U.bHn, cache=TRUE, dependson=c('2_default-values', '2_U.bHn-values'), include=FALSE}
exp.U.bHn <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = SEQ.U.bHn, ###
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_U.bHn-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_U.bHn'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.U.bHn.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.U.bHn.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.U.bHn, exp.U.bHn$coevo.H), 
                      cbind(SEQ.U.bHn, exp.U.bHn$coevo.P), 
                      parameterLabel = expression(paste('utility of other resources to type n humans (', bar('U')['bHn'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_U.bHn-bifplot2-print, echo=FALSE, dependson='2_U.bHn-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.U.bHn.name, "_bifplot-pair.png"))
```

### utility **of** non-anthropic space **to** type n plants ($U_{bP_{n}}$):

```{r 2_U.bPn-values, cache=TRUE}
exp.U.bPn.name <- "U.bPn"
SEQ.U.bPn <- seq(5, 400, length.out = 100)
```

```{r 2_U.bPn, cache=TRUE, dependson=c('2_default-values', '2_U.bPn-values'), include=FALSE}
exp.U.bPn <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = SEQ.U.bPn, ###
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_U.bPn-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_U.bPn'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.U.bPn.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.U.bPn.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.U.bPn, exp.U.bPn$coevo.H), 
                      cbind(SEQ.U.bPn, exp.U.bPn$coevo.P), 
                      parameterLabel = expression(paste('utility of non-anthropic space to type n plants (', bar('U')['bPn'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_U.bPn-bifplot2-print, echo=FALSE, dependson='2_U.bPn-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.U.bPn.name, "_bifplot-pair.png"))
```

### maximum contiguous area to be used by plants ($MaxArea$):

```{r 2_maxArea-values, cache=TRUE}
exp.MaxArea.name <- "MaxArea"
SEQ.MaxArea <- seq(5, 400, length.out = 100)
```

```{r 2_MaxArea, cache=TRUE, dependson=c('2_default-values', '2_MaxArea-values'), include=FALSE}
exp.MaxArea <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = SEQ.MaxArea, ###
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = messages.default
)
```

```{r 2_MaxArea-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_MaxArea'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.MaxArea.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.MaxArea.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(cbind(SEQ.MaxArea, exp.MaxArea$coevo.H), 
                      cbind(SEQ.MaxArea, exp.MaxArea$coevo.P), 
                      parameterLabel = expression('MaxArea'),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale)
dev.off()
```

```{r 2_MaxArea-bifplot2-print, echo=FALSE, dependson='2_MaxArea-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.MaxArea.name, "_bifplot-pair.png"))
```

---

## Oscilations

```{r 2_osc-values, cache=TRUE, dependson='2_default-values'}
exp.mU.HnP.osc.name <- "mU.HnP.osc"
exp.mU.PnH.osc.name <- "mU.PnH.osc"
SEQ.mU.HnP.osc <- seq(0.1, 1.5, length.out = 100)
SEQ.mU.PnH.osc <- seq(0.1, 1, length.out = 100)
iniH.osc = iniH.default
iniP.osc = iniP.default
n.H.osc = n.H.default
n.P.osc = n.P.default
v.H.osc = v.H.default
v.P.osc = v.P.default
r.H.osc = r.H.default
r.P.osc = r.P.default
mU.PnH.osc = 0.5 ### value for getting oscillation
mU.HnP.osc = 0.9 ### value for getting oscillation
mU.P1H.osc = 0.5 # utility type 1 plant is the same than type n plants and higher than default                            
mU.H1P.osc = mU.H1P.default#0.1                                 
U.bHn.osc = 20 # baseline carrying capacity for type n humans is higher than default
U.bPn.osc = U.bPn.default
U.bH1.osc = 100 # baseline carrying capacity for type 1 humans is higher than default 
U.bP1.osc = U.bP1.default                              
MaxArea.osc = MaxArea.default
maxIt.osc = 1000
tol.osc = Inf
```

Bifurcation plot with last 100 time steps (of `r maxIt.osc`) to capture oscillations or 'slow' asymptotic stability


```{r 2_mU.HnP.osc, cache=TRUE, dependson=c('2_setup','2_osc-values'), include=FALSE}
result.mU.HnP.H <- data.frame()
result.mU.HnP.P <- data.frame()

for (i in SEQ.mU.HnP.osc)
{
  temp <- hpcModel.run(
    iniH = iniH.osc,
    iniP = iniP.osc,
    n.H = n.H.osc,         
    n.P = n.P.osc,        
    v.H = v.H.osc,
    v.P = v.P.osc,
    r.H = r.H.osc, 
    r.P = r.P.osc, 
    mU.PnH = mU.PnH.osc,
    mU.HnP = i, ###
    mU.P1H = mU.P1H.osc,                                  
    mU.H1P = mU.H1P.osc,                                   
    U.bHn = U.bHn.osc,                                
    U.bPn = U.bPn.osc, 
    U.bH1 = U.bH1.osc,                               
    U.bP1 = U.bP1.osc,                                 
    MaxArea = MaxArea.osc, 
    # settings 
    # simulation flow & data
    maxIt = maxIt.osc,
    tol = tol.osc,
    timing.threshold = timing.threshold.default,
    saveTrajectories = saveTrajectories.default,
    messages = messages.default
  )
  
  # store the result
  result.mU.HnP.H <-
    rbind(result.mU.HnP.H, data.frame(i, temp$TRAJECTORIES$coevo.H[(maxIt.osc - 100):(maxIt.osc - 1)]))
  result.mU.HnP.P <-
    rbind(result.mU.HnP.P, data.frame(i, temp$TRAJECTORIES$coevo.P[(maxIt.osc - 100):(maxIt.osc - 1)]))
  
}
```

```{r 2_mU.HnP.osc-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_mU.HnP.osc'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.osc.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.HnP.osc.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(result.mU.HnP.H, result.mU.HnP.P, 
                      parameterLabel = expression(paste('utility per capita of type n humans to plants (', bar('U')['HnP'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale,
                      type = 'p')
dev.off()
```

```{r 2_mU.PnH.osc, cache=TRUE, dependson=c('2_setup','2_osc-values'), include=FALSE}
result.mU.PnH.H <- data.frame()
result.mU.PnH.P <- data.frame()

for (i in SEQ.mU.PnH.osc)
{
  temp <- hpcModel.run(
    iniH = iniH.osc,
    iniP = iniP.osc,
    n.H = n.H.osc,         
    n.P = n.P.osc,        
    v.H = v.H.osc,
    v.P = v.P.osc,
    r.H = r.H.osc, 
    r.P = r.P.osc, 
    mU.PnH = i, ###
    mU.HnP = mU.HnP.osc,
    mU.P1H = mU.P1H.osc,                                  
    mU.H1P = mU.H1P.osc,                                   
    U.bHn = U.bHn.osc,                                
    U.bPn = U.bPn.osc, 
    U.bH1 = U.bH1.osc,                               
    U.bP1 = U.bP1.osc,                                 
    MaxArea = MaxArea.osc, 
    # settings 
    # simulation flow & data
    maxIt = maxIt.osc,
    tol = tol.osc,
    timing.threshold = timing.threshold.default,
    saveTrajectories = saveTrajectories.default,
    messages = messages.default
  )
  
  # store the result
  result.mU.PnH.H <-
    rbind(result.mU.PnH.H, data.frame(i, temp$TRAJECTORIES$coevo.H[(maxIt.osc - 100):(maxIt.osc - 1)]))
  result.mU.PnH.P <-
    rbind(result.mU.PnH.P, data.frame(i, temp$TRAJECTORIES$coevo.P[(maxIt.osc - 100):(maxIt.osc - 1)]))
  
}
```

```{r 2_mU.PnH.osc-bifplot2, cache=TRUE, dependson=c('2_plot-functions', '2_mU.PnH.osc'), results='hide'}
plotScale = 10

#svg(paste0("plots/2_onePar-", exp.osc.name, "_bifplot-pair.svg"), width=plotScale, height=plotScale)
png(paste0("plots/2_onePar-", exp.mU.PnH.osc.name, "_bifplot-pair.png"),
    width = 400 * plotScale, height = 100 * plotScale)
bifurcation.plot.pair(result.mU.PnH.H, result.mU.PnH.P, 
                      parameterLabel = expression(paste('utility per capita of type n plants to humans (', bar('U')['PnH'], ')')),
                      variableLabelH = expression('coevo'['H']),
                      variableLabelP = expression('coevo'['P']),
                      plotScale = plotScale,
                      type = 'p')
dev.off()
```

```{r 2_mU.HnP.osc-bifplot2-print, echo=FALSE, dependson='2_mU.HnP.osc-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.HnP.osc.name, "_bifplot-pair.png"))
```

```{r 2_mU.PnH.osc-bifplot2-print, echo=FALSE, dependson='2_mU.PnH.osc-bifplot2', out.width = '100%'}
knitr::include_graphics(paste0("plots/2_onePar-", exp.mU.PnH.osc.name, "_bifplot-pair.png"))
```

<!--chapter:end:2_oneParameterExploration.Rmd-->

---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Two parameter exploration

```{r 3_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(kableExtra)
```

```{r 3_table-functions}
source("library/plotting/run.table.R")
source("library/plotting/exp.table.R")
```

```{r 3_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
iniH.default = 10
iniP.default = 10
# number of discrete types
n.H.default = 30
n.P.default = 30    
# undirected variation 
v.H.default = 0.15
v.P.default = 0.15
# intrinsic growth rate 
r.H.default = 0.04
r.P.default = 0.1
# Utility per capita of individuals of type N
mU.PnH.default = 1.5
mU.HnP.default = 1
# Utility per capita of individuals of type 1
mU.P1H.default = 0.15                           
mU.H1P.default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
U.bHn.default = 10                               
U.bPn.default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
U.bH1.default = 80                               
U.bP1.default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
MaxArea.default = 200
# settings 
# simulation flow & data
maxIt.default = 5000
tol.default = 6
timing.threshold.default = 0.5
saveTrajectories.default = TRUE
messages.default = TRUE
```

```{r 3_plot-functions, include=FALSE}
# this chunk is specific for this exploration 
source("library/plotting/twoPar.ggplot.R")
```

\newpage

## Full example

### Utility per capita from type n humans and plants ($\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 3_mU.HnP_mU.PnH-values, cache=TRUE}
exp.mU.HnP_mU.PnH.name <- "mU.HnP-mU.PnH"
SEQ.mU.HnP <- seq(0, 3, length.out = 15)
SEQ.mU.PnH <- seq(0, 3, length.out = 15)
```

```{r 3_mU.HnP_mU.PnH, cache=TRUE, dependson=c('3_default-values','3_mU.HnP_mU.PnH-values'), include=FALSE}
exp.mU.HnP_mU.PnH <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = SEQ.mU.PnH, ###
  mU.HnP = SEQ.mU.HnP, ###
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3mUHnPmUPnHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('3_table-functions','3_mU.HnP_mU.PnH')}
exp.table(exp.mU.HnP_mU.PnH, caption = 'Parameter setting')
```

```{r 3mUHnPmUPnHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('3_table-functions','3_mU.HnP_mU.PnH')}
exp.table(exp.mU.HnP_mU.PnH, caption = 'Parameter setting', output = 'latex')
```

\newpage

```{r 3_mU.HnP_mU.PnH-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_mU.HnP_mU.PnH')}
plotScale = 100 / length(SEQ.mU.HnP)

png(paste0("plots/3_twoPar-", exp.mU.HnP_mU.PnH.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.mU.HnP_mU.PnH, 'mU.HnP', 'mU.PnH', 'coevo.H', 'coevo.P', 
              xlab = expression(bar(U)['HnP']),
              ylab = expression(bar(U)['PnH']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_mU.HnP_mU.PnH-plot-print, echo=FALSE, dependson='3_mU.HnP_mU.PnH-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.mU.HnP_mU.PnH.name, "_plot.png"))
```

\newpage

## Exploration on 'default' setting for parameter pairs

### Number of types of humans and plants ($n_{H}$ x $n_{P}$)
\sectionmark{$n_{H}$ x $n_{P}$}

```{r 3_n.H_n.P-values, cache=TRUE}
exp.n.H_n.P.name <- "n.H-n.P"
SEQ.n.H <- seq(3, 42, by = 3)
SEQ.n.P <- seq(3, 42, by = 3)
```

```{r 3_n.H_n.P, cache=TRUE, dependson=c('3_default-values','3_n.H_n.P-values'), include=FALSE}
exp.n.H_n.P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = SEQ.n.H, ###
  n.P = SEQ.n.P, ###
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_n.H_n.P-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_n.H_n.P')}
plotScale = 100 / length(SEQ.n.H)

png(paste0("plots/3_twoPar-", exp.n.H_n.P.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.n.H_n.P, 'n.H', 'n.P', 'coevo.H', 'coevo.P', 
              xlab = expression(n['H']),
              ylab = expression(n['P']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_n.H_n.P-plot-print, echo=FALSE, dependson='3_n.H_n.P-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.n.H_n.P.name, "_plot.png"))
```

\newpage

### Undirected variation in humans and plants ($v_{H}$ x $v_{P}$)
\sectionmark{$v_{H}$ x $v_{P}$}

```{r 3_v.H_v.P-values, cache=TRUE}
exp.v.H_v.P.name <- "v.H-v.P"
SEQ.v.H <- seq(0.05, 0.25, length.out = 15)
SEQ.v.P <- seq(0.05, 0.25, length.out = 15)
```

```{r 3_v.H_v.P, cache=TRUE, dependson=c('3_default-values','3_v.H_v.P-values'), include=FALSE}
exp.v.H_v.P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = SEQ.v.H, ###
  v.P = SEQ.v.P, ###
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default, 
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_v.H_v.P-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_v.H_v.P')}
plotScale = 100 / length(SEQ.v.H)

png(paste0("plots/3_twoPar-", exp.v.H_v.P.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.v.H_v.P, 'v.H', 'v.P', 'coevo.H', 'coevo.P', 
              xlab = expression(v['H']),
              ylab = expression(v['P']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_v.H_v.P-plot-print, echo=FALSE, dependson='3_v.H_v.P-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.v.H_v.P.name, "_plot.png"))
```

\newpage

### Utility per capita from type 1 humans and plants ($\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$)
\sectionmark{$\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$}

```{r 3_mU.H1P_mU.P1H-values, cache=TRUE}
exp.mU.H1P_mU.P1H.name <- "mU.H1P-mU.P1H"
SEQ.mU.H1P <- seq(0, 3, length.out = 15)
SEQ.mU.P1H <- seq(0, 3, length.out = 15)
```

```{r 3_mU.H1P_mU.P1H, cache=TRUE, dependson=c('3_default-values','3_mU.H1P_mU.P1H-values'), include=FALSE}
exp.mU.H1P_mU.P1H <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = SEQ.mU.P1H, ###
  mU.H1P = SEQ.mU.H1P, ###
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_mU.H1P_mU.P1H-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_mU.H1P_mU.P1H')}
plotScale = 100 / length(SEQ.mU.H1P)

png(paste0("plots/3_twoPar-", exp.mU.H1P_mU.P1H.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.mU.H1P_mU.P1H, 'mU.H1P', 'mU.P1H', 'coevo.H', 'coevo.P', 
              xlab = expression(bar(U)['H1P']),
              ylab = expression(bar(U)['P1H']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_mU.H1P_mU.P1H-plot-print, echo=FALSE, dependson='3_mU.H1P_mU.P1H-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.mU.H1P_mU.P1H.name, "_plot.png"))
```

\newpage

### Utility per capita from type n humans and plants ($\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 3_mU.HnP_mU.PnH-plot-print2, echo=FALSE, dependson='3_mU.HnP_mU.PnH-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.mU.HnP_mU.PnH.name, "_plot.png"))
```

\newpage

### Utility per capita from humans to plants ($\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$)
\sectionmark{$\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$}

```{r 3_mU.H1P_mU.HnP-values, cache=TRUE}
exp.mU.H1P_mU.HnP.name <- "mU.H1P-mU.HnP"
SEQ.mU.H1P <- seq(0, 3, length.out = 15)
SEQ.mU.HnP <- seq(0, 3, length.out = 15)
```

```{r 3_mU.H1P_mU.HnP, cache=TRUE, dependson=c('3_default-values','3_mU.H1P_mU.HnP-values'), include=FALSE}
exp.mU.H1P_mU.HnP <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = SEQ.mU.HnP, ###
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = SEQ.mU.H1P, ###
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_mU.H1P_mU.HnP-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_mU.H1P_mU.HnP')}
plotScale = 100 / length(SEQ.mU.H1P)

png(paste0("plots/3_twoPar-", exp.mU.H1P_mU.HnP.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.mU.H1P_mU.HnP, 'mU.H1P', 'mU.HnP', 'coevo.H', 'coevo.P', 
              xlab = expression(bar(U)['H1P']),
              ylab = expression(bar(U)['HnP']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_mU.H1P_mU.HnP-plot-print, echo=FALSE, dependson='3_mU.H1P_mU.HnP-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.mU.H1P_mU.HnP.name, "_plot.png"))
```

\newpage

### Utility per capita from plants to humans ($\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$}

```{r 3_mU.P1H_mU.PnH-values, cache=TRUE}
exp.mU.P1H_mU.PnH.name <- "mU.P1H-mU.PnH"
SEQ.mU.P1H <- seq(0, 3, length.out = 15)
SEQ.mU.PnH <- seq(0, 3, length.out = 15)
```

```{r 3_mU.P1H_mU.PnH, cache=TRUE, dependson=c('3_default-values','3_mU.P1H_mU.PnH-values'), include=FALSE}
exp.mU.P1H_mU.PnH <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = SEQ.mU.PnH, ###
  mU.HnP = mU.HnP.default,
  mU.P1H = SEQ.mU.P1H, ###
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_mU.P1H_mU.PnH-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_mU.P1H_mU.PnH')}
plotScale = 100 / length(SEQ.mU.P1H)

png(paste0("plots/3_twoPar-", exp.mU.P1H_mU.PnH.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.mU.P1H_mU.PnH, 'mU.P1H', 'mU.PnH', 'coevo.H', 'coevo.P', 
              xlab = expression(bar(U)['P1H']),
              ylab = expression(bar(U)['PnH']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_mU.P1H_mU.PnH-plot-print, echo=FALSE, dependson='3_mU.P1H_mU.PnH-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.mU.P1H_mU.PnH.name, "_plot.png"))
```

\newpage

### Utility of other resources to type 1 humans and plants ($U_{bH_{1}}$ x $U_{bP_{1}}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bP_{1}}$}

```{r 3_U.bH1_U.bP1-values, cache=TRUE}
exp.U.bH1_U.bP1.name <- "U.bH1-U.bP1"
SEQ.U.bH1 <- seq(5, 400, length.out = 15)
SEQ.U.bP1 <- seq(5, 400, length.out = 15)
```

```{r 3_U.bH1_U.bP1, cache=TRUE, dependson=c('3_default-values','3_U.bH1_U.bP1-values'), include=FALSE}
exp.U.bH1_U.bP1 <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = U.bPn.default, 
  U.bH1 = SEQ.U.bH1, ###
  U.bP1 = SEQ.U.bP1, ###
  MaxArea = MaxArea.default, 
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bH1_U.bP1-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bH1_U.bP1')}
plotScale = 100 / length(SEQ.U.bH1)

png(paste0("plots/3_twoPar-", exp.U.bH1_U.bP1.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bH1_U.bP1, 'U.bH1', 'U.bP1', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bH1']),
              ylab = expression(U['bP1']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bH1_U.bP1-plot-print, echo=FALSE, dependson='3_U.bH1_U.bP1-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bH1_U.bP1.name, "_plot.png"))
```

\newpage

### Utility of other resources to type n humans and plants ($U_{bH_{n}}$ x $U_{bP_{n}}$)
\sectionmark{$U_{bH_{n}}$ x $U_{bP_{n}}$}

```{r 3_U.bHn_U.bPn-values, cache=TRUE}
exp.U.bHn_U.bPn.name <- "U.bHn-U.bPn"
SEQ.U.bHn <- seq(5, 400, length.out = 15)
SEQ.U.bPn <- seq(5, 400, length.out = 15)
```

```{r 3_U.bHn_U.bPn, cache=TRUE, dependson=c('3_default-values','3_U.bHn_U.bPn-values'), include=FALSE}
exp.U.bHn_U.bPn <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = SEQ.U.bHn, ###
  U.bPn = SEQ.U.bPn, ###
  U.bH1 = U.bH1.default,                               
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bHn_U.bPn-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bHn_U.bPn')}
plotScale = 100 / length(SEQ.U.bHn)

png(paste0("plots/3_twoPar-", exp.U.bHn_U.bPn.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bHn_U.bPn, 'U.bHn', 'U.bPn', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bHn']),
              ylab = expression(U['bPn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bHn_U.bPn-plot-print, echo=FALSE, dependson='3_U.bHn_U.bPn-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bHn_U.bPn.name, "_plot.png"))
```

\newpage

### Utility of other resources to humans ($U_{bH_{1}}$ x $U_{bH_{n}}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bH_{n}}$}

```{r 3_U.bH1_U.bHn-values, cache=TRUE}
exp.U.bH1_U.bHn.name <- "U.bH1-U.bHn"
SEQ.U.bH1 <- seq(5, 400, length.out = 15)
SEQ.U.bHn <- seq(5, 400, length.out = 15)
```

```{r 3_U.bH1_U.bHn, cache=TRUE, dependson=c('3_default-values','3_U.bH1_U.bHn-values'), include=FALSE}
exp.U.bH1_U.bHn <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = SEQ.U.bHn, ###
  U.bPn = U.bPn.default, 
  U.bH1 = SEQ.U.bH1, ###
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bH1_U.bHn-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bH1_U.bHn')}
plotScale = 100 / length(SEQ.U.bHn)

png(paste0("plots/3_twoPar-", exp.U.bH1_U.bHn.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bH1_U.bHn, 'U.bH1', 'U.bHn', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bH1']),
              ylab = expression(U['bHn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bH1_U.bHn-plot-print, echo=FALSE, dependson='3_U.bH1_U.bHn-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bH1_U.bHn.name, "_plot.png"))
```

\newpage

### Utility of other resources to plants ($U_{bP_{1}}$ x $U_{bP_{n}}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bP_{n}}$}

```{r 3_U.bP1_U.bPn-values, cache=TRUE}
exp.U.bP1_U.bPn.name <- "U.bP1-U.bPn"
SEQ.U.bP1 <- seq(5, 400, length.out = 15)
SEQ.U.bPn <- seq(5, 400, length.out = 15)
```

```{r 3_U.bP1_U.bPn, cache=TRUE, dependson=c('3_default-values','3_U.bP1_U.bPn-values'), include=FALSE}
exp.U.bP1_U.bPn <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = mU.H1P.default,                                   
  U.bHn = U.bHn.default,                                
  U.bPn = SEQ.U.bPn, ###
  U.bH1 = U.bH1.default,                               
  U.bP1 = SEQ.U.bP1, ###
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bP1_U.bPn-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bP1_U.bPn')}
plotScale = 100 / length(SEQ.U.bPn)

png(paste0("plots/3_twoPar-", exp.U.bP1_U.bPn.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bP1_U.bPn, 'U.bP1', 'U.bPn', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bP1']),
              ylab = expression(U['bPn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bP1_U.bPn-plot-print, echo=FALSE, dependson='3_U.bP1_U.bPn-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bP1_U.bPn.name, "_plot.png"))
```

### Utility of other resources to type 1 humans and utility per capita of type 1 humans  to plants ($U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$)
\sectionmark{$U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$}

```{r 3_U.bH1_mU.H1P-values, cache=TRUE}
exp.U.bH1_mU.H1P.name <- "U.bH1-mU.H1P"
SEQ.U.bH1 <- seq(5, 400, length.out = 15)
SEQ.mU.H1P <- seq(0, 3, length.out = 15)
```

```{r 3_U.bH1_mU.H1P, cache=TRUE, dependson=c('3_default-values','3_U.bH1_mU.H1P-values'), include=FALSE}
exp.U.bH1_mU.H1P <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                                  
  mU.H1P = SEQ.mU.H1P, ###                                 
  U.bHn = U.bHn.default,
  U.bPn = U.bPn.default, 
  U.bH1 = SEQ.U.bH1, ###
  U.bP1 = U.bP1.default,                                 
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bH1_mU.H1P-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bH1_mU.H1P')}
plotScale = 100 / length(SEQ.mU.H1P)

png(paste0("plots/3_twoPar-", exp.U.bH1_mU.H1P.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bH1_mU.H1P, 'U.bH1', 'mU.H1P', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bH1']),
              ylab = expression(bar(U)['H1P']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bH1_mU.H1P-plot-print, echo=FALSE, dependson='3_U.bH1_mU.H1P-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bH1_mU.H1P.name, "_plot.png"))
```

\newpage

### Utility of other resources to type 1 plants and utility per capita of type 1 plants to humans ($U_{bP_{1}}$ x $\bar{U}_{P_{1}H}$)

```{r 3_U.bP1_mU.P1H-values, cache=TRUE}
exp.U.bP1_mU.P1H.name <- "U.bP1-mU.P1H"
SEQ.U.bP1 <- seq(5, 400, length.out = 15)
SEQ.mU.P1H <- seq(0, 3, length.out = 15)
```

```{r 3_U.bP1_mU.P1H, cache=TRUE, dependson=c('3_default-values','3_U.bP1_mU.P1H-values'), include=FALSE}
exp.U.bP1_mU.P1H <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = mU.HnP.default,
  mU.P1H = SEQ.mU.P1H, ###                              
  mU.H1P = mU.H1P.default,                                 
  U.bHn = U.bHn.default,
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,
  U.bP1 = SEQ.U.bP1, ###                             
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bP1_mU.P1H-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bP1_mU.P1H')}
plotScale = 100 / length(SEQ.mU.H1P)

png(paste0("plots/3_twoPar-", exp.U.bP1_mU.P1H.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bP1_mU.P1H, 'U.bP1', 'mU.P1H', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bP1']),
              ylab = expression(bar(U)['P1H']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bP1_mU.P1H-plot-print, echo=FALSE, dependson='3_U.bP1_mU.P1H-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bP1_mU.P1H.name, "_plot.png"))
```

\newpage

### Utility of other resources to type n humans and utility per capita of type n humans to plants ($U_{bH_{n}}$ x $\bar{U}_{H_{n}P}$)

```{r 3_U.bHn_mU.HnP-values, cache=TRUE}
exp.U.bHn_mU.HnP.name <- "U.bHn-mU.HnP"
SEQ.U.bHn <- seq(5, 400, length.out = 15)
SEQ.mU.HnP <- seq(0, 3, length.out = 15)
```

```{r 3_U.bHn_mU.HnP, cache=TRUE, dependson=c('3_default-values','3_U.bHn_mU.HnP-values'), include=FALSE}
exp.U.bHn_mU.HnP <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = mU.PnH.default,
  mU.HnP = SEQ.mU.HnP, ###
  mU.P1H = mU.P1H.default,                              
  mU.H1P = mU.H1P.default,                                 
  U.bHn = SEQ.U.bHn, ###
  U.bPn = U.bPn.default, 
  U.bH1 = U.bH1.default,
  U.bP1 = U.bP1.default,                             
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bHn_mU.HnP-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bHn_mU.HnP')}
plotScale = 100 / length(SEQ.mU.H1P)

png(paste0("plots/3_twoPar-", exp.U.bHn_mU.HnP.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bHn_mU.HnP, 'U.bHn', 'mU.HnP', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bHn']),
              ylab = expression(bar(U)['HnP']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bHn_mU.HnP-plot-print, echo=FALSE, dependson='3_U.bHn_mU.HnP-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bHn_mU.HnP.name, "_plot.png"))
```

\newpage

### Utility of other resources to type n plants and utility per capita of type n plants to humans ($U_{bP_{n}}$ x $\bar{U}_{P_{n}H}$)

```{r 3_U.bPn_mU.PnH-values, cache=TRUE}
exp.U.bPn_mU.PnH.name <- "U.bPn-mU.PnH"
SEQ.U.bPn <- seq(5, 400, length.out = 15)
SEQ.mU.PnH <- seq(0, 3, length.out = 15)
```

```{r 3_U.bPn_mU.PnH, cache=TRUE, dependson=c('3_default-values','3_U.bPn_mU.PnH-values'), include=FALSE}
exp.U.bPn_mU.PnH <- hpcModel.exploration(
  iniH = iniH.default,
  iniP = iniP.default,
  n.H = n.H.default,         
  n.P = n.P.default,        
  v.H = v.H.default,
  v.P = v.P.default,
  r.H = r.H.default, 
  r.P = r.P.default, 
  mU.PnH = SEQ.mU.PnH, ###
  mU.HnP = mU.HnP.default,
  mU.P1H = mU.P1H.default,                              
  mU.H1P = mU.H1P.default,                                 
  U.bHn = U.bHn.default,
  U.bPn = SEQ.U.bPn, ### 
  U.bH1 = U.bH1.default,
  U.bP1 = U.bP1.default,                             
  MaxArea = MaxArea.default,
  # settings 
  # simulation flow & data
  maxIt = maxIt.default,
  tol = tol.default,
  timing.threshold = timing.threshold.default,
  messages = FALSE
)
```

```{r 3_U.bPn_mU.PnH-plot, include=FALSE, cache=TRUE, dependson=c('3_plot-functions','3_U.bPn_mU.PnH')}
plotScale = 100 / length(SEQ.mU.H1P)

png(paste0("plots/3_twoPar-", exp.U.bPn_mU.PnH.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
twoPar.ggplot(exp.U.bPn_mU.PnH, 'U.bPn', 'mU.PnH', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bPn']),
              ylab = expression(bar(U)['PnH']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 3_U.bPn_mU.PnH-plot-print, echo=FALSE, dependson='3_U.bPn_mU.PnH-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/3_twoPar-", exp.U.bPn_mU.PnH.name, "_plot.png"))
```

\newpage

<!--chapter:end:3_twoParameterExploration.Rmd-->

---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Four parameter exploration

```{r 4_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 
source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(kableExtra)
```

```{r 4_table-functions}
source("library/plotting/exp.table.R")
```

```{r 4_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
iniH.default = 10
iniP.default = 10
# number of discrete types
n.H.default = 30
n.P.default = 30    
# undirected variation 
v.H.default = 0.15
v.P.default = 0.15
# intrinsic growth rate 
r.H.default = 0.04
r.P.default = 0.1
# Utility per capita of individuals of type N
mU.PnH.default = 1.5
mU.HnP.default = 1
# Utility per capita of individuals of type 1
mU.P1H.default = 0.15                           
mU.H1P.default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
U.bHn.default = 10                               
U.bPn.default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
U.bH1.default = 80                               
U.bP1.default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
MaxArea.default = 200
# settings 
# simulation flow & data
maxIt.default = 5000
tol.default = 6
timing.threshold.default = 0.5
saveTrajectories.default = TRUE
messages.default = TRUE
```

```{r 4_plot-functions, include=FALSE}
# this chunk is specific for this exploration 
source("library/plotting/fourPar.ggplot.R")
```

\newpage

## Number of types and undirected variation of humans and plants ($n_{H}$ x $n_{P}$ x $v_{H}$ x $v_{P}$)
\sectionmark{$n_{H}$ x $n_{P}$ x $v_{H}$ x $v_{P}$}

```{r 4_n_v-values, cache=TRUE}
exp.n_v.name <- "n-v"
SEQ.n.H <- seq(5, 45, by = 10)
SEQ.n.P <- seq(5, 45, by = 10)
SEQ.v.H <- seq(0.05, 0.25, length.out = 5)
SEQ.v.P <- seq(0.05, 0.25, length.out = 5)
```

```{r 4_n_v, cache=TRUE, dependson=c('4_default-values','4_n_v-values'), results = 'hide'}
if(!file.exists('data/exp.n_v.RData'))
{
  exp.n_v <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = SEQ.n.H, ###
    n.P = SEQ.n.P, ###
    v.H = SEQ.v.H, ###
    v.P = SEQ.v.P, ###
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = mU.PnH.default,
    mU.HnP = mU.HnP.default,
    mU.P1H = mU.P1H.default,                                  
    mU.H1P = mU.H1P.default,                                   
    U.bHn = U.bHn.default,                                
    U.bPn = U.bPn.default, 
    U.bH1 = U.bH1.default,                               
    U.bP1 = U.bP1.default,                                 
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.n_v, file = 'data/exp.n_v.RData')
}
```

```{r 5_exp.n_v-load, include=FALSE}
# load
load('data/exp.n_v.RData')
```

```{r 4nvtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_n_v')}
exp.table(exp.n_v, caption = 'Parameter setting')
```
```{r 4nvtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_n_v')}
exp.table(exp.n_v, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_n_v-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_n_v')}
plotScale = 10#100 / length(SEQ.U.bPn)

png(paste0("plots/4_fourPar-", exp.n_v.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.n_v, 'v.H', 'v.P', 'n.H', 'n.P', 'coevo.H', 'coevo.P', 
              xlab = expression(v['H']),
              ylab = expression(v['P']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_n_v-plot-print, echo=FALSE, dependson='4_n_v-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.n_v.name, "_plot.png"))
```

**_Interpretation_**:  
- Higher values of all four parameters facilitate coevolution. Undirected variation has a stronger effect than number of types. 
- As a summary of possible end-states:  
    + *'Fast' coevolution* (red square in blue tile, small *t*): most cases when the numbers of types ($n_{H}$, $n_{P}$) are greater than **15** and values of undirected variation ($v_{H}$, $v_{P}$) higher than **0.15**.  
    + *'Semi-domestication' without cultivation* (redish square in whitish tile): cases when $v_{P}\geq 0.15$ and $v_{H}\leq 0.15$.  
    + *'Semi-cultivation' without domestication* (whitish square in blue tile): cases when $v_{H}\geq 0.15$ and $v_{P}\leq 0.15$.
  
\newpage

## Utility per capita between humans and plants ($\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 4_mU.HP_mU.PH-values, cache=TRUE}
exp.mU.HP_mU.PH.name <- "mU.HP-mU.PH"
SEQ.mU.HnP <- seq(0, 3, length.out = 5)
SEQ.mU.PnH <- seq(0, 3, length.out = 5)
SEQ.mU.H1P <- seq(0, 3, length.out = 5)
SEQ.mU.P1H <- seq(0, 3, length.out = 5)
```

```{r 4_mU.HP_mU.PH, cache=TRUE, dependson=c('4_default-values','4_mU.HP_mU.PH-values'), results = 'hide'}
if(!file.exists('data/exp.mU.HP_mU.PH.RData'))
{
  exp.mU.HP_mU.PH <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = SEQ.mU.PnH, ###
    mU.HnP = SEQ.mU.HnP, ###
    mU.P1H = SEQ.mU.P1H, ###
    mU.H1P = SEQ.mU.H1P, ###
    U.bHn = U.bHn.default,                                
    U.bPn = U.bPn.default, 
    U.bH1 = U.bH1.default,                               
    U.bP1 = U.bP1.default,                                 
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.mU.HP_mU.PH, file = 'data/exp.mU.HP_mU.PH.RData')
}
```

```{r 5_exp.mU.HP_mU.PH-load, include=FALSE}
# load
load('data/exp.mU.HP_mU.PH.RData')
```

```{r 4mUHPmUPHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_mU.HP_mU.PH')}
exp.table(exp.mU.HP_mU.PH, caption = 'Parameter setting')
```

```{r 4mUHPmUPHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_mU.HP_mU.PH')}
exp.table(exp.mU.HP_mU.PH, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_mU.HP_mU.PH-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_mU.HP_mU.PH')}
plotScale = 10#100 / length(SEQ.U.bPn)

png(paste0("plots/4_fourPar-", exp.mU.HP_mU.PH.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.mU.HP_mU.PH, 'mU.P1H', 'mU.H1P', 'mU.PnH', 'mU.HnP', 'coevo.H', 'coevo.P', 
              xlab = expression(bar(U)['P1H']),
              ylab = expression(bar(U)['H1P']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_mU.HP_mU.PH-plot-print, echo=FALSE, dependson='4_mU.HP_mU.PH-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.mU.HP_mU.PH.name, "_plot.png"))
```

**_Interpretation_**:  
- Higher values of all four parameters facilitate coevolution; under the 'default' setting, a value around 1 is enough for all four parameters (intermediate values in this exploration).  
- Coevolution is still possible if any single one of these parameters equal zero (first rows or first columns). Under this type of conditions, cultivation (blue) is more probable than domestication (red), and the latter is strongly dependent on a non-null $\bar{U}_{H_{n}P}$.  
- As a summary of possible end-states:  
    + *'Fast' coevolution* (red square in blue tile, small *t*): most cases when values are greater than 0.75.  
    + *Domestication without cultivation* (red square in whitish tile): most cases when $\bar{U}_{H_{n}P}>0.75$, $\bar{U}_{H_{1}P}\geq 0.75$, $\bar{U}_{P_{n}H}=0$, and $\bar{U}_{P_{1}H}<2$.  
    + *Cultivation without domestication* (whitish square in blue tile): most cases when $\bar{U}_{H_{n}P} = 0$.

\newpage

## Utility from other resources to humans and plants ($U_{bH_{1}}$ x $U_{bP_{1}}$ x $U_{bH_{n}}$ x $U_{bP_{n}}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bP_{1}}$ x $U_{bH_{n}}$ x $U_{bP_{n}}$}

For this experiment, consider that the default setting includes $MaxArea=200$ (i.e. the maximum for the plant population).

```{r 4_U.bH_U.bP-values, cache=TRUE}
exp.U.bH_U.bP.name <- "U.bH-U.bP"
SEQ.U.bHn <- seq(5, 300, length.out = 5)
SEQ.U.bPn <- seq(5, 300, length.out = 5)
SEQ.U.bH1 <- seq(5, 300, length.out = 5)
SEQ.U.bP1 <- seq(5, 300, length.out = 5)
```

```{r 4_U.bH_U.bP, cache=TRUE, dependson=c('4_default-values','4_U.bH_U.bP-values'), results = 'hide'}
if(!file.exists('data/exp.U.bH_U.bP.RData'))
{
  exp.U.bH_U.bP <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = mU.PnH.default,
    mU.HnP = mU.HnP.default,
    mU.P1H = mU.P1H.default,
    mU.H1P = mU.H1P.default,
    U.bHn = SEQ.U.bHn, ###
    U.bPn = SEQ.U.bPn, ###
    U.bH1 = SEQ.U.bH1, ###
    U.bP1 = SEQ.U.bP1, ###
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.bH_U.bP, file = 'data/exp.U.bH_U.bP.RData')
}
```

```{r 5_exp.U.bH_U.bP-load, include=FALSE}
# load
load('data/exp.U.bH_U.bP.RData')
```

```{r 4UbHUbPtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bH_U.bP')}
exp.table(exp.U.bH_U.bP, caption = 'Parameter setting')
```
```{r 4UbHUbPtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bH_U.bP')}
exp.table(exp.U.bH_U.bP, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.bH_U.bP-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.bH_U.bP')}
plotScale = 10#100 / length(SEQ.U.bPn)

png(paste0("plots/4_fourPar-", exp.U.bH_U.bP.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.bH_U.bP, 'U.bP1', 'U.bH1', 'U.bPn', 'U.bHn', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bP1']),
              ylab = expression(U['bH1']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.bH_U.bP-plot-print, echo=FALSE, dependson='4_U.bH_U.bP-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.bH_U.bP.name, "_plot.png"))
```

**_Interpretation_**:  
- Lower values of the two human-related parameters ($U_{bH_{1}}$, $U_{bH_{n}}$) facilitate coevolution; under the 'default' setting and for all four parameters, values greater or equal to $MaxArea$ (here, `r MaxArea.default`) impede coevolution. Inversely, higher values of the plant-related parameters ($U_{bP_{1}}$, $U_{bP_{n}}$) facilitate coevolution. The human-related parameters, together regulating the scale of the subsistence alternatives for humans, are significantly more important; their relationship (if one is greater than the other) seems to be less important as long as their combined sum is small enough.  
- Coevolution is likely to occur when $U_{bH_{1}}=5$ (first row in small grids), unless $U_{bH_{n}}$ is too big and $U_{bP_{1}}$ is too small.  
- As a summary of possible end-states:  
    + *'Fast' coevolution* (red square in blue tile, small *t*): most cases when $U_{bH_{1}}$ and $U_{bH_{n}}<153$.  
    + *Domestication without cultivation* (red square in whitish tile): most cases when $U_{bP_{n}}=5$, $U_{bP_{1}}=5$ (i.e. there is very little carrying capacity for plants beyond the anthropic space) and $U_{bH_{1}}>5$ (i.e. humans get enough of other resources when -still- not engaged in agriculture).  
    + *Cultivation without domestication* (whitish square in blue tile): *no cases are visible under these conditions*.

\newpage

## Utility from other resources to humans and utility per capita of plants to humans ($U_{bH_{1}}$ x $U_{bH_{n}}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bH_{n}}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$}

All four parameters affect directly the carrying capacity for humans.

```{r 4_U.bH_U.PH-values, cache=TRUE}
exp.U.bH_U.PH.name <- "U.bH-U.PH"
SEQ.U.bHn <- seq(5, 300, length.out = 5)
SEQ.U.bH1 <- seq(5, 300, length.out = 5)
SEQ.mU.PnH <- seq(0, 3, length.out = 5)
SEQ.mU.P1H <- seq(0, 3, length.out = 5)
```

```{r 4_U.bH_U.PH, cache=TRUE, dependson=c('4_default-values','4_U.bH_U.PH-values'), results = 'hide'}
if(!file.exists('data/exp.U.bH_U.PH.RData'))
{
  exp.U.bH_U.PH <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = SEQ.mU.PnH, ###
    mU.HnP = mU.HnP.default,
    mU.P1H = SEQ.mU.P1H, ###
    mU.H1P = mU.H1P.default,
    U.bHn = SEQ.U.bHn, ###
    U.bPn = U.bPn.default,
    U.bH1 = SEQ.U.bH1, ###
    U.bP1 = U.bP1.default,
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.bH_U.PH, file = 'data/exp.U.bH_U.PH.RData')
}
```

```{r 5_exp.U.bH_U.PH-load, include=FALSE}
# load
load('data/exp.U.bH_U.PH.RData')
```

```{r 4UbHUPHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bH_U.PH')}
exp.table(exp.U.bH_U.PH, caption = 'Parameter setting')
```
```{r 4UbHUPHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bH_U.PH')}
exp.table(exp.U.bH_U.PH, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.bH_U.PH-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.bH_U.PH')}
plotScale = 10

png(paste0("plots/4_fourPar-", exp.U.bH_U.PH.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.bH_U.PH, 'U.bH1', 'U.bHn', 'mU.P1H', 'mU.PnH', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bH1']),
              ylab = expression(U['bHn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.bH_U.PH-plot-print, echo=FALSE, dependson='4_U.bH_U.PH-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.bH_U.PH.name, "_plot.png"))
```

\newpage

## Utility from other resources to plants and utility per capita of humans to plants ($U_{bP_{1}}$ x $U_{bP_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bP_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$}

All four parameters affect directly the carrying capacity for plants.

```{r 4_U.bP_mU.HP-values, cache=TRUE}
exp.U.bP_mU.HP.name <- "U.bP-mU.HP"
SEQ.U.bPn <- seq(5, 300, length.out = 5)
SEQ.U.bP1 <- seq(5, 300, length.out = 5)
SEQ.mU.HnP <- seq(0, 3, length.out = 5)
SEQ.mU.H1P <- seq(0, 3, length.out = 5)
```

```{r 4_U.bP_mU.HP, cache=TRUE, dependson=c('4_default-values','4_U.bP_mU.HP-values'), results = 'hide'}
if(!file.exists('data/exp.U.bP_mU.HP.RData'))
{
  exp.U.bP_mU.HP <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = mU.PnH.default,
    mU.HnP = SEQ.mU.HnP, ###
    mU.P1H = mU.P1H.default,
    mU.H1P = SEQ.mU.H1P, ###
    U.bHn = U.bHn.default,
    U.bPn = SEQ.U.bPn, ###
    U.bH1 = U.bH1.default,
    U.bP1 = SEQ.U.bP1, ###
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.bP_mU.HP, file = 'data/exp.U.bP_mU.HP.RData')
}
```

```{r 5_exp.U.bP_mU.HP-load, include=FALSE}
# load
load('data/exp.U.bP_mU.HP.RData')
```

```{r 4UbPUHPtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bP_mU.HP')}
exp.table(exp.U.bP_mU.HP, caption = 'Parameter setting')
```
```{r 4UbPUHPtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bP_mU.HP')}
exp.table(exp.U.bP_mU.HP, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.bP_mU.HP-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.bP_mU.HP')}
plotScale = 10

png(paste0("plots/4_fourPar-", exp.U.bP_mU.HP.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.bP_mU.HP, 'U.bP1', 'U.bPn', 'mU.H1P', 'mU.HnP', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bP1']),
              ylab = expression(U['bPn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.bP_mU.HP-plot-print, echo=FALSE, dependson='4_U.bP_mU.HP-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.bP_mU.HP.name, "_plot.png"))
```

\newpage

## Utility from other resources and utility per capita of type 1 humans and plants ($U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$}

This exploration reflects the state at the start of simulations (both populations are mostly of type 1).

```{r 4_U.b1_mU1_-values, cache=TRUE}
exp.U.b1_mU1.name <- "U.b1-mU1"
SEQ.U.bH1 <- seq(5, 300, length.out = 5)
SEQ.U.bP1 <- seq(5, 300, length.out = 5)
SEQ.mU.H1P <- seq(0, 3, length.out = 5)
SEQ.mU.P1H <- seq(0, 3, length.out = 5)
```

```{r 4_U.b1_mU1, cache=TRUE, dependson=c('4_default-values','4_U.b1_mU1-values'), results = 'hide'}
if(!file.exists('data/exp.U.b1_mU1.RData'))
{
  exp.U.b1_mU1 <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = mU.PnH.default,
    mU.HnP = mU.HnP.default,
    mU.P1H = SEQ.mU.P1H, ###
    mU.H1P = SEQ.mU.H1P, ###
    U.bHn = U.bHn.default,
    U.bPn = U.bPn.default,
    U.bH1 = SEQ.U.bH1, ###
    U.bP1 = SEQ.U.bP1, ###
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.b1_mU1, file = 'data/exp.U.b1_mU1.RData')
}
```

```{r 5_exp.U.b1_mU1-load, include=FALSE}
# load
load('data/exp.U.b1_mU1.RData')
```

```{r 4Ub1mU1tablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.b1_mU1')}
exp.table(exp.U.b1_mU1, caption = 'Parameter setting')
```
```{r 4Ub1mU1tablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.b1_mU1')}
exp.table(exp.U.b1_mU1, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.b1_mU1-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.b1_mU1')}
plotScale = 10

png(paste0("plots/4_fourPar-", exp.U.b1_mU1.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.b1_mU1, 'U.bH1', 'U.bP1', 'mU.H1P', 'mU.P1H', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bH1']),
              ylab = expression(U['bP1']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.b1_mU1-plot-print, echo=FALSE, dependson='4_U.b1_mU1-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.b1_mU1.name, "_plot.png"))
```

\newpage

## Utility from other resources and utility per capita of type n humans and plants ($U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

This exploration reflects the state after a successful coevolution (both populations are mostly of type n).

```{r 4_U.bn_mUn_-values, cache=TRUE}
exp.U.bn_mUn.name <- "U.bn-mUn"
SEQ.U.bHn <- seq(5, 300, length.out = 5)
SEQ.U.bPn <- seq(5, 300, length.out = 5)
SEQ.mU.HnP <- seq(0, 3, length.out = 5)
SEQ.mU.PnH <- seq(0, 3, length.out = 5)
```

```{r 4_U.bn_mUn, cache=TRUE, dependson=c('4_default-values','4_U.bn_mUn-values'), results = 'hide'}
if(!file.exists('data/exp.U.bn_mUn.RData'))
{
  exp.U.bn_mUn <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = SEQ.mU.PnH, ###
    mU.HnP = SEQ.mU.HnP, ###
    mU.P1H = mU.P1H.default,
    mU.H1P = mU.H1P.default,
    U.bHn = SEQ.U.bHn, ###
    U.bPn = SEQ.U.bPn, ###
    U.bH1 = U.bH1.default,
    U.bP1 = U.bP1.default,
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.bn_mUn, file = 'data/exp.U.bn_mUn.RData')
}
```

```{r 5_exp.U.bn_mUn-load, include=FALSE}
# load
load('data/exp.U.bn_mUn.RData')
```

```{r 4UbnmUntablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bn_mUn')}
exp.table(exp.U.bn_mUn, caption = 'Parameter setting')
```
```{r 4UbnmUntablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bn_mUn')}
exp.table(exp.U.bn_mUn, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.bn_mUn-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.bn_mUn')}
plotScale = 10

png(paste0("plots/4_fourPar-", exp.U.bn_mUn.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.bn_mUn, 'U.bHn', 'U.bPn', 'mU.HnP', 'mU.PnH', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bHn']),
              ylab = expression(U['bPn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.bn_mUn-plot-print, echo=FALSE, dependson='4_U.bn_mUn-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.bn_mUn.name, "_plot.png"))
```

\newpage

## Utility from other resources to type 1 humans and plants and utility per capita of type n humans and plants ($U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 4_U.b1_mUn_-values, cache=TRUE}
exp.U.b1_mUn.name <- "U.b1-mUn"
SEQ.U.bH1 <- seq(5, 300, length.out = 5)
SEQ.U.bP1 <- seq(5, 300, length.out = 5)
SEQ.mU.HnP <- seq(0, 3, length.out = 5)
SEQ.mU.PnH <- seq(0, 3, length.out = 5)
```

```{r 4_U.b1_mUn, cache=TRUE, dependson=c('4_default-values','4_U.b1_mUn-values'), results = 'hide'}
if(!file.exists('data/exp.U.b1_mUn.RData'))
{
  exp.U.b1_mUn <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = SEQ.mU.PnH, ###
    mU.HnP = SEQ.mU.HnP, ###
    mU.P1H = mU.P1H.default,
    mU.H1P = mU.H1P.default,
    U.bHn = U.bHn.default,
    U.bPn = U.bPn.default,
    U.bH1 = SEQ.U.bH1, ###
    U.bP1 = SEQ.U.bP1, ###
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.b1_mUn, file = 'data/exp.U.b1_mUn.RData')
}
```

```{r 5_exp.U.b1_mUn-load, include=FALSE}
# load
load('data/exp.U.b1_mUn.RData')
```

```{r 4Ub1mUntablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.b1_mUn')}
exp.table(exp.U.b1_mUn, caption = 'Parameter setting')
```
```{r 4Ub1mUntablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.b1_mUn')}
exp.table(exp.U.b1_mUn, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.b1_mUn-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.b1_mUn')}
plotScale = 10

png(paste0("plots/4_fourPar-", exp.U.b1_mUn.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.b1_mUn, 'U.bH1', 'U.bP1', 'mU.HnP', 'mU.PnH', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bH1']),
              ylab = expression(U['bP1']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.b1_mUn-plot-print, echo=FALSE, dependson='4_U.b1_mUn-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.b1_mUn.name, "_plot.png"))
```

\newpage

## Utility from other resources to type n humans and plants and utility per capita of type 1 humans and plants ($U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$)
\sectionmark{$U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$}

```{r 4_U.bn_mU1_-values, cache=TRUE}
exp.U.bn_mU1.name <- "U.bn-mU1"
SEQ.U.bHn <- seq(5, 300, length.out = 5)
SEQ.U.bPn <- seq(5, 300, length.out = 5)
SEQ.mU.H1P <- seq(0, 3, length.out = 5)
SEQ.mU.P1H <- seq(0, 3, length.out = 5)
```

```{r 4_U.bn_mU1, cache=TRUE, dependson=c('4_default-values','4_U.bn_mU1-values'), results = 'hide'}
if(!file.exists('data/exp.U.bn_mU1.RData'))
{
  exp.U.bn_mU1 <- hpcModel.exploration(
    iniH = iniH.default,
    iniP = iniP.default,
    n.H = n.H.default,         
    n.P = n.P.default,        
    v.H = v.H.default,
    v.P = v.P.default,
    r.H = r.H.default, 
    r.P = r.P.default, 
    mU.PnH = mU.PnH.default,
    mU.HnP = mU.HnP.default,
    mU.P1H = SEQ.mU.P1H, ###
    mU.H1P = SEQ.mU.H1P, ###
    U.bHn = SEQ.U.bHn, ###
    U.bPn = SEQ.U.bPn, ###
    U.bH1 = U.bH1.default,
    U.bP1 = U.bP1.default,
    MaxArea = MaxArea.default,
    maxIt = maxIt.default,
    tol = tol.default,
    timing.threshold = timing.threshold.default,
    messages = FALSE
  )
  # save
  save(exp.U.bn_mU1, file = 'data/exp.U.bn_mU1.RData')
}
```

```{r 5_exp.U.bn_mU1-load, include=FALSE}
# load
load('data/exp.U.bn_mU1.RData')
```

```{r 4UbnmU1tablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bn_mU1')}
exp.table(exp.U.bn_mU1, caption = 'Parameter setting')
```
```{r 4UbnmU1tablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_U.bn_mU1')}
exp.table(exp.U.bn_mU1, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_U.bn_mU1-plot, include=FALSE, cache=TRUE, dependson=c('4_plot-functions','4_U.bn_mU1')}
plotScale = 10

png(paste0("plots/4_fourPar-", exp.U.bn_mU1.name, "_plot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
fourPar.ggplot(exp.U.bn_mU1, 'U.bHn', 'U.bPn', 'mU.H1P', 'mU.P1H', 'coevo.H', 'coevo.P', 
              xlab = expression(U['bHn']),
              ylab = expression(U['bPn']),
              var1lab = expression('coevo'[H]),
              var2lab = expression('coevo'[P]),
              plotScale = plotScale)
dev.off()
```

```{r 4_U.bn_mU1-plot-print, echo=FALSE, dependson='4_U.bn_mU1-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/4_fourPar-", exp.U.bn_mU1.name, "_plot.png"))
```


<!--chapter:end:4_fourParameterExploration.Rmd-->

---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Multiple parameter exploration

```{r 5_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(ggpubr)
require(kableExtra)
```

```{r 5_table-functions}
source("library/plotting/exp.table.multiple.R")
```

```{r 5_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
iniH.default = 10
iniP.default = 10
# number of discrete types
n.H.default = 30
n.P.default = 30    
# undirected variation 
v.H.default = 0.15
v.P.default = 0.15
# intrinsic growth rate 
r.H.default = 0.04
r.P.default = 0.1
# Utility per capita of individuals of type N
mU.PnH.default = 1.5
mU.HnP.default = 1
# Utility per capita of individuals of type 1
mU.P1H.default = 0.15                           
mU.H1P.default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
U.bHn.default = 10                               
U.bPn.default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
U.bH1.default = 80                               
U.bP1.default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
MaxArea.default = 200
# settings 
# simulation flow & data
maxIt.default = 5000
tol.default = 6
timing.threshold.default = 0.5
saveTrajectories.default = TRUE
messages.default = TRUE
```

```{r 5_setup_plus, include=FALSE}
# this chunk is specific for this exploration
require(DoE.wrapper)    # LHS
require(randomForest)   # RF
require(party)          # classification / regression tree
require(parallel)       # use parallelization, it takes 8 min aprox

run.LHS.experiment <- function(experimentSettings, cluster)
{
  parallel::parLapply(cluster, 1:nrow(experimentSettings),
                      function(experimentIndex) {
                        RESULTS <- hpcModel.run(
                          iniH = iniH.default,
                          iniP = iniP.default,
                          n.H = experimentSettings[experimentIndex,     1],         
                          n.P = experimentSettings[experimentIndex,     2],        
                          v.H = experimentSettings[experimentIndex,     3],
                          v.P = experimentSettings[experimentIndex,     4],
                          r.H = experimentSettings[experimentIndex,     5], 
                          r.P = experimentSettings[experimentIndex,     6], 
                          mU.PnH = experimentSettings[experimentIndex,  7],
                          mU.HnP = experimentSettings[experimentIndex,  8],
                          mU.P1H = experimentSettings[experimentIndex,  9],
                          mU.H1P = experimentSettings[experimentIndex,  10],
                          U.bHn = experimentSettings[experimentIndex,   11],
                          U.bPn = experimentSettings[experimentIndex,   12], 
                          U.bH1 = experimentSettings[experimentIndex,   13],
                          U.bP1 = experimentSettings[experimentIndex,   14],
                          MaxArea = experimentSettings[experimentIndex, 15],
                          maxIt = maxIt.default,
                          tol = tol.default,
                          saveTrajectories = FALSE,
                          messages = FALSE
                        )
                        return(as.data.frame(RESULTS$END))
                      })
}

# same, but saving trajectories
run.LHS.experiment2 <- function(experimentSettings, cluster)
{
  parallel::parLapply(cluster, 1:nrow(experimentSettings),
                      function(experimentIndex) {
                        RESULTS <- hpcModel.run(
                          iniH = iniH.default,
                          iniP = iniP.default,
                          n.H = experimentSettings[experimentIndex,     1],         
                          n.P = experimentSettings[experimentIndex,     2],        
                          v.H = experimentSettings[experimentIndex,     3],
                          v.P = experimentSettings[experimentIndex,     4],
                          r.H = experimentSettings[experimentIndex,     5], 
                          r.P = experimentSettings[experimentIndex,     6], 
                          mU.PnH = experimentSettings[experimentIndex,  7],
                          mU.HnP = experimentSettings[experimentIndex,  8],
                          mU.P1H = experimentSettings[experimentIndex,  9],
                          mU.H1P = experimentSettings[experimentIndex,  10],
                          U.bHn = experimentSettings[experimentIndex,   11],
                          U.bPn = experimentSettings[experimentIndex,   12], 
                          U.bH1 = experimentSettings[experimentIndex,   13],
                          U.bP1 = experimentSettings[experimentIndex,   14],
                          MaxArea = experimentSettings[experimentIndex, 15],
                          maxIt = maxIt.default,
                          tol = tol.default,
                          saveTrajectories = TRUE,
                          messages = FALSE
                        )
                        return(RESULTS$TRAJECTORIES)
                      })
}
```

```{r 5_plot-functions, include=FALSE}
# this chunk is specific for this exploration
source("library/plotting/collapsed.ggplot.R")
source("library/plotting/trajectories.ggplot.R")
source("library/plotting/parameter.x.scenario.ggplot.R")
source("library/plotting/varImpPlot2.R")
```

\newpage

## Sampling parameter values with Latin Hypercube Sampling (LHS)

```{r 5_LHS-values}
LHS.parameter.names <- c(
  'n.H', 'n.P',        
  'v.H', 'v.P',
  'r.H', 'r.P',
  'mU.PnH', 'mU.HnP', 'mU.P1H', 'mU.H1P',                                   
  'U.bHn', 'U.bPn', 'U.bH1', 'U.bP1',
  'MaxArea'
)
LHS.parameter.ranges <- list(
  n.H = c(3, 50),         
  n.P = c(3, 50),        
  v.H = c(0.1, 0.3),
  v.P = c(0.1, 0.3),
  r.H = c(0.01, 0.3),
  r.P = c(0.01, 0.3),
  mU.PnH = c(0, 3),
  mU.HnP = c(0, 3),
  mU.P1H = c(0, 3),                                  
  mU.H1P = c(0, 3),                                   
  U.bHn = c(1, 300),                                
  U.bPn = c(1, 300), 
  U.bH1 = c(1, 300),                               
  U.bP1 = c(1, 300),
  MaxArea = c(1, 300)
)
```

**parameter**       | **value**
 ------------------ | ----------------------------------
 `n.H`, `n.P`       | [`r LHS.parameter.ranges$n.H[1]`, `r LHS.parameter.ranges$n.H[2]`], [`r LHS.parameter.ranges$n.P[1]`, `r LHS.parameter.ranges$n.P[2]`]
 `v.H`, `v.P`       | [`r LHS.parameter.ranges$v.H[1]`, `r LHS.parameter.ranges$v.H[2]`], [`r LHS.parameter.ranges$v.P[1]`, `r LHS.parameter.ranges$v.P[2]`]
  `r.H`, `r.P`       | [`r LHS.parameter.ranges$r.H[1]`, `r LHS.parameter.ranges$r.H[2]`], [`r LHS.parameter.ranges$r.P[1]`, `r LHS.parameter.ranges$r.P[2]`]
 `mU.PnH`, `mU.HnP` | [`r LHS.parameter.ranges$mU.PnH[1]`, `r LHS.parameter.ranges$mU.PnH[2]`], [`r LHS.parameter.ranges$mU.HnP[1]`, `r LHS.parameter.ranges$mU.HnP[2]`]
 `mU.P1H`, `mU.H1P` | [`r LHS.parameter.ranges$mU.P1H[1]`, `r LHS.parameter.ranges$mU.P1H[2]`], [`r LHS.parameter.ranges$mU.H1P[1]`, `r LHS.parameter.ranges$mU.H1P[2]`]
 `U.bH1`, `U.bP1`   | [`r LHS.parameter.ranges$U.bH1[1]`, `r LHS.parameter.ranges$U.bH1[2]`], [`r LHS.parameter.ranges$U.bP1[1]`, `r LHS.parameter.ranges$U.bP1[2]`]
 `U.bHn`, `U.bPn`   | [`r LHS.parameter.ranges$U.bHn[1]`, `r LHS.parameter.ranges$U.bHn[2]`], [`r LHS.parameter.ranges$U.bPn[1]`, `r LHS.parameter.ranges$U.bPn[2]`]
 `MaxArea`   | [`r LHS.parameter.ranges$MaxArea[1]`, `r LHS.parameter.ranges$MaxArea[2]`]

Table: Ranges of parameter exploration

```{r 5_LHS, include=FALSE}
### generate LHS design (strauss method, with 0.2 radious interaction)
if (!file.exists('data/LHS.RData')) # you must delete "LHS.RData" to create a new file
{
  LHS <- DoE.wrapper::lhs.design(
    nruns = 10000, # probably should be greater
    nfactors = 15,
    type = 'strauss',
    seed = 777,
    factor.names = LHS.parameter.ranges,
    digits = c(0, 0, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4),
    RND = 0.2
  )

  # save
  save(LHS, file = 'data/LHS.RData')
}
```

```{r 5_LHS-load, include=FALSE}
# load
load('data/LHS.RData')

# build PARS
PARS <- as.data.frame(LHS)
```

```{r 5LHStablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_LHS-load')}
exp.table.multiple(PARS, numberOfParameters = 15, caption = 'ACTUAL parameter values')
```
```{r 5LHStablepdf, eval=params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_LHS-load')}
exp.table.multiple(PARS, numberOfParameters = 15, caption = 'ACTUAL parameter values', output = "latex")
```

\newpage

```{r 5_LHS-pairs-plot, cache=TRUE, dependson='5_LHS-load'}
plotScale = 10

png("plots/5_multiplePar-LHS_pairs-plot.png",
    width = 100 * plotScale, height = 100 * plotScale)
pairs(LHS, pch='Â·')
invisible(dev.off())
```

```{r 5_LHS-pairs-plot-print, dependson='5_LHS-pairs-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-LHS_pairs-plot.png")
```

\newpage

## Experiment overview

```{r 5_run-experiments, include=FALSE}
### run the model for every setting according to the LHS design
if(!file.exists('data/exp.LHS.RData')) # you must delete "exp.LHS.RData" to create a new file
{
  
  # build cluster
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('hpcModel.run', 'Fitness', 'coevo.coef', 
                     'PARS', 
                     'iniH.default', 'iniP.default', 'maxIt.default', 'tol.default'), 
                envir = environment())
  
  # loop
  exp.LHS <- run.LHS.experiment(PARS, cl)
  
  # stop cluster and clean
  stopCluster(cl)
  rm(cl)
  gc()
  
  # bind result
  exp.LHS <- do.call('rbind', exp.LHS)
  
  # build object
  exp.LHS <- cbind(PARS, exp.LHS)
  
  # save
  save(exp.LHS, file = 'data/exp.LHS.RData')
}
```

```{r 5_run-experiments-load, include=FALSE, dependson='5_run-experiments'}
# load
load('data/exp.LHS.RData')

H.evolved <- exp.LHS$timing.H > 0
P.evolved <- exp.LHS$timing.P > 0
H.exist <- !is.na(exp.LHS$H) & exp.LHS$H > 0
P.exist <- !is.na(exp.LHS$P) & exp.LHS$P > 0
```

```{r 5existHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(H.exist), "html")
```
```{r 5existHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(H.exist), "latex")
```
```{r 5existPtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(P.exist), "html")
```
```{r 5existPtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(P.exist), "latex")
```
```{r 5evolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(H.evolved), "html")
```
```{r 5evolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(H.evolved), "latex")
```
```{r 5evolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(P.evolved), "html")
```
```{r 5evolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('5_table-functions','5_run-experiments-load')}
knitr::kable(table(P.evolved), "latex")
```

```{r 5_overview-collapsed-plot, include=FALSE, cache=TRUE}
overview.variable.name = 'coevo'
plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png(paste0("plots/5_multiplePar-", overview.variable.name, "_collapsed-ggplot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
collapsed.ggplot(exp.LHS,
                 'mU.HnP', 'coevo.H', 'coevo.P',
                 ylab = "coevolution coefficient",
                 plotScale = plotScale)
dev.off()
```

```{r 5_overview-collapsed-plot-print, dependson='5_overview-collapsed-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-", overview.variable.name, "_collapsed-ggplot.png"))
```

\newpage

### Random forest

**_Optimisation_** 

```{r 5_RF.tunning.preparation, include=FALSE}
set.seed(777)

exp.LHS.r <- exp.LHS[P.exist,]

exp.LHS.r <- exp.LHS.r[sample(1:nrow(exp.LHS.r), nrow(exp.LHS.r)),]

exp.LHS.spl <- split(as.data.frame(exp.LHS.r), 
                     f = factor(ceiling(seq_along(1:nrow(exp.LHS.r)) / 1000)))

Grid <- expand.grid(mtry = c(2:10), ntree = seq(500, 2000, 500))
```

```{r 5_RF.tunning.H, include=FALSE}
if (!file.exists('data/RF.coevo.H-tunning.RData')) # you must delete "RF.coevo.H-tunning.RData" to create a new file
{
  # cluster and loop
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('randomForest', 'Grid', 'LHS.parameter.names', 'exp.LHS.spl'), 
                envir = environment())
  
  RF.coevo.H.tunning <- parSapply(cl, 1:nrow(Grid), function(p) {
    aux <- c()
    for (i in 1:10) {
      X <- do.call(rbind, exp.LHS.spl[-i])
      RF.coevo.H <- randomForest(
        as.formula(paste0("coevo.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
        data = X,
        mtry = Grid[p, 1],
        ntree = Grid[p, 2]
      )
      acc.coevo.H <- 
        mean((predict(RF.coevo.H, exp.LHS.spl[[i]][, 1:15]) - exp.LHS.spl[[i]]$coevo.H) ^ 2)
      
      rm(RF.coevo.H)
      gc()
      
      aux[i] <- acc.coevo.H
    }
    
    return(mean(aux))
  })

  RF.coevo.H.tunning <- cbind(Grid, mean.predict = RF.coevo.H.tunning)
  # save
  save(RF.coevo.H.tunning, file = 'data/RF.coevo.H-tunning.RData')
}
```

```{r 5_RF.coevo.H.tunning-load, include=FALSE}
# load
load('data/RF.coevo.H-tunning.RData')
```

```{r 5_RF.tunning.P, include=FALSE, eval=FALSE}
if (!file.exists('data/RF.coevo.P-tunning.RData')) # you must delete "RF.coevo.P-tunning.RData" to create a new file
{
  # cluster and loop
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('randomForest', 'Grid', 'LHS.parameter.names', 'exp.LHS.spl'), 
                envir = environment())
  
  RF.coevo.P.tunning <- parSapply(cl, 1:nrow(Grid), function(p) {
    aux <- c()
    for (i in 1:10) {
      exp.LHS.leftOneOut <- do.call(rbind, exp.LHS.spl[-i])
      RF.coevo.P <- randomForest(
        as.formula(paste0("coevo.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
        data = exp.LHS.leftOneOut,
        mtry = Grid[p, 1],
        ntree = Grid[p, 2]
      )
      acc.coevo.P <- 
        mean((predict(RF.coevo.P, exp.LHS.spl[[i]][, 1:15]) - exp.LHS.spl[[i]]$coevo.P) ^ 2)
      
      rm(RF.coevo.p)
      gc()
      
      aux[i] <- acc.coevo.P
    }
    
    return(mean(aux))
  })

  RF.coevo.P.tunning <- cbind(Grid, mean.predict = RF.coevo.P.tunning)
  # save
  save(RF.coevo.P.tunning, file = 'data/RF.coevo.P-tunning.RData')
}
```

```{r 5_RF.coevo.P.tunning-load, include=FALSE}
# load
load('data/RF.coevo.P-tunning.RData')
```

```{r 5_RF.coevo.tunning-plot, dependson=c('5_RF.coevo.H.tunning-load', '5_RF.coevo.P.tunning-load'), out.width = '100%'}
temp <- cbind(
  output.var = c(
    rep('coevo.H', nrow(RF.coevo.H.tunning)), 
    rep('coevo.P', nrow(RF.coevo.P.tunning))
    ),
  rbind(RF.coevo.H.tunning, RF.coevo.P.tunning)
  )

ggplot(temp, aes(x = ntree, y = mtry)) + 
  geom_tile(aes(fill = mean.predict), colour = "white") + 
  scale_fill_gradient(low = "white", high = "black") +
  geom_text(aes(label = round(mean.predict, 5)), color = "steelblue") +
  facet_wrap(.~output.var) + theme_bw()
```

\newpage

**_Coevolution coefficients_**

Only using those runs with any humans (coevo.H) and plants (coevo.P) at the end-state.

```{r 5_RF-coevo.H, include=FALSE, cache=TRUE, dependson='5_setup_plus'}
if(!file.exists('data/RF.coevo.H.RData'))
{
  RF.coevo.H <-
  randomForest::randomForest(
    as.formula(paste0("coevo.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
    data = exp.LHS[H.exist,],
    mtry = 5,
    ntree = 1000,
    importance = T
  )
  #RF.coevo.H$error <- mean((predict(RF.coevo.H, exp.LHS[, 1:12]) - exp.LHS$coevo.H) ^ 2)
  # save
  save(RF.coevo.H, file = 'data/RF.coevo.H.RData')
}
```

```{r 5_RF-coevo.P, include=FALSE, cache=TRUE, dependson='5_setup_plus'}
if(!file.exists('data/RF.coevo.P.RData'))
{
  RF.coevo.P <-
    randomForest::randomForest(
      as.formula(paste0("coevo.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[P.exist,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.coevo.P$error <- mean((predict(RF.coevo.P, exp.LHS[, 1:12]) - exp.LHS$coevo.P) ^ 2)
  # save
  save(RF.coevo.P, file = 'data/RF.coevo.P.RData')
}
```

```{r 5_RF.coevo-load, include=FALSE}
# load
load('data/RF.coevo.H.RData')
load('data/RF.coevo.P.RData')
```

```{r 5_RF-coevo-plots, include=FALSE, cache=TRUE}
plotScale = 2

png("plots/5_multiplePar-RF-coevo.png", width = 640 * plotScale, height = 360 * plotScale)
varImpPlot2Pair(RF.coevo.H, RF.coevo.P, cex = plotScale)
dev.off()
```

```{r 5_RF-coevo-plot-print, dependson='5_RF-coevo-plots', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-RF-coevo.png"))
```

\newpage

**_Dependency coefficients_**

Only using those runs with any humans (depend.H) and plants (depend.P) at the end-state.

```{r 5_RF-depend.H, include=FALSE, cache=TRUE, dependson='5_setup_plus'}
if(!file.exists('data/RF.depend.H.RData'))
{
  RF.depend.H <-
    randomForest::randomForest(
      as.formula(paste0("depend.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[H.exist,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.depend.H$error <- mean((predict(RF.depend.H, exp.LHS[, 1:12]) - exp.LHS$depend.H) ^ 2)
  # save
  save(RF.depend.H, file = 'data/RF.depend.H.RData')
}
```

```{r 5_RF-depend.P, include=FALSE, cache=TRUE, dependson='5_setup_plus'}
if(!file.exists('data/RF.depend.P.RData'))
{
  RF.depend.P <-
    randomForest::randomForest(
      as.formula(paste0("depend.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[P.exist,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.depend.P$error <- mean((predict(RF.depend.P, exp.LHS[, 1:12]) - exp.LHS$depend.P) ^ 2)
  # save
  save(RF.depend.P, file = 'data/RF.depend.P.RData')
}
```

```{r 5_RF.depend-load, include=FALSE}
# load
load('data/RF.depend.H.RData')
load('data/RF.depend.P.RData')
```

```{r 5_RF-depend-plots, include=FALSE, cache=TRUE}
plotScale = 2

png("plots/5_multiplePar-RF-depend.png", width = 640 * plotScale, height = 360 * plotScale)
varImpPlot2Pair(RF.depend.H, RF.depend.P, cex = plotScale)
dev.off()
```

```{r 5_RF-depend.H-plot-print, dependson='5_RF-depend-plots', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-RF-depend.png"))
```

**_Timings_**

Only using those runs with successful human (timing.H) and plant (timing.P) evolution.

```{r 5_RF-timing.H, include=FALSE, cache=TRUE, dependson='5_setup_plus'}
if(!file.exists('data/RF.timing.H.RData'))
{
  RF.timing.H <-
    randomForest::randomForest(
      as.formula(paste0("timing.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[H.evolved,], # filter out cases where humans did not evolved towards n
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.timing.H$error <- mean((predict(RF.timing.H, exp.LHS[, 1:12]) - exp.LHS$timing.H) ^ 2)
  # save
  save(RF.timing.H, file = 'data/RF.timing.H.RData')
}
```

```{r 5_RF-timing.P, include=FALSE, cache=TRUE, dependson='5_setup_plus'}
if(!file.exists('data/RF.timing.P.RData'))
{
  RF.timing.P <-
    randomForest::randomForest(
      as.formula(paste0("timing.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[P.evolved,], # filter out cases where plants did not evolved towards n
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.timing.P$error <- mean((predict(RF.timing.P, exp.LHS[, 1:12]) - exp.LHS$timing.P) ^ 2)
  # save
  save(RF.timing.P, file = 'data/RF.timing.P.RData')
}
```

```{r 5_RF.timing-load, include=FALSE}
# load
load('data/RF.timing.H.RData')
load('data/RF.timing.P.RData')
```

```{r 5_RF-timing-plots, include=FALSE, cache=TRUE}
plotScale = 2

png("plots/5_multiplePar-RF-timing.png", width = 640 * plotScale, height = 360 * plotScale)
varImpPlot2Pair(RF.timing.H, RF.timing.P, cex = plotScale)
dev.off()
```

```{r 5_RF-timing.H-plot-print, dependson='5_RF-timing-plots', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-RF-timing.png"))
```

\newpage

### Trajectories

```{r 5_exp.LHS.trajectories, include=FALSE}
if(!file.exists('data/exp.LHS.trajectories.RData'))
{
  number.trajectories = 5
  
  set.seed(777)
  
  randomSample <- sample(1:nrow(PARS), number.trajectories)
  
  PARS.sample <- PARS[randomSample,]
  
  # build cluster
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('hpcModel.run', 'Fitness', 'coevo.coef', 
                     'PARS.sample', 
                     'iniH.default', 'iniP.default', 'maxIt.default', 'tol.default'), 
                envir = environment())
  
  # loop
  exp.LHS.trajectories.list <- run.LHS.experiment2(PARS.sample, cl)
  
  # stop cluster and clean
  stopCluster(cl)
  rm(cl)
  gc()
  
  # build object
  exp.LHS.trajectories <- c()
  
  for (runIndex in 1:number.trajectories)
  {
    exp.LHS.trajectories <- rbind(
      exp.LHS.trajectories,
      cbind(
        run = rep(runIndex, nrow(exp.LHS.trajectories.list[[runIndex]])),
        time = 1:(nrow(exp.LHS.trajectories.list[[runIndex]])),
        exp.LHS.trajectories.list[[runIndex]][,c('H', 'P', 'coevo.H', 'coevo.P')]
      )
    )
  }
  
  exp.LHS.trajectories <- exp.LHS.trajectories[!is.na(exp.LHS.trajectories$H) & exp.LHS.trajectories$H > 0,]
  
  rm(exp.LHS.trajectories.list)
  
  # save
  save(exp.LHS.trajectories, file = 'data/exp.LHS.trajectories.RData')
}
```

```{r 5_overview-trajectories-plot, include=FALSE, cache=TRUE}
load('data/exp.LHS.trajectories.RData')

overview.variable.name = 'pop'

plotScale = 10

png(paste0("plots/5_multiplePar-", overview.variable.name, "_trajectories-ggplot.png"),
    width = 100 * plotScale, height = 50 * plotScale)

trajectories.ggplot(exp.LHS.trajectories, 
                    c('H', 'P'), c('coevo.H', 'coevo.P'),
                    'Populations', 'Coevolution coefficients',
                    cex = plotScale)

dev.off()
```

```{r 5_overview-trajectories-plot-print, dependson='5_overview-trajectories-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-", overview.variable.name, "_trajectories-ggplot.png"))
```

\newpage

## Scenarios

```{r 5_split-scenarios, include=FALSE, cache=TRUE, dependson='5_run-experiments-load'}
# exp.LHS.scenarios.names <- c(
#   'plantImprove', 'humanImprove', 'bothImprove',
#   'plantLessBase', 'humanLessBase', 'bothLessBase'
# )

# # mU.PnH > mU.P1H (mutualistic plant types give more utility = TRUE, else = FALSE)
exp.LHS_plantImprove <- factor(as.character(exp.LHS$mU.PnH > exp.LHS$mU.P1H),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('mU.PnH > mU.P1H', 
                                          'mU.PnH <= mU.P1H')
                               )

# # mU.HnP > mU.H1P (mutualistic human types give more utility = TRUE, else = FALSE)
exp.LHS_humanImprove <- factor(as.character(exp.LHS$mU.HnP > exp.LHS$mU.H1P),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('mU.HnP > mU.H1P',
                                          'mU.HnP <= mU.H1P'))

# # mU.PnH > mU.P1H AND mU.HnP > mU.H1P (mutualistic types give more utility = TRUE, else = FALSE)
exp.LHS_bothImprove <- factor(as.character(exp.LHS$mU.PnH > exp.LHS$mU.P1H & exp.LHS$mU.HnP > exp.LHS$mU.H1P),
                              levels = c('TRUE', 'FALSE'),
                              labels = c('mU.PnH > mU.P1H ~~~ AND ~~~ mU.HnP > mU.H1P', 
                                         'mU.PnH <= mU.P1H ~~~ AND ~~~ mU.HnP <= mU.H1P'))

# # U.bP1 > U.bPn (non-mutualistic plant types obtain more utility from other resources = TRUE, else = FALSE)
exp.LHS_plantLessBase <- factor(as.character(exp.LHS$U.bP1 > exp.LHS$U.bPn),
                                levels = c('TRUE', 'FALSE'),
                                labels = c('U.bP1 > U.bPn',
                                           'U.bP1 <= U.bPn'))

# # U.bH1 > U.bHn (non-mutualistic human types obtain more utility from other resources = TRUE, else = FALSE)
exp.LHS_humanLessBase <- factor(as.character(exp.LHS$U.bH1 > exp.LHS$U.bHn),
                                levels = c('TRUE', 'FALSE'),
                                labels = c('U.bH1 > U.bHn',
                                           'U.bH1 <= U.bHn'))

# # mU.PnH > mU.P1H AND mU.HnP > mU.H1P (non-mutualistic types obtain more utility from other resources = TRUE, else = FALSE)
exp.LHS_bothLessBase <- factor(as.character(exp.LHS$U.bP1 > exp.LHS$U.bPn & exp.LHS$U.bH1 > exp.LHS$U.bHn),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('mU.PnH > mU.P1H ~~~ AND ~~~ mU.HnP > mU.H1P',
                                          'mU.PnH <= mU.P1H ~~~ AND ~~~ mU.HnP <= mU.H1P'))
```

### Mutualistic human type gives more utility ($\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$)
\sectionmark{Scenario: $\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$}

**_Coevolution coefficients_**

```{r 5_scenarios-humanImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-humanImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_humanImprove,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-humanImprove-coevo-plot-print, dependson='5_scenarios-humanImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-humanImprove-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-humanImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-humanImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_humanImprove,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanImprove-depend-plot-print, dependson='5_scenarios-humanImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-humanImprove-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-humanImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-humanImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_humanImprove,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanImprove-timing-plot-print, dependson='5_scenarios-humanImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-humanImprove-ggplot.png")
```

\newpage

### Mutualistic plant type gives more utility ($\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$)
\sectionmark{Scenario: $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$}

**_Coevolution coefficients_**

```{r 5_scenarios-plantImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-plantImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_plantImprove,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-plantImprove-coevo-plot-print, dependson='5_scenarios-plantImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-plantImprove-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-plantImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-plantImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_plantImprove,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantImprove-depend-plot-print, dependson='5_scenarios-plantImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-plantImprove-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-plantImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-plantImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_plantImprove,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantImprove-timing-plot-print, dependson='5_scenarios-plantImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-plantImprove-ggplot.png")
```

\newpage

### Mutualistic types (human and plant) give more utility ($\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$ AND $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$)
\sectionmark{$\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$ AND $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$}

**_Coevolution coefficients_**

```{r 5_scenarios-bothImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-bothImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_bothImprove,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-bothImprove-coevo-plot-print, dependson='5_scenarios-bothImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-bothImprove-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-bothImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-bothImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_bothImprove,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothImprove-depend-plot-print, dependson='5_scenarios-bothImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-bothImprove-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-bothImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-bothImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_bothImprove,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothImprove-timing-plot-print, dependson='5_scenarios-bothImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-bothImprove-ggplot.png")
```

\newpage

### Mutualistic human type gets less utility from other resources ($U_{bH_{1}}>U_{bH_{n}}$)
\sectionmark{Scenario: $U_{bH_{1}}>U_{bH_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-humanLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-humanLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_humanLessBase,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-humanLessBase-coevo-plot-print, dependson='5_scenarios-humanLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-humanLessBase-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-humanLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-humanLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_humanLessBase,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanLessBase-depend-plot-print, dependson='5_scenarios-humanLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-humanLessBase-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-humanLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-humanLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_humanLessBase,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanLessBase-timing-plot-print, dependson='5_scenarios-humanLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-humanLessBase-ggplot.png")
```

\newpage

### Mutualistic plant type gets less utility from other resources ($U_{bP_{1}}>U_{bP_{n}}$)
\sectionmark{Scenario: $U_{bP_{1}}>U_{bP_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-plantLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-plantLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_plantLessBase,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-plantLessBase-coevo-plot-print, dependson='5_scenarios-plantLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-plantLessBase-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-plantLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-plantLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_plantLessBase,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantLessBase-depend-plot-print, dependson='5_scenarios-plantLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-plantLessBase-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-plantLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-plantLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_plantLessBase,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantLessBase-timing-plot-print, dependson='5_scenarios-plantLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-plantLessBase-ggplot.png")
```

\newpage

### Mutualistic types (human and plant) get less utility from other resources ($U_{bH_{1}}>U_{bH_{n}}$ AND $U_{bP_{1}}>U_{bP_{n}}$)
\sectionmark{Scenario: $U_{bH_{1}}>U_{bH_{n}}$ AND $U_{bP_{1}}>U_{bP_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-bothLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-bothLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_bothLessBase,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-bothLessBase-coevo-plot-print, dependson='5_scenarios-bothLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-bothLessBase-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-bothLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-bothLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_bothLessBase,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothLessBase-depend-plot-print, dependson='5_scenarios-bothLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-bothLessBase-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-bothLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-bothLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_bothLessBase,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothLessBase-timing-plot-print, dependson='5_scenarios-bothLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-bothLessBase-ggplot.png")
```


<!--chapter:end:5_multipleParameterExploration.Rmd-->


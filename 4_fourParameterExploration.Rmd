---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Four parameter exploration

```{r 4_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 
source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(kableExtra)
```

```{r 4_table-functions}
source("library/plotting/printTableRun.R")
source("library/plotting/printTableExperiment.R")
```

```{r 4_default-values, cache=TRUE}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
initial_population_humans_default = 10
initial_population_plants_default = 10
# number of discrete types
number_types_humans_default = 30
number_types_plants_default = 30    
# undirected variation 
undirected_variation_humans_default = 0.15
undirected_variation_plants_default = 0.15
# intrinsic growth rate 
intrinsic_growth_rate_humans_default = 0.04
intrinsic_growth_rate_plants_default = 0.1
# Utility per capita of individuals of type N
utility_per_capita_type_n_plants_to_humans_default = 1.5
utility_per_capita_type_n_humans_to_plants_default = 1
# Utility per capita of individuals of type 1
utility_per_capita_type_1_plants_to_humans_default = 0.15                           
utility_per_capita_type_1_humans_to_plants_default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
utility_other_to_type_n_humans_default = 10                               
utility_other_to_type_n_plants_default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
utility_other_to_type_1_humans_default = 80                               
utility_other_to_type_1_plants_default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
max_area_default = 200
# settings 
# simulation flow & data
max_iterations_default = 5000
reltol_exponential_default = 6
coevolution_threshold_default = 0.5
save_trajectories_default = TRUE
messages_default = FALSE
```

```{r 4_plot-functions, include=FALSE}
# this chunk is specific for this exploration 

plotDirectory <- "plots/4_exp_"
dataDirectory <- "data/4_exp_"

source("library/plotting/tripleRaster_fourParameters.R")
```

\newpage

## Number of types and undirected variation of humans and plants ($n_{H}$ x $n_{P}$ x $v_{H}$ x $v_{P}$)
\sectionmark{$n_{H}$ x $n_{P}$ x $v_{H}$ x $v_{P}$}

```{r 4_types_number_and_variation-values, cache=TRUE}
exp_types_number_and_variation_name <- "types_number_and_variation"

exp_types_number_and_variation_expDataFileName = paste0(dataDirectory, exp_types_number_and_variation_name,'.RData')
exp_types_number_and_variation_plotName = paste0(plotDirectory, exp_types_number_and_variation_name, "-tripleRaster_fourParameterss.png")

exp_number_types_humans_values <- seq(5, 45, by = 10)
exp_number_types_plants_values <- seq(5, 45, by = 10)
exp_undirected_variation_humans_values <- seq(0.05, 0.25, length.out = 5)
exp_undirected_variation_plants_values <- seq(0.05, 0.25, length.out = 5)
```

```{r 4_types_number_and_variation, cache=TRUE, dependson=c('4_default-values','4_types_number_and_variation-values'), results = 'hide'}
if(!file.exists(exp_types_number_and_variation_expDataFileName))
{
  exp_types_number_and_variation <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = exp_number_types_humans_values, ###
    number_types_plants = exp_number_types_plants_values, ###
    undirected_variation_humans = exp_undirected_variation_humans_values, ###
    undirected_variation_plants = exp_undirected_variation_plants_values, ###
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_types_number_and_variation, file = exp_types_number_and_variation_expDataFileName)
}
```

```{r 4_exp_types_number_and_variation-load, include=FALSE}
# load
load(exp_types_number_and_variation_expDataFileName)
```

```{r 4nvtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_types_number_and_variation')}
printTableExperiment(exp_types_number_and_variation, caption = 'Parameter setting')
```
```{r 4nvtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_types_number_and_variation')}
printTableExperiment(exp_types_number_and_variation, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_types_number_and_variation-plot, include=FALSE, cache=TRUE, dependson='4_types_number_and_variation'}
plotScale = 10#100 / length(exp_utility_other_to_type_n_plants_values)

png(exp_types_number_and_variation_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_types_number_and_variation, 
                            parameter_x = 'undirected_variation_humans', 
                            parameter_y = 'undirected_variation_plants', 
                            parameter_strip_x = 'number_types_humans', 
                            parameter_strip_y = 'number_types_plants', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants', 
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('undirected variation in humans (', v['H'], ')')),
                            parameter_y_label = expression(paste('undirected variation in plants ( ', v['P'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale)
dev.off()
```

```{r 4_types_number_and_variation-plot-print, echo=FALSE, dependson='4_types_number_and_variation-plot', out.width = '100%'}
knitr::include_graphics(exp_types_number_and_variation_plotName)
```

**_Interpretation_**:  
- Higher values of all four parameters facilitate coevolution. Undirected variation has a stronger effect than number of types. 
- As a summary of possible end-states:  
    + *'Fast' coevolution* (red square in blue tile, small *t*): most cases when the numbers of types ($n_{H}$, $n_{P}$) are greater than **15** and values of undirected variation ($v_{H}$, $v_{P}$) higher than **0.15**.  
    + *'Semi-domestication' without cultivation* (redish square in whitish tile): cases when $v_{P}\geq 0.15$ and $v_{H}\leq 0.15$.  
    + *'Semi-cultivation' without domestication* (whitish square in blue tile): cases when $v_{H}\geq 0.15$ and $v_{P}\leq 0.15$.
  
\newpage

## Utility per capita between humans and plants ($\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 4_utilities_between_populations-values, cache=TRUE}
exp_utilities_between_populations_name <- "utilities_between_populations"

exp_utilities_between_populations_expDataFileName = paste0(dataDirectory, exp_utilities_between_populations_name,'.RData')
exp_utilities_between_populations_plotName = paste0(plotDirectory, exp_utilities_between_populations_name, "-tripleRaster_fourParameterss.png")

exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 5)
```

```{r 4_utilities_between_populations, cache=TRUE, dependson=c('4_default-values','4_utilities_between_populations-values'), results = 'hide'}
if(!file.exists(exp_utilities_between_populations_expDataFileName))
{
  exp_utilities_between_populations <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utilities_between_populations, file = exp_utilities_between_populations_expDataFileName)
}
```

```{r 4_exp_utilities_between_populations-load, include=FALSE}
# load
load(exp_utilities_between_populations_expDataFileName)
```

```{r 4mUHPmUPHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_between_populations')}
printTableExperiment(exp_utilities_between_populations, caption = 'Parameter setting')
```

```{r 4mUHPmUPHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_between_populations')}
printTableExperiment(exp_utilities_between_populations, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_utilities_between_populations-plot, include=FALSE, cache=TRUE, dependson='4_utilities_between_populations'}
plotScale = 10#100 / length(exp_utility_other_to_type_n_plants_values)

png(exp_utilities_between_populations_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_utilities_between_populations, 
                            parameter_x = 'utility_per_capita_type_1_humans_to_plants',
                            parameter_y = 'utility_per_capita_type_1_plants_to_humans',  
                            parameter_strip_x = 'utility_per_capita_type_n_humans_to_plants',
                            parameter_strip_y = 'utility_per_capita_type_n_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants', 
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility per capita of type 1 humans to plants (', bar(U)['H1P'], ')')),
                            parameter_y_label = expression(paste('utility per capita of type 1 plants to humans ( ', bar(U)['P1H'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_utilities_between_populations-plot-print, echo=FALSE, dependson='4_utilities_between_populations-plot', out.width = '100%'}
knitr::include_graphics(exp_utilities_between_populations_plotName)
```

**_Interpretation_**:  
- Higher values of all four parameters facilitate coevolution; under the 'default' setting, a value around 1 is enough for all four parameters (intermediate values in this exploration).  
- Coevolution is still possible if any single one of these parameters equal zero (first rows or first columns). Under this type of conditions, cultivation (blue) is more probable than domestication (red), and the latter is strongly dependent on a non-null $\bar{U}_{H_{n}P}$.  
- As a summary of possible end-states:  
    + *'Fast' coevolution* (red square in blue tile, small *t*): most cases when values are greater than 0.75.  
    + *Domestication without cultivation* (red square in whitish tile): most cases when $\bar{U}_{H_{n}P}>0.75$, $\bar{U}_{H_{1}P}\geq 0.75$, $\bar{U}_{P_{n}H}=0$, and $\bar{U}_{P_{1}H}<2$.  
    + *Cultivation without domestication* (whitish square in blue tile): most cases when $\bar{U}_{H_{n}P} = 0$.

\newpage

## Utility from other resources to humans and plants ($U_{bH_{1}}$ x $U_{bP_{1}}$ x $U_{bH_{n}}$ x $U_{bP_{n}}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bP_{1}}$ x $U_{bH_{n}}$ x $U_{bP_{n}}$}

For this experiment, consider that the default setting includes $MaxArea=200$ (i.e. the maximum for the plant population).

```{r 4_utilities_other_to_populations-values, cache=TRUE}
exp_utilities_other_to_populations_name <- "utilities_other_to_populations"

exp_utilities_other_to_populations_expDataFileName = paste0(dataDirectory, exp_utilities_other_to_populations_name,'.RData')
exp_utilities_other_to_populations_plotName = paste0(plotDirectory, exp_utilities_other_to_populations_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_n_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_n_plants_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_1_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_1_plants_values <- seq(5, 300, length.out = 5)
```

```{r 4_utilities_other_to_populations, cache=TRUE, dependson=c('4_default-values','4_utilities_other_to_populations-values'), results = 'hide'}
if(!file.exists(exp_utilities_other_to_populations_expDataFileName))
{
  exp_utilities_other_to_populations <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ###
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utilities_other_to_populations, file = exp_utilities_other_to_populations_expDataFileName)
}
```

```{r 4_exp_utilities_other_to_populations-load, include=FALSE}
# load
load(exp_utilities_other_to_populations_expDataFileName)
```

```{r 4UbHUbPtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_other_to_populations')}
printTableExperiment(exp_utilities_other_to_populations, caption = 'Parameter setting')
```
```{r 4UbHUbPtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_other_to_populations')}
printTableExperiment(exp_utilities_other_to_populations, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_utilities_other_to_populations-plot, include=FALSE, cache=TRUE, dependson='4_utilities_other_to_populations'}
plotScale = 10#100 / length(exp_utility_other_to_type_n_plants_values)

png(exp_utilities_other_to_populations_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_utilities_other_to_populations, 
                            parameter_x = 'utility_other_to_type_1_humans', 
                            parameter_y = 'utility_other_to_type_1_plants',
                            parameter_strip_x = 'utility_other_to_type_n_humans', 
                            parameter_strip_y = 'utility_other_to_type_n_plants',
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                            parameter_y_label = expression(paste('utility of other to type 1 plants ( ', U['bP1'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 22, strip_text_size = 0.9)
dev.off()
```

```{r 4_utilities_other_to_populations-plot-print, echo=FALSE, dependson='4_utilities_other_to_populations-plot', out.width = '100%'}
knitr::include_graphics(exp_utilities_other_to_populations_plotName)
```

**_Interpretation_**:  
- Lower values of the two human-related parameters ($U_{bH_{1}}$, $U_{bH_{n}}$) facilitate coevolution; under the 'default' setting and for all four parameters, values greater or equal to $MaxArea$ (here, `r max_area_default`) impede coevolution. Inversely, higher values of the plant-related parameters ($U_{bP_{1}}$, $U_{bP_{n}}$) facilitate coevolution. The human-related parameters, together regulating the scale of the subsistence alternatives for humans, are significantly more important; their relationship (if one is greater than the other) seems to be less important as long as their combined sum is small enough.  
- Coevolution is likely to occur when $U_{bH_{1}}=5$ (first row in small grids), unless $U_{bH_{n}}$ is too big and $U_{bP_{1}}$ is too small.  
- As a summary of possible end-states:  
    + *'Fast' coevolution* (red square in blue tile, small *t*): most cases when $U_{bH_{1}}$ and $U_{bH_{n}}<153$.  
    + *Domestication without cultivation* (red square in whitish tile): most cases when $U_{bP_{n}}=5$, $U_{bP_{1}}=5$ (i.e. there is very little carrying capacity for plants beyond the anthropic space) and $U_{bH_{1}}>5$ (i.e. humans get enough of other resources when -still- not engaged in agriculture).  
    + *Cultivation without domestication* (whitish square in blue tile): *no cases are visible under these conditions*.

\newpage

## Utility from other resources to humans and utility per capita of plants to humans ($U_{bH_{1}}$ x $U_{bH_{n}}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bH_{n}}$ x $\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$}

All four parameters affect directly the carrying capacity for humans.

```{r 4_utilities_to_humans-values, cache=TRUE}
exp_utilities_to_humans_name <- "utilities_to_humans"

exp_utilities_to_humans_expDataFileName = paste0(dataDirectory, exp_utilities_to_humans_name,'.RData')
exp_utilities_to_humans_plotName = paste0(plotDirectory, exp_utilities_to_humans_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_n_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_1_humans_values <- seq(5, 300, length.out = 5)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 5)
```

```{r 4_utilities_to_humans, cache=TRUE, dependson=c('4_default-values','4_utilities_to_humans-values'), results = 'hide'}
if(!file.exists(exp_utilities_to_humans_expDataFileName))
{
  exp_utilities_to_humans <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default,
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utilities_to_humans, file = exp_utilities_to_humans_expDataFileName)
}
```

```{r 4_exp_utilities_to_humans-load, include=FALSE}
# load
load(exp_utilities_to_humans_expDataFileName)
```

```{r 4UbHUPHtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_to_humans')}
printTableExperiment(exp_utilities_to_humans, caption = 'Parameter setting')
```
```{r 4UbHUPHtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_to_humans')}
printTableExperiment(exp_utilities_to_humans, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_utilities_to_humans-plot, include=FALSE, cache=TRUE, dependson='4_utilities_to_humans'}
plotScale = 10

png(exp_utilities_to_humans_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_utilities_to_humans, 
                            parameter_x = 'utility_other_to_type_1_humans', 
                            parameter_y = 'utility_other_to_type_n_humans', 
                            parameter_strip_x = 'utility_per_capita_type_1_plants_to_humans', 
                            parameter_strip_y = 'utility_per_capita_type_n_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                            parameter_y_label = expression(paste('utility of other to type n humans (', U['bHn'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_utilities_to_humans-plot-print, echo=FALSE, dependson='4_utilities_to_humans-plot', out.width = '100%'}
knitr::include_graphics(exp_utilities_to_humans_plotName)
```

\newpage

## Utility from other resources to plants and utility per capita of humans to plants ($U_{bP_{1}}$ x $U_{bP_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bP_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$}

All four parameters affect directly the carrying capacity for plants.

```{r 4_utilities_to_plants-values, cache=TRUE}
exp_utilities_to_plants_name <- "utilities_to_plants"

exp_utilities_to_plants_expDataFileName = paste0(dataDirectory, exp_utilities_to_plants_name,'.RData')
exp_utilities_to_plants_plotName = paste0(plotDirectory, exp_utilities_to_plants_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_n_plants_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_1_plants_values <- seq(5, 300, length.out = 5)
exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 5)
```

```{r 4_utilities_to_plants, cache=TRUE, dependson=c('4_default-values','4_utilities_to_plants-values'), results = 'hide'}
if(!file.exists(exp_utilities_to_plants_expDataFileName))
{
  exp_utilities_to_plants <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ###
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utilities_to_plants, file = exp_utilities_to_plants_expDataFileName)
}
```

```{r 4_exp_utilities_to_plants-load, include=FALSE}
# load
load(exp_utilities_to_plants_expDataFileName)
```

```{r 4UbPUHPtablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_to_plants')}
printTableExperiment(exp_utilities_to_plants, caption = 'Parameter setting')
```
```{r 4UbPUHPtablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utilities_to_plants')}
printTableExperiment(exp_utilities_to_plants, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_utilities_to_plants-plot, include=FALSE, cache=TRUE, dependson='4_utilities_to_plants'}
plotScale = 10

png(exp_utilities_to_plants_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_utilities_to_plants, 
                            parameter_x = 'utility_other_to_type_1_plants',
                            parameter_y = 'utility_other_to_type_n_plants',
                            parameter_strip_x = 'utility_per_capita_type_1_humans_to_plants', 
                            parameter_strip_y = 'utility_per_capita_type_n_humans_to_plants', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type 1 plants (', U['bP1'], ')')),
                            parameter_y_label = expression(paste('utility of other to type n plants ( ', U['bPn'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_utilities_to_plants-plot-print, echo=FALSE, dependson='4_utilities_to_plants-plot', out.width = '100%'}
knitr::include_graphics(exp_utilities_to_plants_plotName)
```

\newpage

## Utility from other resources and utility per capita of type 1 humans and plants ($U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$}

This exploration reflects the state at the start of simulations (both populations are mostly of type 1).

```{r 4_type_1_traits_-values, cache=TRUE}
exp_type_1_traits_name <- "type_1_traits"

exp_type_1_traits_expDataFileName = paste0(dataDirectory, exp_type_1_traits_name,'.RData')
exp_type_1_traits_plotName = paste0(plotDirectory, exp_type_1_traits_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_1_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_1_plants_values <- seq(5, 300, length.out = 5)
exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 5)
```

```{r 4_type_1_traits, cache=TRUE, dependson=c('4_default-values','4_type_1_traits-values'), results = 'hide'}
if(!file.exists(exp_type_1_traits_expDataFileName))
{
  exp_type_1_traits <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default,
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_type_1_traits, file = exp_type_1_traits_expDataFileName)
}
```

```{r 4_exp_type_1_traits-load, include=FALSE}
# load
load(exp_type_1_traits_expDataFileName)
```

```{r 4Ub1mU1tablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_type_1_traits')}
printTableExperiment(exp_type_1_traits, caption = 'Parameter setting')
```
```{r 4Ub1mU1tablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_type_1_traits')}
printTableExperiment(exp_type_1_traits, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_type_1_traits-plot, include=FALSE, cache=TRUE, dependson='4_type_1_traits'}
plotScale = 10

png(exp_type_1_traits_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_type_1_traits, 
                            parameter_x = 'utility_other_to_type_1_humans', 
                            parameter_y = 'utility_other_to_type_1_plants', 
                            parameter_strip_x = 'utility_per_capita_type_1_humans_to_plants', 
                            parameter_strip_y = 'utility_per_capita_type_1_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                            parameter_y_label = expression(paste('utility of other to type 1 plants ( ', U['bP1'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_type_1_traits-plot-print, echo=FALSE, dependson='4_type_1_traits-plot', out.width = '100%'}
knitr::include_graphics(exp_type_1_traits_plotName)
```

\newpage

## Utility from other resources and utility per capita of type n humans and plants ($U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

This exploration reflects the state after a successful coevolution (both populations are mostly of type n).

```{r 4_type_n_traits_-values, cache=TRUE}
exp_type_n_traits_name <- "type_n_traits"

exp_type_n_traits_expDataFileName = paste0(dataDirectory, exp_type_n_traits_name,'.RData')
exp_type_n_traits_plotName = paste0(plotDirectory, exp_type_n_traits_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_n_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_n_plants_values <- seq(5, 300, length.out = 5)
exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 5)
```

```{r 4_type_n_traits, cache=TRUE, dependson=c('4_default-values','4_type_n_traits-values'), results = 'hide'}
if(!file.exists(exp_type_n_traits_expDataFileName))
{
  exp_type_n_traits <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ###
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_type_n_traits, file = exp_type_n_traits_expDataFileName)
}
```

```{r 4_exp_type_n_traits-load, include=FALSE}
# load
load(exp_type_n_traits_expDataFileName)
```

```{r 4UbnmUntablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_type_n_traits')}
printTableExperiment(exp_type_n_traits, caption = 'Parameter setting')
```
```{r 4UbnmUntablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_type_n_traits')}
printTableExperiment(exp_type_n_traits, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_type_n_traits-plot, include=FALSE, cache=TRUE, dependson='4_type_n_traits'}
plotScale = 10

png(exp_type_n_traits_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_type_n_traits, 
                            parameter_x = 'utility_other_to_type_n_humans', 
                            parameter_y = 'utility_other_to_type_n_plants', 
                            parameter_strip_x = 'utility_per_capita_type_n_humans_to_plants', 
                            parameter_strip_y = 'utility_per_capita_type_n_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type n humans (', U['bHn'], ')')),
                            parameter_y_label = expression(paste('utility of other to type n plants ( ', U['bPn'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_type_n_traits-plot-print, echo=FALSE, dependson='4_type_n_traits-plot', out.width = '100%'}
knitr::include_graphics(exp_type_n_traits_plotName)
```

\newpage

## Utility from other resources to type 1 humans and plants and utility per capita of type n humans and plants ($U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bH_{1}}$ x $\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 4_utility_boundaries_-values, cache=TRUE}
exp_utility_boundaries_name <- "utility_boundaries"

exp_utility_boundaries_expDataFileName = paste0(dataDirectory, exp_utility_boundaries_name,'.RData')
exp_utility_boundaries_plotName = paste0(plotDirectory, exp_utility_boundaries_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_1_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_1_plants_values <- seq(5, 300, length.out = 5)
exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 5)
```

```{r 4_utility_boundaries, cache=TRUE, dependson=c('4_default-values','4_utility_boundaries-values'), results = 'hide'}
if(!file.exists(exp_utility_boundaries_expDataFileName))
{
  exp_utility_boundaries <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default,
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_boundaries, file = exp_utility_boundaries_expDataFileName)
}
```

```{r 4_exp_utility_boundaries-load, include=FALSE}
# load
load(exp_utility_boundaries_expDataFileName)
```

```{r 4Ub1mUntablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utility_boundaries')}
printTableExperiment(exp_utility_boundaries, caption = 'Parameter setting')
```
```{r 4Ub1mUntablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utility_boundaries')}
printTableExperiment(exp_utility_boundaries, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_utility_boundaries-plot, include=FALSE, cache=TRUE, dependson='4_utility_boundaries'}
plotScale = 10

png(exp_utility_boundaries_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_utility_boundaries, 
                            parameter_x = 'utility_other_to_type_1_humans', 
                            parameter_y = 'utility_other_to_type_1_plants', 
                            parameter_strip_x = 'utility_per_capita_type_n_humans_to_plants', 
                            parameter_strip_y = 'utility_per_capita_type_n_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                            parameter_y_label = expression(paste('utility of other to type 1 plants ( ', U['bP1'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_utility_boundaries-plot-print, echo=FALSE, dependson='4_utility_boundaries-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_boundaries_plotName)
```

\newpage

## Utility from other resources to type n humans and plants and utility per capita of type 1 humans and plants ($U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$)
\sectionmark{$U_{bP_{n}}$ x $U_{bH_{n}}$ x $\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$}

```{r 4_utility_inverse_boundaries_-values, cache=TRUE}
exp_utility_inverse_boundaries_name <- "utility_inverse_boundaries"

exp_utility_inverse_boundaries_expDataFileName = paste0(dataDirectory, exp_utility_inverse_boundaries_name,'.RData')
exp_utility_inverse_boundaries_plotName = paste0(plotDirectory, exp_utility_inverse_boundaries_name, "-tripleRaster_fourParameterss.png")

exp_utility_other_to_type_n_humans_values <- seq(5, 300, length.out = 5)
exp_utility_other_to_type_n_plants_values <- seq(5, 300, length.out = 5)
exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 5)
exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 5)
```

```{r 4_utility_inverse_boundaries, cache=TRUE, dependson=c('4_default-values','4_utility_inverse_boundaries-values'), results = 'hide'}
if(!file.exists(exp_utility_inverse_boundaries_expDataFileName))
{
  exp_utility_inverse_boundaries <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ###
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,
    max_area = max_area_default,
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_inverse_boundaries, file = exp_utility_inverse_boundaries_expDataFileName)
}
```

```{r 4_exp_utility_inverse_boundaries-load, include=FALSE}
# load
load(exp_utility_inverse_boundaries_expDataFileName)
```

```{r 4UbnmU1tablehtml, eval=!params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utility_inverse_boundaries')}
printTableExperiment(exp_utility_inverse_boundaries, caption = 'Parameter setting')
```
```{r 4UbnmU1tablepdf, eval=params$ispdf, cache=TRUE, dependson=c('4_table-functions','4_utility_inverse_boundaries')}
printTableExperiment(exp_utility_inverse_boundaries, caption = 'Parameter setting', output = "latex")
```

\newpage

```{r 4_utility_inverse_boundaries-plot, include=FALSE, cache=TRUE, dependson='4_utility_inverse_boundaries'}
plotScale = 10

png(exp_utility_inverse_boundaries_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_fourParameters(exp_utility_inverse_boundaries, 
                            parameter_x = 'utility_other_to_type_n_humans', 
                            parameter_y = 'utility_other_to_type_n_plants', 
                            parameter_strip_x = 'utility_per_capita_type_1_humans_to_plants', 
                            parameter_strip_y = 'utility_per_capita_type_1_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility of other to type n humans (', U['bHn'], ')')),
                            parameter_y_label = expression(paste('utility of other to type n plants ( ', U['bPn'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                            variable_3_label = expression(t['end']),
                            plot_scale = plotScale,
                            strip_parameter_name_max_length = 28, strip_text_size = 0.9)
dev.off()
```

```{r 4_utility_inverse_boundaries-plot-print, echo=FALSE, dependson='4_utility_inverse_boundaries-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_inverse_boundaries_plotName)
```


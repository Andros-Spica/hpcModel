---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Multiple parameter exploration

```{r 5_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(ggpubr)
require(kableExtra)
```

```{r 5_table-functions}
source("library/plotting/exp.table.multiple.R")
```

```{r 5_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
iniH.default = 10
iniP.default = 10
# number of discrete types
n.H.default = 30
n.P.default = 30    
# undirected variation 
v.H.default = 0.15
v.P.default = 0.15
# intrinsic growth rate 
r.H.default = 0.04
r.P.default = 0.1
# Utility per capita of individuals of type N
mU.PnH.default = 1.5
mU.HnP.default = 1
# Utility per capita of individuals of type 1
mU.P1H.default = 0.15                           
mU.H1P.default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
U.bHn.default = 10                               
U.bPn.default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
U.bH1.default = 80                               
U.bP1.default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
MaxArea.default = 200
# settings 
# simulation flow & data
maxIt.default = 5000
tol.default = 6
timing.threshold.default = 0.5
saveTrajectories.default = TRUE
messages.default = TRUE
```

```{r 5_setup_plus, include=FALSE}
# this chunk is specific for this exploration
require(DoE.wrapper)    # LHS
require(randomForest)   # RF
require(party)          # classification / regression tree
require(parallel)       # use parallelization, it takes 8 min aprox

run.LHS.experiment <- function(experimentSettings, cluster)
{
  parallel::parLapply(cluster, 1:nrow(experimentSettings),
                      function(experimentIndex) {
                        RESULTS <- hpcModel.run(
                          iniH = iniH.default,
                          iniP = iniP.default,
                          n.H = experimentSettings[experimentIndex,     1],         
                          n.P = experimentSettings[experimentIndex,     2],        
                          v.H = experimentSettings[experimentIndex,     3],
                          v.P = experimentSettings[experimentIndex,     4],
                          r.H = experimentSettings[experimentIndex,     5], 
                          r.P = experimentSettings[experimentIndex,     6], 
                          mU.PnH = experimentSettings[experimentIndex,  7],
                          mU.HnP = experimentSettings[experimentIndex,  8],
                          mU.P1H = experimentSettings[experimentIndex,  9],
                          mU.H1P = experimentSettings[experimentIndex,  10],
                          U.bHn = experimentSettings[experimentIndex,   11],
                          U.bPn = experimentSettings[experimentIndex,   12], 
                          U.bH1 = experimentSettings[experimentIndex,   13],
                          U.bP1 = experimentSettings[experimentIndex,   14],
                          MaxArea = experimentSettings[experimentIndex, 15],
                          maxIt = maxIt.default,
                          tol = tol.default,
                          saveTrajectories = FALSE,
                          messages = FALSE
                        )
                        return(as.data.frame(RESULTS$END))
                      })
}

# same, but saving trajectories
run.LHS.experiment2 <- function(experimentSettings, cluster)
{
  parallel::parLapply(cluster, 1:nrow(experimentSettings),
                      function(experimentIndex) {
                        RESULTS <- hpcModel.run(
                          iniH = iniH.default,
                          iniP = iniP.default,
                          n.H = experimentSettings[experimentIndex,     1],         
                          n.P = experimentSettings[experimentIndex,     2],        
                          v.H = experimentSettings[experimentIndex,     3],
                          v.P = experimentSettings[experimentIndex,     4],
                          r.H = experimentSettings[experimentIndex,     5], 
                          r.P = experimentSettings[experimentIndex,     6], 
                          mU.PnH = experimentSettings[experimentIndex,  7],
                          mU.HnP = experimentSettings[experimentIndex,  8],
                          mU.P1H = experimentSettings[experimentIndex,  9],
                          mU.H1P = experimentSettings[experimentIndex,  10],
                          U.bHn = experimentSettings[experimentIndex,   11],
                          U.bPn = experimentSettings[experimentIndex,   12], 
                          U.bH1 = experimentSettings[experimentIndex,   13],
                          U.bP1 = experimentSettings[experimentIndex,   14],
                          MaxArea = experimentSettings[experimentIndex, 15],
                          maxIt = maxIt.default,
                          tol = tol.default,
                          saveTrajectories = TRUE,
                          messages = FALSE
                        )
                        return(RESULTS$TRAJECTORIES)
                      })
}
```

```{r 5_plot-functions, include=FALSE}
# this chunk is specific for this exploration
source("library/plotting/collapsed.ggplot.R")
source("library/plotting/trajectories.ggplot.R")
source("library/plotting/varImpPlot2.R")
source("library/plotting/parameters.effect.ggplot.R")
source("library/plotting/parameter.x.scenario.ggplot.R")
```

\newpage

## Sampling parameter values with Latin Hypercube Sampling (LHS)

```{r 5_LHS-values}
LHS.parameter.names <- c(
  'n.H', 'n.P',        
  'v.H', 'v.P',
  'r.H', 'r.P',
  'mU.PnH', 'mU.HnP', 'mU.P1H', 'mU.H1P',                                   
  'U.bHn', 'U.bPn', 'U.bH1', 'U.bP1',
  'MaxArea'
)
LHS.parameter.ranges <- list(
  n.H = c(3, 50),         
  n.P = c(3, 50),        
  v.H = c(0.1, 0.3),
  v.P = c(0.1, 0.3),
  r.H = c(0.01, 0.3),
  r.P = c(0.01, 0.3),
  mU.PnH = c(0, 3),
  mU.HnP = c(0, 3),
  mU.P1H = c(0, 3),                                  
  mU.H1P = c(0, 3),                                   
  U.bHn = c(1, 300),                                
  U.bPn = c(1, 300), 
  U.bH1 = c(1, 300),                               
  U.bP1 = c(1, 300),
  MaxArea = c(1, 300)
)
```

**parameter**       | **value**
 ------------------ | ----------------------------------
 `n.H`, `n.P`       | [`r LHS.parameter.ranges$n.H[1]`, `r LHS.parameter.ranges$n.H[2]`], [`r LHS.parameter.ranges$n.P[1]`, `r LHS.parameter.ranges$n.P[2]`]
 `v.H`, `v.P`       | [`r LHS.parameter.ranges$v.H[1]`, `r LHS.parameter.ranges$v.H[2]`], [`r LHS.parameter.ranges$v.P[1]`, `r LHS.parameter.ranges$v.P[2]`]
  `r.H`, `r.P`       | [`r LHS.parameter.ranges$r.H[1]`, `r LHS.parameter.ranges$r.H[2]`], [`r LHS.parameter.ranges$r.P[1]`, `r LHS.parameter.ranges$r.P[2]`]
 `mU.PnH`, `mU.HnP` | [`r LHS.parameter.ranges$mU.PnH[1]`, `r LHS.parameter.ranges$mU.PnH[2]`], [`r LHS.parameter.ranges$mU.HnP[1]`, `r LHS.parameter.ranges$mU.HnP[2]`]
 `mU.P1H`, `mU.H1P` | [`r LHS.parameter.ranges$mU.P1H[1]`, `r LHS.parameter.ranges$mU.P1H[2]`], [`r LHS.parameter.ranges$mU.H1P[1]`, `r LHS.parameter.ranges$mU.H1P[2]`]
 `U.bH1`, `U.bP1`   | [`r LHS.parameter.ranges$U.bH1[1]`, `r LHS.parameter.ranges$U.bH1[2]`], [`r LHS.parameter.ranges$U.bP1[1]`, `r LHS.parameter.ranges$U.bP1[2]`]
 `U.bHn`, `U.bPn`   | [`r LHS.parameter.ranges$U.bHn[1]`, `r LHS.parameter.ranges$U.bHn[2]`], [`r LHS.parameter.ranges$U.bPn[1]`, `r LHS.parameter.ranges$U.bPn[2]`]
 `MaxArea`   | [`r LHS.parameter.ranges$MaxArea[1]`, `r LHS.parameter.ranges$MaxArea[2]`]

Table: Ranges of parameter exploration

```{r 5_LHS, include=FALSE}
### generate LHS design (strauss method, with 0.2 radious interaction)
if (!file.exists('data/5_LHS.RData')) # you must delete "LHS.RData" to create a new file
{
  LHS <- DoE.wrapper::lhs.design(
    nruns = 10000, # probably should be greater
    nfactors = 15,
    type = 'strauss',
    seed = 777,
    factor.names = LHS.parameter.ranges,
    digits = c(0, 0, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4),
    RND = 0.2
  )

  # save
  save(LHS, file = 'data/5_LHS.RData')
}
```

```{r 5_LHS-load, include=FALSE}
# load
load('data/5_LHS.RData')

# build PARS
PARS <- as.data.frame(LHS)
```

```{r 5LHStablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_LHS-load'}
source("library/plotting/exp.table.multiple.R") # sometimes bookdown rendering will act up and ignore the chunks loading functions
exp.table.multiple(PARS, numberOfParameters = 15, caption = 'ACTUAL parameter values')
```
```{r 5LHStablepdf, eval=params$ispdf, cache=TRUE, dependson='5_LHS-load'}
exp.table.multiple(PARS, numberOfParameters = 15, caption = 'ACTUAL parameter values', output = "latex")
```

\newpage

```{r 5_LHS-pairs-plot, cache=TRUE, dependson='5_LHS-load'}
plotScale = 10

png("plots/5_multiplePar-LHS_pairs-plot.png",
    width = 100 * plotScale, height = 100 * plotScale)
pairs(LHS, pch='Â·')
invisible(dev.off())
```

```{r 5_LHS-pairs-plot-print, dependson='5_LHS-pairs-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-LHS_pairs-plot.png")
```

\newpage

## Experiment overview

```{r 5_run-experiments, include=FALSE}
### run the model for every setting according to the LHS design
if(!file.exists('data/5_exp.LHS.RData')) # you must delete "exp.LHS.RData" to create a new file
{
  
  # build cluster
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('hpcModel.run', 'Fitness', 'coevo.coef', 
                     'PARS', 
                     'iniH.default', 'iniP.default', 'maxIt.default', 'tol.default'), 
                envir = environment())
  
  # loop
  exp.LHS <- run.LHS.experiment(PARS, cl)
  
  # stop cluster and clean
  stopCluster(cl)
  rm(cl)
  gc()
  
  # bind result
  exp.LHS <- do.call('rbind', exp.LHS)
  
  # build object
  exp.LHS <- cbind(PARS, exp.LHS)
  
  # save
  save(exp.LHS, file = 'data/5_exp.LHS.RData')
}
```

```{r 5_run-experiments-load, include=FALSE, dependson='5_run-experiments'}
# load
load('data/5_exp.LHS.RData')

H.exists <- !is.na(exp.LHS$H) & exp.LHS$H > 0
P.exists <- !is.na(exp.LHS$P) & exp.LHS$P > 0
H.fullEvolved <- exp.LHS$coevo.H > 0.5 & H.exists
P.fullEvolved <- exp.LHS$coevo.P > 0.5 & P.exists
H.mildEvolved <- exp.LHS$coevo.H > 0 & exp.LHS$coevo.H <= 0.5 & H.exists
P.mildEvolved <-  exp.LHS$coevo.P > 0 & exp.LHS$coevo.P <= 0.5 & P.exists
H.notByFarEvolved <- exp.LHS$coevo.H < -0.5 & H.exists
P.notByFarEvolved <- exp.LHS$coevo.P < -0.5 & P.exists

```

### End-states

**_Are there any humans?_**
```{r 5existHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.exists), "html")
```
```{r 5existHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.exists), "latex")
```

**_Are there any plants?_**
```{r 5existPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.exists), "html")
```
```{r 5existPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.exists), "latex")
```

**_Did humans not evolved by far? (coevolution coefficient is less than -0.5)_**
```{r 5notEvolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.notByFarEvolved), "html")
```
```{r 5notEvolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.notByFarEvolved), "latex")
```

**_Did plants not evolved by far? (coevolution coefficient is less than -0.5)_**
```{r 5notEvolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.notByFarEvolved), "html")
```
```{r 5notEvolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.notByFarEvolved), "latex")
```

**_Did humans evolved mildly? (coevolution coefficient is positive, but less than 0.5)_**
```{r 5mildEvolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.mildEvolved), "html")
```
```{r 5mildEvolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.mildEvolved), "latex")
```

**_Did plants evolved mildly? (coevolution coefficient is positive, but less than 0.5)_**
```{r 5mildEvolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.mildEvolved), "html")
```
```{r 5mildEvolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.mildEvolved), "latex")
```

**_Did humans evolved fully? (coevolution coefficient is greater than 0.5)_**
```{r 5evolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.fullEvolved), "html")
```
```{r 5evolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(H.fullEvolved), "latex")
```

**_Did plants evolved fully? (coevolution coefficient is greater than 0.5)_**
```{r 5evolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.fullEvolved), "html")
```
```{r 5evolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(P.fullEvolved), "latex")
```

**_Population and output variables_**

```{r 5_variables-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

png("plots/5_multiplePar-variables-ggplot.png",
    width = 100 * plotScale,
    height = 100 * plotScale
)

varsSummary1.data <- melt(exp.LHS[, c('H', 'P', 'coevo.H', 'coevo.P', 'depend.H', 'depend.P')])

g1 <- ggplot(data = varsSummary1.data, aes(value)) +
  geom_histogram() +
  facet_wrap(.~variable, ncol = 2, scales = "free")

varsSummary2.data <- melt(exp.LHS[, c('time', 'timing.H', 'timing.P')])

g2 <- ggplot(data = varsSummary2.data, aes(value)) +
  geom_histogram() +
  facet_wrap(.~variable, scales = "free")

ggpubr::ggarrange(g1, g2, nrow = 2, heights = c(3, 1))

dev.off()
```

```{r 5_variables-plot-print, dependson='5_variables-plots', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-variables-ggplot.png")
```

### Trajectories

```{r 5_exp.LHS.trajectories, include=FALSE}
if(!file.exists('data/5_exp.LHS.trajectories.RData'))
{
  set.seed(0)
  
  number.trajectories = 5
  
  PARS.sample <- PARS[
    ## for sampling random trajectories
    #sample(1:nrow(PARS), number.trajectories)
    ### for selecting one random run of each of the following types:
    c(
      # No coevolution (not evolved, not mild evolved, but exists)
      sample((1:nrow(PARS))[H.notByFarEvolved & P.notByFarEvolved], 1),
      # Domestication without cultivation
      sample((1:nrow(PARS))[H.notByFarEvolved & P.fullEvolved], 1),
      # Cultivation without domestication
      sample((1:nrow(PARS))[H.fullEvolved & P.notByFarEvolved], 1),
      # Mild coevolution
      sample((1:nrow(PARS))[H.mildEvolved & P.mildEvolved], 1),
      # Coevolution
      sample((1:nrow(PARS))[H.fullEvolved & P.fullEvolved], 1)
    )
    ,]
  
  # build cluster
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('hpcModel.run', 'Fitness', 'coevo.coef', 
                     'PARS.sample', 
                     'iniH.default', 'iniP.default', 'maxIt.default', 'tol.default'), 
                envir = environment())
  
  # loop
  exp.LHS.trajectories.list <- run.LHS.experiment2(PARS.sample, cl)
  
  # stop cluster and clean
  stopCluster(cl)
  rm(cl)
  gc()
  
  # build object
  exp.LHS.trajectories <- c()
  
  for (runIndex in 1:number.trajectories)
  {
    exp.LHS.trajectories <- rbind(
      exp.LHS.trajectories,
      cbind(
        run = rep(runIndex, nrow(exp.LHS.trajectories.list[[runIndex]])),
        time = 1:(nrow(exp.LHS.trajectories.list[[runIndex]])),
        exp.LHS.trajectories.list[[runIndex]][,c('H', 'P', 'coevo.H', 'coevo.P')]
      )
    )
  }
  
  exp.LHS.trajectories <- exp.LHS.trajectories[!is.na(exp.LHS.trajectories$H) & exp.LHS.trajectories$H > 0,]
  
  rm(exp.LHS.trajectories.list)
  
  # save
  save(exp.LHS.trajectories, file = 'data/5_exp.LHS.trajectories.RData')
}
```

```{r 5_overview-trajectories-plot, include=FALSE, cache=TRUE}
load('data/5_exp.LHS.trajectories.RData')

source("library/plotting/trajectories.ggplot.R")

overview.variable.name = 'pop'

plotScale = 10

png(paste0("plots/5_multiplePar-", overview.variable.name, "_trajectories-ggplot.png"),
    width = 100 * plotScale, height = 50 * plotScale)

trajectories.ggplot(exp.LHS.trajectories, 
                    c('H', 'P'), c('coevo.H', 'coevo.P'),
                    'Populations', 'Coevolution coefficients',
                    cex = plotScale)

dev.off()
```

```{r 5_overview-trajectories-plot-print, dependson='5_overview-trajectories-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-", overview.variable.name, "_trajectories-ggplot.png"))
```

\newpage

```{r 5_overview-endstates-plot, include=FALSE, cache=TRUE}
plotScale = 10

png(paste0("plots/5_multiplePar-coevo_endstates-ggplot.png"),
    width = 50 * plotScale, height = 50 * plotScale)

ggplot(data = exp.LHS, aes(x = coevo.H, y = coevo.P)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0) + geom_vline(xintercept = 0) +
  geom_hline(yintercept = -1) + geom_vline(xintercept = -1) +
  geom_hline(yintercept = 1) + geom_vline(xintercept = 1)

dev.off()
```

```{r 5_overview-endstates-plot-print, dependson='5_overview-endstates-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-coevo_endstates-ggplot.png"))
```

\newpage

## Random forest

### Optimisation 

```{r 5_RF.tunning.preparation, include=FALSE}
set.seed(777)

exp.LHS.r <- exp.LHS[P.exists,]

exp.LHS.r <- exp.LHS.r[sample(1:nrow(exp.LHS.r), nrow(exp.LHS.r)),]

exp.LHS.spl <- split(as.data.frame(exp.LHS.r), 
                     f = factor(ceiling(seq_along(1:nrow(exp.LHS.r)) / 1000)))

Grid <- expand.grid(mtry = c(2:10), ntree = seq(500, 2000, 500))
```

```{r 5_RF.tunning.H, include=FALSE}
if (!file.exists('data/5_RF.coevo.H-tunning.RData')) # you must delete "RF.coevo.H-tunning.RData" to create a new file
{
  # cluster and loop
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('randomForest', 'Grid', 'LHS.parameter.names', 'exp.LHS.spl'), 
                envir = environment())
  
  RF.coevo.H.tunning <- parSapply(cl, 1:nrow(Grid), function(p) {
    aux <- c()
    for (i in 1:10) {
      X <- do.call(rbind, exp.LHS.spl[-i])
      RF.coevo.H <- randomForest(
        as.formula(paste0("coevo.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
        data = X,
        mtry = Grid[p, 1],
        ntree = Grid[p, 2]
      )
      acc.coevo.H <- 
        mean((predict(RF.coevo.H, exp.LHS.spl[[i]][, 1:15]) - exp.LHS.spl[[i]]$coevo.H) ^ 2)
      
      rm(RF.coevo.H)
      gc()
      
      aux[i] <- acc.coevo.H
    }
    
    return(mean(aux))
  })

  RF.coevo.H.tunning <- cbind(Grid, mean.predict = RF.coevo.H.tunning)
  # save
  save(RF.coevo.H.tunning, file = 'data/5_RF.coevo.H-tunning.RData')
}
```

```{r 5_RF.coevo.H.tunning-load, include=FALSE}
# load
load('data/5_RF.coevo.H-tunning.RData')
```

```{r 5_RF.tunning.P, include=FALSE, eval=FALSE}
if (!file.exists('data/5_RF.coevo.P-tunning.RData')) # you must delete "RF.coevo.P-tunning.RData" to create a new file
{
  # cluster and loop
  cl <- makeCluster(6)
  clusterExport(cl, 
                list('randomForest', 'Grid', 'LHS.parameter.names', 'exp.LHS.spl'), 
                envir = environment())
  
  RF.coevo.P.tunning <- parSapply(cl, 1:nrow(Grid), function(p) {
    aux <- c()
    for (i in 1:10) {
      exp.LHS.leftOneOut <- do.call(rbind, exp.LHS.spl[-i])
      RF.coevo.P <- randomForest(
        as.formula(paste0("coevo.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
        data = exp.LHS.leftOneOut,
        mtry = Grid[p, 1],
        ntree = Grid[p, 2]
      )
      acc.coevo.P <- 
        mean((predict(RF.coevo.P, exp.LHS.spl[[i]][, 1:15]) - exp.LHS.spl[[i]]$coevo.P) ^ 2)
      
      rm(RF.coevo.p)
      gc()
      
      aux[i] <- acc.coevo.P
    }
    
    return(mean(aux))
  })

  RF.coevo.P.tunning <- cbind(Grid, mean.predict = RF.coevo.P.tunning)
  # save
  save(RF.coevo.P.tunning, file = 'data/5_RF.coevo.P-tunning.RData')
}
```

```{r 5_RF.coevo.P.tunning-load, include=FALSE}
# load
load('data/5_RF.coevo.P-tunning.RData')
```

```{r 5_RF.coevo.tunning-plot, dependson=c('5_RF.coevo.H.tunning-load', '5_RF.coevo.P.tunning-load'), out.width = '100%'}
temp <- cbind(
  output.var = c(
    rep('coevo.H', nrow(RF.coevo.H.tunning)), 
    rep('coevo.P', nrow(RF.coevo.P.tunning))
    ),
  rbind(RF.coevo.H.tunning, RF.coevo.P.tunning)
  )

ggplot(temp, aes(x = ntree, y = mtry)) + 
  geom_tile(aes(fill = mean.predict), colour = "white") + 
  scale_fill_gradient(low = "white", high = "black") +
  geom_text(aes(label = round(mean.predict, 5)), color = "steelblue", size = 2.5) +
  facet_wrap(.~output.var) + theme_bw()
```

\newpage

### Coevolution coefficients

Only using those runs with any humans (coevo.H) and plants (coevo.P) at the end-state.

```{r 5_RF-coevo.H, include=FALSE, cache=TRUE}
if(!file.exists('data/5_RF.coevo.H.RData'))
{
  RF.coevo.H <-
  randomForest::randomForest(
    as.formula(paste0("coevo.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
    data = exp.LHS[H.exists,],
    mtry = 5,
    ntree = 1000,
    importance = T
  )
  #RF.coevo.H$error <- mean((predict(RF.coevo.H, exp.LHS[, 1:12]) - exp.LHS$coevo.H) ^ 2)
  # save
  save(RF.coevo.H, file = 'data/5_RF.coevo.H.RData')
}
```

```{r 5_RF-coevo.P, include=FALSE, cache=TRUE}
if(!file.exists('data/5_RF.coevo.P.RData'))
{
  RF.coevo.P <-
    randomForest::randomForest(
      as.formula(paste0("coevo.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[P.exists,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.coevo.P$error <- mean((predict(RF.coevo.P, exp.LHS[, 1:12]) - exp.LHS$coevo.P) ^ 2)
  # save
  save(RF.coevo.P, file = 'data/5_RF.coevo.P.RData')
}
```

```{r 5_RF.coevo-load, include=FALSE}
# load
load('data/5_RF.coevo.H.RData')
load('data/5_RF.coevo.P.RData')
```

```{r 5_RF-coevo-plots, include=FALSE, cache=TRUE, dependson='5_RF.coevo-load'}
source("library/plotting/varImpPlot2.R") # sometimes bookdown rendering will act up and ignore the chunks loading functions

plotScale = 2

png("plots/5_multiplePar-RF-coevo.png", width = 640 * plotScale, height = 360 * plotScale)
varImpPlot2Pair(RF.coevo.H, RF.coevo.P, cex = plotScale)
dev.off()
```

```{r 5_RF-coevo-plot-print, dependson='5_RF-coevo-plots', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-RF-coevo.png"))
```

\newpage

### Dependency coefficients

Only using those runs with any humans (depend.H) and plants (depend.P) at the end-state.

```{r 5_RF-depend.H, include=FALSE, cache=TRUE}
if(!file.exists('data/5_RF.depend.H.RData'))
{
  RF.depend.H <-
    randomForest::randomForest(
      as.formula(paste0("depend.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[H.exists,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.depend.H$error <- mean((predict(RF.depend.H, exp.LHS[, 1:12]) - exp.LHS$depend.H) ^ 2)
  # save
  save(RF.depend.H, file = 'data/5_RF.depend.H.RData')
}
```

```{r 5_RF-depend.P, include=FALSE, cache=TRUE}
if(!file.exists('data/5_RF.depend.P.RData'))
{
  RF.depend.P <-
    randomForest::randomForest(
      as.formula(paste0("depend.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[P.exists,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.depend.P$error <- mean((predict(RF.depend.P, exp.LHS[, 1:12]) - exp.LHS$depend.P) ^ 2)
  # save
  save(RF.depend.P, file = 'data/5_RF.depend.P.RData')
}
```

```{r 5_RF.depend-load, include=FALSE}
# load
load('data/5_RF.depend.H.RData')
load('data/5_RF.depend.P.RData')
```

```{r 5_RF-depend-plots, include=FALSE, cache=TRUE, dependson='5_RF.depend-load'}
plotScale = 2

png("plots/5_multiplePar-RF-depend.png", width = 640 * plotScale, height = 360 * plotScale)
varImpPlot2Pair(RF.depend.H, RF.depend.P, cex = plotScale)
dev.off()
```

```{r 5_RF-depend.H-plot-print, dependson='5_RF-depend-plots', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-RF-depend.png"))
```

### Timings

Only using those runs with successful human (timing.H) and plant (timing.P) evolution.

```{r 5_RF-timing.H, include=FALSE, cache=TRUE}
if(!file.exists('data/5_RF.timing.H.RData'))
{
  RF.timing.H <-
    randomForest::randomForest(
      as.formula(paste0("timing.H ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[H.fullEvolved,], # filter out cases where humans did not evolved towards n
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.timing.H$error <- mean((predict(RF.timing.H, exp.LHS[, 1:12]) - exp.LHS$timing.H) ^ 2)
  # save
  save(RF.timing.H, file = 'data/5_RF.timing.H.RData')
}
```

```{r 5_RF-timing.P, include=FALSE, cache=TRUE}
if(!file.exists('data/5_RF.timing.P.RData'))
{
  RF.timing.P <-
    randomForest::randomForest(
      as.formula(paste0("timing.P ~ ", paste(LHS.parameter.names, collapse = '+'))),
      data = exp.LHS[P.fullEvolved,], # filter out cases where plants did not evolved towards n
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  #RF.timing.P$error <- mean((predict(RF.timing.P, exp.LHS[, 1:12]) - exp.LHS$timing.P) ^ 2)
  # save
  save(RF.timing.P, file = 'data/5_RF.timing.P.RData')
}
```

```{r 5_RF.timing-load, include=FALSE}
# load
load('data/5_RF.timing.H.RData')
load('data/5_RF.timing.P.RData')
```

```{r 5_RF-timing-plots, include=FALSE, cache=TRUE, dependson='5_RF.timing-load'}
plotScale = 2

png("plots/5_multiplePar-RF-timing.png", width = 640 * plotScale, height = 360 * plotScale)
varImpPlot2Pair(RF.timing.H, RF.timing.P, cex = plotScale)
dev.off()
```

```{r 5_RF-timing.H-plot-print, dependson='5_RF-timing-plots', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-RF-timing.png"))
```

\newpage

## Visualisation of parameter effect

### The effect on coevolution coefficients of the utility per capita of type n humans to plants ($\bar{U}_{H_{n}P}$)
\sectionmark{Visualising effect of $\bar{U}_{H_{n}P}$}

```{r 5_overview-collapsed-plot, include=FALSE, cache=TRUE}
source("library/plotting/collapsed.ggplot.R")

parEffect.variable.name = 'coevo'
plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png(paste0("plots/5_multiplePar-", parEffect.variable.name, "_collapsed-ggplot.png"),
    width = 100 * plotScale, height = 100 * plotScale)
collapsed.ggplot(exp.LHS,
                 'mU.HnP', 'coevo.H', 'coevo.P',
                 ylab = "coevolution coefficient",
                 plotScale = plotScale)
dev.off()
```

```{r 5_overview-collapsed-plot-print, dependson='5_overview-collapsed-plot', out.width = '100%'}
knitr::include_graphics(paste0("plots/5_multiplePar-", parEffect.variable.name, "_collapsed-ggplot.png"))
```

\newpage

### All parameters

**_Coevolution coefficients_**

```{r 5_scenarios-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameters.effect.ggplot.R")

plotScale = 10

png("plots/5_multiplePar-coevo-ggplot.png",
    width = 200 * plotScale,
    height = 50 * plotScale
)
parameters.effect.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-coevo-plot-print, dependson='5_scenarios-humanImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameters.effect.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameters.effect.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-depend-plot-print, dependson='5_scenarios-humanImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameters.effect.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-timing-plot-print, dependson='5_scenarios-humanImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-ggplot.png")
```

\newpage

## Parameter effect split by scenarios

```{r 5_split-scenarios, include=FALSE, cache=TRUE, dependson='5_run-experiments-load'}
# exp.LHS.scenarios.names <- c(
#   'plantImprove', 'humanImprove', 'bothImprove',
#   'plantLessBase', 'humanLessBase', 'bothLessBase'
# )

# # mU.PnH > mU.P1H (mutualistic plant types give more utility = TRUE, else = FALSE)
exp.LHS_plantImprove <- factor(as.character(exp.LHS$mU.PnH > exp.LHS$mU.P1H),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('mU.PnH > mU.P1H', 
                                          'mU.PnH <= mU.P1H')
                               )

# # mU.HnP > mU.H1P (mutualistic human types give more utility = TRUE, else = FALSE)
exp.LHS_humanImprove <- factor(as.character(exp.LHS$mU.HnP > exp.LHS$mU.H1P),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('mU.HnP > mU.H1P',
                                          'mU.HnP <= mU.H1P'))

# # mU.PnH > mU.P1H AND mU.HnP > mU.H1P (mutualistic types give more utility = TRUE, else = FALSE)
exp.LHS_bothImprove <- factor(as.character(exp.LHS$mU.PnH > exp.LHS$mU.P1H & exp.LHS$mU.HnP > exp.LHS$mU.H1P),
                              levels = c('TRUE', 'FALSE'),
                              labels = c('mU.PnH > mU.P1H ~~~ AND ~~~ mU.HnP > mU.H1P', 
                                         'mU.PnH <= mU.P1H ~~~ AND ~~~ mU.HnP <= mU.H1P'))

# # U.bP1 > U.bPn (non-mutualistic plant types obtain more utility from other resources = TRUE, else = FALSE)
exp.LHS_plantLessBase <- factor(as.character(exp.LHS$U.bP1 > exp.LHS$U.bPn),
                                levels = c('TRUE', 'FALSE'),
                                labels = c('U.bP1 > U.bPn',
                                           'U.bP1 <= U.bPn'))

# # U.bH1 > U.bHn (non-mutualistic human types obtain more utility from other resources = TRUE, else = FALSE)
exp.LHS_humanLessBase <- factor(as.character(exp.LHS$U.bH1 > exp.LHS$U.bHn),
                                levels = c('TRUE', 'FALSE'),
                                labels = c('U.bH1 > U.bHn',
                                           'U.bH1 <= U.bHn'))

# # mU.PnH > mU.P1H AND mU.HnP > mU.H1P (non-mutualistic types obtain more utility from other resources = TRUE, else = FALSE)
exp.LHS_bothLessBase <- factor(as.character(exp.LHS$U.bP1 > exp.LHS$U.bPn & exp.LHS$U.bH1 > exp.LHS$U.bHn),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('mU.PnH > mU.P1H ~~~ AND ~~~ mU.HnP > mU.H1P',
                                          'mU.PnH <= mU.P1H ~~~ AND ~~~ mU.HnP <= mU.H1P'))
```

### Mutualistic human type gives more utility ($\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$)
\sectionmark{Scenario: $\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$}

**_Coevolution coefficients_**

```{r 5_scenarios-humanImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-humanImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_humanImprove,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-humanImprove-coevo-plot-print, dependson='5_scenarios-humanImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-humanImprove-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-humanImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-humanImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_humanImprove,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanImprove-depend-plot-print, dependson='5_scenarios-humanImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-humanImprove-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-humanImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-humanImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_humanImprove,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanImprove-timing-plot-print, dependson='5_scenarios-humanImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-humanImprove-ggplot.png")
```

\newpage

### Mutualistic plant type gives more utility ($\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$)
\sectionmark{Scenario: $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$}

**_Coevolution coefficients_**

```{r 5_scenarios-plantImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-plantImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_plantImprove,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-plantImprove-coevo-plot-print, dependson='5_scenarios-plantImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-plantImprove-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-plantImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-plantImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_plantImprove,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantImprove-depend-plot-print, dependson='5_scenarios-plantImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-plantImprove-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-plantImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-plantImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_plantImprove,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantImprove-timing-plot-print, dependson='5_scenarios-plantImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-plantImprove-ggplot.png")
```

\newpage

### Mutualistic types (human and plant) give more utility ($\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$ AND $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$)
\sectionmark{$\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$ AND $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$}

**_Coevolution coefficients_**

```{r 5_scenarios-bothImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-bothImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_bothImprove,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-bothImprove-coevo-plot-print, dependson='5_scenarios-bothImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-bothImprove-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-bothImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-bothImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_bothImprove,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothImprove-depend-plot-print, dependson='5_scenarios-bothImprove-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-bothImprove-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-bothImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-bothImprove-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_bothImprove,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothImprove-timing-plot-print, dependson='5_scenarios-bothImprove-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-bothImprove-ggplot.png")
```

\newpage

### Mutualistic human type gets less utility from other resources ($U_{bH_{1}}>U_{bH_{n}}$)
\sectionmark{Scenario: $U_{bH_{1}}>U_{bH_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-humanLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-humanLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_humanLessBase,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-humanLessBase-coevo-plot-print, dependson='5_scenarios-humanLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-humanLessBase-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-humanLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-humanLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_humanLessBase,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanLessBase-depend-plot-print, dependson='5_scenarios-humanLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-humanLessBase-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-humanLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-humanLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_humanLessBase,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-humanLessBase-timing-plot-print, dependson='5_scenarios-humanLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-humanLessBase-ggplot.png")
```

\newpage

### Mutualistic plant type gets less utility from other resources ($U_{bP_{1}}>U_{bP_{n}}$)
\sectionmark{Scenario: $U_{bP_{1}}>U_{bP_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-plantLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-plantLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_plantLessBase,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-plantLessBase-coevo-plot-print, dependson='5_scenarios-plantLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-plantLessBase-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-plantLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-plantLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_plantLessBase,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantLessBase-depend-plot-print, dependson='5_scenarios-plantLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-plantLessBase-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-plantLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-plantLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_plantLessBase,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-plantLessBase-timing-plot-print, dependson='5_scenarios-plantLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-plantLessBase-ggplot.png")
```

\newpage

### Mutualistic types (human and plant) get less utility from other resources ($U_{bH_{1}}>U_{bH_{n}}$ AND $U_{bP_{1}}>U_{bP_{n}}$)
\sectionmark{Scenario: $U_{bH_{1}}>U_{bH_{n}}$ AND $U_{bP_{1}}>U_{bP_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-bothLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-coevo-bothLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'coevo.H', 'coevo.P',
                            scenarioSplitter = exp.LHS_bothLessBase,
                            ylab = "coevolution coefficient",
                            plotScale = plotScale)
dev.off()
```

```{r 5_scenarios-bothLessBase-coevo-plot-print, dependson='5_scenarios-bothLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-coevo-bothLessBase-ggplot.png")
```

**_Dependency coefficients_**

```{r 5_scenarios-bothLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-depend-bothLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'depend.H', 'depend.P',
                            scenarioSplitter = exp.LHS_bothLessBase,
                            ylab = "dependency coefficient",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothLessBase-depend-plot-print, dependson='5_scenarios-bothLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-depend-bothLessBase-ggplot.png")
```

**_Timings_**

```{r 5_scenarios-bothLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/parameter.x.scenario.ggplot.R")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png("plots/5_multiplePar-timing-bothLessBase-ggplot.png",
    width = 200 * plotScale,
    height = 100 * plotScale
)
parameter.x.scenario.ggplot(exp.LHS, 
                            LHS.parameter.names,
                            'timing.H', 'timing.P',
                            scenarioSplitter = exp.LHS_bothLessBase,
                            ylab = "Timing",
                            plotScale = plotScale,
                            y.log = TRUE)
dev.off()
```

```{r 5_scenarios-bothLessBase-timing-plot-print, dependson='5_scenarios-bothLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics("plots/5_multiplePar-timing-bothLessBase-ggplot.png")
```


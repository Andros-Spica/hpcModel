---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Multiple parameter exploration

```{r 5_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(ggpubr)
require(kableExtra)
```

```{r 5_table-functions}
source("library/plotting/printTableRun.R")
source("library/plotting/printTableExperiment.R")
```

```{r 5_default-values}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
initial_population_humans_default = 10
initial_population_plants_default = 10
# number of discrete types
number_types_humans_default = 30
number_types_plants_default = 30    
# undirected variation 
undirected_variation_humans_default = 0.15
undirected_variation_plants_default = 0.15
# intrinsic growth rate 
intrinsic_growth_rate_humans_default = 0.04
intrinsic_growth_rate_plants_default = 0.1
# Utility per capita of individuals of type N
utility_per_capita_type_n_plants_to_humans_default = 1.5
utility_per_capita_type_n_humans_to_plants_default = 1
# Utility per capita of individuals of type 1
utility_per_capita_type_1_plants_to_humans_default = 0.15                           
utility_per_capita_type_1_humans_to_plants_default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
utility_other_to_type_n_humans_default = 10                               
utility_other_to_type_n_plants_default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
utility_other_to_type_1_humans_default = 80                               
utility_other_to_type_1_plants_default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
max_area_default = 200
# settings 
# simulation flow & data
max_iterations_default = 5000
reltol_exponential_default = 6
coevolution_threshold_default = 0.5
save_trajectories_default = FALSE
messages_default = TRUE
```

```{r 5_setup_plus, include=FALSE}
# this chunk is specific for this exploration
require(DoE.wrapper)    # LHS
require(randomForest)   # RF
require(party)          # classification / regression tree
require(parallel)       # use parallelization, it takes 8 min aprox

run.LHS.experiment <- function(experimentSettings, cluster)
{
  parallel::parLapply(cluster, 1:nrow(experimentSettings),
                      function(experimentIndex) {
                        RESULTS <- hpcModel.run(
                          initial_population_humans = initial_population_humans_default,
                          initial_population_plants = initial_population_plants_default,
                          number_types_humans = experimentSettings[experimentIndex,                         1],         
                          number_types_plants = experimentSettings[experimentIndex,                         2],        
                          undirected_variation_humans = experimentSettings[experimentIndex,                 3],
                          undirected_variation_plants = experimentSettings[experimentIndex,                 4],
                          intrinsic_growth_rate_humans = experimentSettings[experimentIndex,                5], 
                          intrinsic_growth_rate_plants = experimentSettings[experimentIndex,                 6], 
                          utility_per_capita_type_n_plants_to_humans = experimentSettings[experimentIndex,  7],
                          utility_per_capita_type_n_humans_to_plants = experimentSettings[experimentIndex,  8],
                          utility_per_capita_type_1_plants_to_humans = experimentSettings[experimentIndex,  9],
                          utility_per_capita_type_1_humans_to_plants = experimentSettings[experimentIndex, 10],
                          utility_other_to_type_n_humans = experimentSettings[experimentIndex,             11],
                          utility_other_to_type_n_plants = experimentSettings[experimentIndex,             12], 
                          utility_other_to_type_1_humans = experimentSettings[experimentIndex,             13],
                          utility_other_to_type_1_plants = experimentSettings[experimentIndex,             14],
                          max_area = experimentSettings[experimentIndex,                                   15],
                          max_iterations = max_iterations_default,
                          reltol_exponential = reltol_exponential_default,
                          save_trajectories = save_trajectories_default,
                          messages = messages_default
                        )
                        return(as.data.frame(RESULTS$END))
                      })
}

# same, but saving trajectories
run.LHS.experiment2 <- function(experimentSettings, cluster)
{
  parallel::parLapply(cluster, 1:nrow(experimentSettings),
                      function(experimentIndex) {
                        RESULTS <- hpcModel.run(
                          initial_population_humans = initial_population_humans_default,
                          initial_population_plants = initial_population_plants_default,
                          number_types_humans = experimentSettings[experimentIndex,                         1],         
                          number_types_plants = experimentSettings[experimentIndex,                         2],        
                          undirected_variation_humans = experimentSettings[experimentIndex,                 3],
                          undirected_variation_plants = experimentSettings[experimentIndex,                 4],
                          intrinsic_growth_rate_humans = experimentSettings[experimentIndex,                5], 
                          intrinsic_growth_rate_plants = experimentSettings[experimentIndex,                 6], 
                          utility_per_capita_type_n_plants_to_humans = experimentSettings[experimentIndex,  7],
                          utility_per_capita_type_n_humans_to_plants = experimentSettings[experimentIndex,  8],
                          utility_per_capita_type_1_plants_to_humans = experimentSettings[experimentIndex,  9],
                          utility_per_capita_type_1_humans_to_plants = experimentSettings[experimentIndex, 10],
                          utility_other_to_type_n_humans = experimentSettings[experimentIndex,             11],
                          utility_other_to_type_n_plants = experimentSettings[experimentIndex,             12], 
                          utility_other_to_type_1_humans = experimentSettings[experimentIndex,             13],
                          utility_other_to_type_1_plants = experimentSettings[experimentIndex,             14],
                          max_area = experimentSettings[experimentIndex,                                   15],
                          max_iterations = max_iterations_default,
                          reltol_exponential = reltol_exponential_default,
                          save_trajectories = TRUE,
                          messages = messages_default
                        )
                        return(RESULTS$TRAJECTORIES)
                      })
}

plotDirectory <- "plots/5_"
dataDirectory <- "data/5_"

# set up color mapping for variable importance plots (variableImportancePlot())
# assuming order to be: n, v, r, mU, U.b and MaxArea
parameterColorMap <- c("black", rep("blue", 4), rep("green", 4), rep("red", 6))
```

```{r 5_plot-functions, include=FALSE}
# this chunk is specific for this exploration
source("library/plotting/bifurcationPlot_twoVariables.R")
source("library/plotting/bifurcationPlot_twoVariables_per_parameter.R")
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

source("library/plotting/plotTrajectoriesPerVariableGroup.R")
source("library/plotting/variableImportancePlot.R")
```

\newpage

## Sampling parameter values with Latin Hypercube Sampling (LHS)

```{r 5_LHS-values}
exp_LHS_parameter_sample_dataFileName <- paste0(dataDirectory, "LHS_parameter_values.RData")

LHS_parameter_names <- c(
  'number_types_humans', 'number_types_plants',        
  'undirected_variation_humans', 'undirected_variation_plants',
  'intrinsic_growth_rate_humans', 'intrinsic_growth_rate_plants',
  'utility_per_capita_type_n_plants_to_humans', 'utility_per_capita_type_n_humans_to_plants', 
  'utility_per_capita_type_1_plants_to_humans', 'utility_per_capita_type_1_humans_to_plants',                                   
  'utility_other_to_type_n_humans', 'utility_other_to_type_n_plants', 
  'utility_other_to_type_1_humans', 'utility_other_to_type_1_plants',
  'max_area'
)
LHS_parameter_ranges <- list(
  number_types_humans = c(3, 50),         
  number_types_plants = c(3, 50),        
  undirected_variation_humans = c(0.1, 0.3),
  undirected_variation_plants = c(0.1, 0.3),
  intrinsic_growth_rate_humans = c(0.01, 0.3),
  intrinsic_growth_rate_plants = c(0.01, 0.3),
  utility_per_capita_type_n_plants_to_humans = c(0, 3),
  utility_per_capita_type_n_humans_to_plants = c(0, 3),
  utility_per_capita_type_1_plants_to_humans = c(0, 3),                                  
  utility_per_capita_type_1_humans_to_plants = c(0, 3),                                   
  utility_other_to_type_n_humans = c(1, 300),                                
  utility_other_to_type_n_plants = c(1, 300), 
  utility_other_to_type_1_humans = c(1, 300),                               
  utility_other_to_type_1_plants = c(1, 300),
  max_area = c(1, 300)
)
```

**parameter**       | **value**
 ------------------ | ----------------------------------
 `number_types_humans`, `number_types_plants`       | [`r LHS_parameter_ranges$number_types_humans[1]`, `r LHS_parameter_ranges$number_types_humans[2]`], [`r LHS_parameter_ranges$number_types_plants[1]`, `r LHS_parameter_ranges$number_types_plants[2]`]
 `undirected_variation_humans`, `undirected_variation_plants`       | [`r LHS_parameter_ranges$undirected_variation_humans[1]`, `r LHS_parameter_ranges$undirected_variation_humans[2]`], [`r LHS_parameter_ranges$undirected_variation_plants[1]`, `r LHS_parameter_ranges$undirected_variation_plants[2]`]
 `intrinsic_growth_rate_humans`, `intrinsic_growth_rate_plants`       | [`r LHS_parameter_ranges$intrinsic_growth_rate_humans[1]`, `r LHS_parameter_ranges$intrinsic_growth_rate_humans[2]`], [`r LHS_parameter_ranges$intrinsic_growth_rate_plants[1]`, `r LHS_parameter_ranges$intrinsic_growth_rate_plants[2]`]
 `utility_per_capita_type_n_plants_to_humans`, `utility_per_capita_type_n_humans_to_plants` | [`r LHS_parameter_ranges$utility_per_capita_type_n_plants_to_humans[1]`, `r LHS_parameter_ranges$utility_per_capita_type_n_plants_to_humans[2]`], [`r LHS_parameter_ranges$utility_per_capita_type_n_humans_to_plants[1]`, `r LHS_parameter_ranges$utility_per_capita_type_n_humans_to_plants[2]`]
 `utility_per_capita_type_1_plants_to_humans`, `utility_per_capita_type_1_humans_to_plants` | [`r LHS_parameter_ranges$utility_per_capita_type_1_plants_to_humans[1]`, `r LHS_parameter_ranges$utility_per_capita_type_1_plants_to_humans[2]`], [`r LHS_parameter_ranges$utility_per_capita_type_1_humans_to_plants[1]`, `r LHS_parameter_ranges$utility_per_capita_type_1_humans_to_plants[2]`]
 `utility_other_to_type_n_humans`, `utility_other_to_type_n_plants`   | [`r LHS_parameter_ranges$utility_other_to_type_n_humans[1]`, `r LHS_parameter_ranges$utility_other_to_type_n_humans[2]`], [`r LHS_parameter_ranges$utility_other_to_type_n_plants[1]`, `r LHS_parameter_ranges$utility_other_to_type_n_plants[2]`]
 `max_area`   | [`r LHS_parameter_ranges$MaxArea[1]`, `r LHS_parameter_ranges$MaxArea[2]`]
 `utility_other_to_type_1_humans`, `utility_other_to_type_1_plants`   | [`r LHS_parameter_ranges$utility_other_to_type_1_humans[1]`, `r LHS_parameter_ranges$utility_other_to_type_1_humans[2]`], [`r LHS_parameter_ranges$utility_other_to_type_1_plants[1]`, `r LHS_parameter_ranges$utility_other_to_type_1_plants[2]`]

Table: Ranges of parameter exploration

```{r 5_LHS, include=FALSE, dependson='5_LHS-values'}
### generate LHS design (strauss method, with 0.2 radious interaction)
if (!file.exists(exp_LHS_parameter_sample_dataFileName)) # you must delete it to create a new file
{
  LHS_parameter_values <- DoE.wrapper::lhs.design(
    nruns = 10000, # probably should be greater
    nfactors = 15,
    type = 'strauss',
    seed = 777,
    factor.names = LHS_parameter_ranges,
    digits = c(0, 0, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4),
    RND = 0.2
  )

  # save
  save(LHS_parameter_values, file = exp_LHS_parameter_sample_dataFileName)
}
```

```{r 5_LHS-load, include=FALSE}
# load
load(exp_LHS_parameter_sample_dataFileName)

# format LHS_parameter_values as a data frame
LHS_parameter_values <- as.data.frame(LHS_parameter_values)
```

```{r 5LHStablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_LHS-load'}
source("library/plotting/printTableExperiment.R") # sometimes bookdown rendering will act up and ignore the chunks loading functions
printTableExperiment(LHS_parameter_values, caption = 'ACTUAL parameter values')
```
```{r 5LHStablepdf, eval=params$ispdf, cache=TRUE, dependson='5_LHS-load'}
printTableExperiment(LHS_parameter_values, caption = 'ACTUAL parameter values', output = "latex")
```

\newpage

```{r 5_LHS-pairs-plot, cache=TRUE, dependson='5_LHS-load'}
exp_LHS_pairsPlotName = paste0(plotDirectory, "LHS_parameter_values_pairsPlot.png")

plotScale = 10

png(exp_LHS_pairsPlotName,
    width = 100 * plotScale, height = 100 * plotScale)
pairs(LHS_parameter_values, pch='Â·')
invisible(dev.off())
```

```{r 5_LHS-pairs-plot-print, dependson='5_LHS-pairs-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_pairsPlotName)
```

\newpage

## Experiment overview

```{r 5_run-experiments, include=FALSE}
exp_LHS_runs_dataFileName <- paste0(dataDirectory, "LHS_runs.RData")

### run the model for every setting according to the LHS design
if(!file.exists(exp_LHS_runs_dataFileName)) # you must delete it to create a new file
{
  
  # build cluster
  theCluster <- makeCluster(6)
  clusterExport(theCluster, 
                list('hpcModel.run', 'getFitness', 'getCoevolutionCoefficient', 
                     'LHS_parameter_values', 
                     'initial_population_humans_default', 'initial_population_plants_default', 
                     'max_iterations_default', 'reltol_exponential_default', 
                     'save_trajectories_default', 'messages_default'), 
                envir = environment())
  
  # loop
  exp_LHS <- run.LHS.experiment(LHS_parameter_values, theCluster)
  
  # stop cluster and clean
  stopCluster(theCluster)
  rm(theCluster)
  gc()
  
  # bind result
  exp_LHS <- do.call('rbind', exp_LHS)
  
  # build object
  exp_LHS <- cbind(LHS_parameter_values, exp_LHS)
  
  # save
  save(exp_LHS, file = exp_LHS_runs_dataFileName)
}
```

```{r 5_run-experiments-load, include=FALSE, dependson='5_run-experiments'}
# load
load(exp_LHS_runs_dataFileName)

humans_exists <- !is.na(exp_LHS$humans) & exp_LHS$humans > 0
plants_exists <- !is.na(exp_LHS$plants) & exp_LHS$plants > 0
humans_fullEvolved <- exp_LHS$coevolution_coefficient_humans > 0.5 & humans_exists
plants_fullEvolved <- exp_LHS$coevolution_coefficient_plants > 0.5 & plants_exists
humans_mildEvolved <- exp_LHS$coevolution_coefficient_humans > 0 & exp_LHS$coevolution_coefficient_humans <= 0.5 & humans_exists
plants_mildEvolved <-  exp_LHS$coevolution_coefficient_plants > 0 & exp_LHS$coevolution_coefficient_plants <= 0.5 & plants_exists
humans_notByFarEvolved <- exp_LHS$coevolution_coefficient_humans < -0.5 & humans_exists
plants_notByFarEvolved <- exp_LHS$coevolution_coefficient_plants < -0.5 & plants_exists

```

### End-states

**_Are there any humans?_**
```{r 5existHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_exists), "html")
```
```{r 5existHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_exists), "latex")
```

**_Are there any plants?_**
```{r 5existPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_exists), "html")
```
```{r 5existPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_exists), "latex")
```

**_Did humans not evolved by far? (coevolution coefficient is less than -0.5)_**
```{r 5notEvolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_notByFarEvolved), "html")
```
```{r 5notEvolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_notByFarEvolved), "latex")
```

**_Did plants not evolved by far? (coevolution coefficient is less than -0.5)_**
```{r 5notEvolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_notByFarEvolved), "html")
```
```{r 5notEvolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_notByFarEvolved), "latex")
```

**_Did humans evolved mildly? (coevolution coefficient is positive, but less than 0.5)_**
```{r 5mildEvolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_mildEvolved), "html")
```
```{r 5mildEvolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_mildEvolved), "latex")
```

**_Did plants evolved mildly? (coevolution coefficient is positive, but less than 0.5)_**
```{r 5mildEvolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_mildEvolved), "html")
```
```{r 5mildEvolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_mildEvolved), "latex")
```

**_Did humans evolved fully? (coevolution coefficient is greater than 0.5)_**
```{r 5evolvedHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_fullEvolved), "html")
```
```{r 5evolvedHtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(humans_fullEvolved), "latex")
```

**_Did plants evolved fully? (coevolution coefficient is greater than 0.5)_**
```{r 5evolvedPtablehtml, eval=!params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_fullEvolved), "html")
```
```{r 5evolvedPtablepdf, eval=params$ispdf, cache=TRUE, dependson='5_run-experiments-load'}
knitr::kable(table(plants_fullEvolved), "latex")
```

**_Population and output variables_**

```{r 5_variables-plots, include=FALSE, cache=TRUE, dependson=c('5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
exp_LHS_summaryPlotName = paste0(plotDirectory, "LHS_summary_plot.png")

plotScale = 10

png(exp_LHS_summaryPlotName,
    width = 100 * plotScale,
    height = 100 * plotScale
)

summaryData1 <- melt(exp_LHS[, c('humans', 'plants', 
                                 'coevolution_coefficient_humans', 'coevolution_coefficient_humans', 
                                 'dependency_coefficient_humans', 'dependency_coefficient_plants')])

summaryPlot1 <- ggplot(data = summaryData1, aes(value)) +
  geom_histogram() +
  facet_wrap(.~variable, ncol = 2, scales = "free")

summaryData2 <- melt(exp_LHS[, c('time_end', 'timing_humans', 'timing_plants')])

summaryPlot2 <- ggplot(data = summaryData2, aes(value)) +
  geom_histogram() +
  facet_wrap(.~variable, scales = "free")

ggpubr::ggarrange(summaryPlot1, summaryPlot2, nrow = 2, heights = c(3, 1))

dev.off()
```

```{r 5_variables-plot-print, dependson='5_variables-plots', out.width = '100%'}
knitr::include_graphics(exp_LHS_summaryPlotName)
```

### Trajectories

```{r 5_exp_LHS_trajectories, include=FALSE}
exp_LHS_trajectories_dataFileName <- paste0(dataDirectory, "LHS_trajectories.RData")

if(!file.exists(exp_LHS_trajectories_dataFileName))
{
  set.seed(0)
  
  numberOfTrajectories = 5
  
  LHS_parameter_values_sample <- LHS_parameter_values[
    ## for sampling random trajectories
    #sample(1:nrow(LHS_parameter_values), numberOfTrajectories)
    ### for selecting one random run of each of the following types:
    c(
      # No coevolution (not evolved, not mild evolved, but exists)
      sample((1:nrow(LHS_parameter_values))[humans_notByFarEvolved & plants_notByFarEvolved], 1),
      # Domestication without cultivation
      sample((1:nrow(LHS_parameter_values))[humans_notByFarEvolved & plants_fullEvolved], 1),
      # Cultivation without domestication
      sample((1:nrow(LHS_parameter_values))[humans_fullEvolved & plants_notByFarEvolved], 1),
      # Mild coevolution
      sample((1:nrow(LHS_parameter_values))[humans_mildEvolved & plants_mildEvolved], 1),
      # Coevolution
      sample((1:nrow(LHS_parameter_values))[humans_fullEvolved & plants_fullEvolved], 1)
    )
    ,]
  
  # build cluster
  theCluster <- makeCluster(6)
  clusterExport(theCluster, 
                list('hpcModel.run', 'getFitness', 'getCoevolutionCoefficient', 
                     'LHS_parameter_values_sample', 
                     'initial_population_humans_default', 'initial_population_plants_default', 
                     'max_iterations_default', 'reltol_exponential_default', 
                     'save_trajectories_default', 'messages_default'), 
                envir = environment())
  
  # loop
  exp_LHS_trajectories_list <- run.LHS.experiment2(LHS_parameter_values_sample, theCluster)
  
  # stop cluster and clean
  stopCluster(theCluster)
  rm(theCluster)
  gc()
  
  # build object
  exp_LHS_trajectories <- c()
  
  for (runIndex in 1:numberOfTrajectories)
  {
    exp_LHS_trajectories <- rbind(
      exp_LHS_trajectories,
      cbind(
        run = rep(runIndex, nrow(exp_LHS_trajectories_list[[runIndex]])),
        time = 1:(nrow(exp_LHS_trajectories_list[[runIndex]])),
        exp_LHS_trajectories_list[[runIndex]][,c('humans', 'plants', 'coevolution_coefficient_humans', 'coevolution_coefficient_plants')]
      )
    )
  }
  
  exp_LHS_trajectories <- exp_LHS_trajectories[!is.na(exp_LHS_trajectories$humans) & exp_LHS_trajectories$humans > 0,]
  
  rm(exp_LHS_trajectories_list)
  
  # save
  save(exp_LHS_trajectories, file = exp_LHS_trajectories_dataFileName)
}
```

```{r 5_overview-trajectories-plot, dependson=c('5_plot-functions', '5_exp_LHS_trajectories'), include=FALSE, cache=TRUE}
load(exp_LHS_trajectories_dataFileName)

source("library/plotting/plotTrajectoriesPerVariableGroup.R")

exp_LHS_trajectoriesOverviewPlotName = paste0(plotDirectory, "LHS_trajectoriesOverview.png")

plotScale = 10

png(exp_LHS_trajectoriesOverviewPlotName,
    width = 100 * plotScale, height = 50 * plotScale)

plotTrajectoriesPerVariableGroup(exp_LHS_trajectories, 
                                 plot1_variables = c('humans', 'plants'),
                                 plot2_variables = c('coevolution_coefficient_humans', 'coevolution_coefficient_plants'),
                                 plot1_title = 'Populations', 
                                 plot2_title = 'Coevolution coefficients',
                                 plot1_colors = c('blue', 'red'),
                                 plot2_colors = c('blue', 'red'),
                                 plot_legend_labels = c('Humans', 'Humans', 'Plants', 'Plants'),
                                 plot_legend_line_x_positions = c(35, 39, 57, 61),
                                 plot_legend_label_x_positions = c(40, 40, 62, 62),
                                 plot1_mark_y_zero = FALSE,
                                 plot2_mark_y_zero = TRUE,
                                 plot_scale = plotScale)

dev.off()
```

```{r 5_overview-trajectories-plot-print, dependson='5_overview-trajectories-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_trajectoriesOverviewPlotName)
```

\newpage

```{r 5_overview-endstates-plot, include=FALSE, cache=TRUE}
exp_LHS_coevoEndStatePlotName = paste0(plotDirectory, "LHS_coevo_end_state.png")

plotScale = 10

png(exp_LHS_coevoEndStatePlotName,
    width = 50 * plotScale, height = 50 * plotScale)

ggplot(data = exp_LHS, aes(x = coevolution_coefficient_humans, y = coevolution_coefficient_plants)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0) + geom_vline(xintercept = 0) +
  geom_hline(yintercept = -1) + geom_vline(xintercept = -1) +
  geom_hline(yintercept = 1) + geom_vline(xintercept = 1)

dev.off()
```

```{r 5_overview-endstates-plot-print, dependson='5_overview-endstates-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_coevoEndStatePlotName)
```

\newpage

## Random forest

### Optimisation 

```{r 5_RF_tunning.preparation, include=FALSE}
set.seed(777)

exp_LHS_r <- exp_LHS[plants_exists,]

exp_LHS_r <- exp_LHS_r[sample(1:nrow(exp_LHS_r), nrow(exp_LHS_r)),]

exp_LHS_spl <- split(as.data.frame(exp_LHS_r), 
                     f = factor(ceiling(seq_along(1:nrow(exp_LHS_r)) / 1000)))

Grid <- expand.grid(mtry = c(2:10), ntree = seq(500, 2000, 500))
```

```{r 5_RF_tunning_humans, include=FALSE}
exp_RF_coevolution_coefficient_humans_tunning_dataFileName <- paste0(dataDirectory, "RF_coevolution_coefficient_humans_tunning.RData")

if (!file.exists(exp_RF_coevolution_coefficient_humans_tunning_dataFileName)) # you must delete it to create a new file
{
  # cluster and loop
  theCluster <- makeCluster(6)
  clusterExport(theCluster, 
                list('randomForest', 'Grid', 'LHS_parameter_names', 'exp_LHS_spl'), 
                envir = environment())
  
  RF_coevolution_coefficient_humans_tunning <- parSapply(theCluster, 1:nrow(Grid), function(rowInGrid) {
    aggregateStatisticPerGridRow <- c()
    for (i in 1:10) {
      exp_LHS_leftOneOut <- do.call(rbind, exp_LHS_spl[-i])
      RF_coevolution_coefficient_humans <- randomForest(
        as.formula(paste0("coevolution_coefficient_humans ~ ", paste(LHS_parameter_names, collapse = '+'))),
        data = exp_LHS_leftOneOut,
        mtry = Grid[rowInGrid, 1],
        ntree = Grid[rowInGrid, 2]
      )
      aggregateStatistic_coevolution_coefficient_humans <- 
        mean((predict(RF_coevolution_coefficient_humans, exp_LHS_spl[[i]][, 1:15]) - exp_LHS_spl[[i]]$coevolution_coefficient_humans) ^ 2)
      
      rm(RF_coevolution_coefficient_humans)
      
      gc()
      
      aggregateStatisticPerGridRow[i] <- aggregateStatistic_coevolution_coefficient_humans
    }
    
    return(mean(aggregateStatisticPerGridRow))
  })

  RF_coevolution_coefficient_humans_tunning <- cbind(Grid, meanPredict = RF_coevolution_coefficient_humans_tunning)
  # save
  save(RF_coevolution_coefficient_humans_tunning, file = exp_RF_coevolution_coefficient_humans_tunning_dataFileName)
  
  # stop cluster and clean
  stopCluster(theCluster)
  rm(theCluster)
}
```

```{r 5_RF_coevolution_coefficient_humans_tunning-load, include=FALSE}
# load
load(exp_RF_coevolution_coefficient_humans_tunning_dataFileName)
```

```{r 5_RF_tunning_plants, include=FALSE, eval=FALSE}
exp_RF_coevolution_coefficient_plants_tunning_dataFileName <- paste0(dataDirectory, "RF_coevolution_coefficient_plants_tunning.RData")

if (!file.exists(exp_RF_coevolution_coefficient_plants_tunning_dataFileName)) # you must delete to create a new file
{
  # cluster and loop
  theCluster <- makeCluster(6)
  clusterExport(theCluster, 
                list('randomForest', 'Grid', 'LHS_parameter_names', 'exp_LHS_spl'), 
                envir = environment())
  
  RF_coevolution_coefficient_plants_tunning <- parSapply(theCluster, 1:nrow(Grid), function(rowInGrid) {
    aggregateStatisticPerGridRow <- c()
    for (i in 1:10) {
      exp_LHS_leftOneOut <- do.call(rbind, exp_LHS_spl[-i])
      RF_coevolution_coefficient_plants <- randomForest(
        as.formula(paste0("coevolution_coefficient_plants ~ ", paste(LHS_parameter_names, collapse = '+'))),
        data = exp_LHS_leftOneOut,
        mtry = Grid[rowInGrid, 1],
        ntree = Grid[rowInGrid, 2]
      )
      aggregateStatistic_coevolution_coefficient_plants <- 
        mean((predict(RF_coevolution_coefficient_plants, exp_LHS_spl[[i]][, 1:15]) - exp_LHS_spl[[i]]$coevolution_coefficient_plants) ^ 2)
      
      rm(RF_coevolution_coefficient_plants)
      gc()
      
      aggregateStatisticPerGridRow[i] <- aggregateStatistic_coevolution_coefficient_plants
    }
    
    return(mean(aggregateStatisticPerGridRow))
  })

  RF_coevolution_coefficient_plants_tunning <- cbind(Grid, meanPredict = RF_coevolution_coefficient_plants_tunning)
  # save
  save(RF_coevolution_coefficient_plants_tunning, file = exp_RF_coevolution_coefficient_plants_tunning_dataFileName)
}
```

```{r 5_RF_coevolution_coefficient_plants_tunning-load, include=FALSE}
# load
load(exp_RF_coevolution_coefficient_plants_tunning_dataFileName)
```

```{r 5_RF_coevo_tunning-plot, dependson=c('5_RF_coevolution_coefficient_humans_tunning-load', '5_RF_coevolution_coefficient_humans_tunning-load'), out.width = '100%'}

temporaryData <- cbind(
  output.var = c(
    rep('coevolution_coefficient_humans', nrow(RF_coevolution_coefficient_humans_tunning)), 
    rep('coevolution_coefficient_plants', nrow(RF_coevolution_coefficient_plants_tunning))
    ),
  rbind(RF_coevolution_coefficient_humans_tunning, RF_coevolution_coefficient_plants_tunning)
  )

exp_LHS_coevo_optimisationPlotName = paste0(plotDirectory, "LHS_coevo_optimisationPlot.png")

plotScale = 2

png(exp_LHS_coevo_optimisationPlotName, 
    width = 320 * plotScale, height = 180 * plotScale)

ggplot(temporaryData, aes(x = ntree, y = mtry)) + 
  geom_tile(aes(fill = meanPredict), colour = "white") + 
  scale_fill_gradient(low = "white", high = "black") +
  geom_text(aes(label = round(meanPredict, 5)), color = "steelblue", size = plotScale * 2.5) +
  facet_wrap(.~output.var) + theme_bw()

dev.off()
```

```{r 5_RF_coevo_tunning-plot-print, dependson='5_RF-coevo-plots', out.width = '100%'}
knitr::include_graphics(paste0(exp_LHS_coevo_optimisationPlotName))
```

\newpage

### Coevolution coefficients

Only using those runs with any humans (coevolution_coefficient_humans) and plants (coevolution_coefficient_humans) at the end-state.

```{r 5_RF-coevolution_coefficient_humans, include=FALSE, cache=TRUE}
exp_RF_coevolution_coefficient_humans_dataFileName <- paste0(dataDirectory, "RF_coevolution_coefficient_humans.RData")

if(!file.exists(exp_RF_coevolution_coefficient_humans_dataFileName))
{
  RF_coevolution_coefficient_humans <-
  randomForest::randomForest(
    as.formula(paste0("coevolution_coefficient_humans ~ ", paste(LHS_parameter_names, collapse = '+'))),
    data = exp_LHS[humans_exists,],
    mtry = 5,
    ntree = 1000,
    importance = T
  )
  
  # save
  save(RF_coevolution_coefficient_humans, file = exp_RF_coevolution_coefficient_humans_dataFileName)
}
```

```{r 5_RF_coevolution_coefficient_plants, include=FALSE, cache=TRUE}
exp_RF_coevolution_coefficient_plants_dataFileName <- paste0(dataDirectory, "RF_coevolution_coefficient_plants.RData")

if(!file.exists(exp_RF_coevolution_coefficient_plants_dataFileName))
{
  RF_coevolution_coefficient_plants <-
    randomForest::randomForest(
      as.formula(paste0("coevolution_coefficient_plants ~ ", paste(LHS_parameter_names, collapse = '+'))),
      data = exp_LHS[plants_exists,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  
  # save
  save(RF_coevolution_coefficient_plants, file = exp_RF_coevolution_coefficient_plants_dataFileName)
}
```

```{r 5_RF_coevo-load, include=FALSE}
# load
load(exp_RF_coevolution_coefficient_humans_dataFileName)
load(exp_RF_coevolution_coefficient_plants_dataFileName)
```

```{r 5_RF-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_RF_coevo-load')}
source("library/plotting/variableImportancePlot.R") # sometimes bookdown rendering will act up and ignore the chunks loading functions

exp_LHS_coevo_variableImportancePlotName = paste0(plotDirectory, "LHS_coevo_variableImportancePlot.png")

plotScale = 2

png(exp_LHS_coevo_variableImportancePlotName, 
    width = 960 * plotScale, height = 380 * plotScale)
variableImportancePlotPair(RF_coevolution_coefficient_humans, 
                           RF_coevolution_coefficient_plants, 
                           plot_scale = plotScale,
                           color_variable_map = parameterColorMap)
dev.off()
```

```{r 5_RF-coevo-plot-print, dependson='5_RF-coevo-plots', out.width = '100%'}
knitr::include_graphics(paste0(exp_LHS_coevo_variableImportancePlotName))
```

\newpage

### Dependency coefficients

Only using those runs with any humans (dependency_coefficient_humans) and plants (dependency_coefficient_plants) at the end-state.

```{r 5_RF-dependency_coefficient_humans, include=FALSE, cache=TRUE}
exp_RF_dependency_coefficient_humans_dataFileName <- paste0(dataDirectory, "RF_dependency_coefficient_humans.RData")

if(!file.exists(exp_RF_dependency_coefficient_humans_dataFileName))
{
  RF_dependency_coefficient_humans <-
    randomForest::randomForest(
      as.formula(paste0("dependency_coefficient_humans ~ ", paste(LHS_parameter_names, collapse = '+'))),
      data = exp_LHS[humans_exists,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  
  # save
  save(RF_dependency_coefficient_humans, file = exp_RF_dependency_coefficient_humans_dataFileName)
}
```

```{r 5_RF-dependency_coefficient_plants, include=FALSE, cache=TRUE}
exp_RF_dependency_coefficient_plants_dataFileName <- paste0(dataDirectory, "RF_dependency_coefficient_plants.RData")

if(!file.exists(exp_RF_dependency_coefficient_plants_dataFileName))
{
  RF_dependency_coefficient_plants <-
    randomForest::randomForest(
      as.formula(paste0("dependency_coefficient_plants ~ ", paste(LHS_parameter_names, collapse = '+'))),
      data = exp_LHS[plants_exists,],
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  
  # save
  save(RF_dependency_coefficient_plants, file = exp_RF_dependency_coefficient_plants_dataFileName)
}
```

```{r 5_RF_depend-load, include=FALSE}
# load
load(exp_RF_dependency_coefficient_humans_dataFileName)
load(exp_RF_dependency_coefficient_plants_dataFileName)
```

```{r 5_RF-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_RF_depend-load')}
exp_LHS_dependency_coefficient_variableImportancePlotName = paste0(plotDirectory, "LHS_dependency_coefficient_variableImportancePlot.png")

plotScale = 2

png(exp_LHS_dependency_coefficient_variableImportancePlotName, width = 960 * plotScale, height = 360 * plotScale)
variableImportancePlotPair(RF_dependency_coefficient_humans, 
                           RF_dependency_coefficient_plants, 
                           plot_scale = plotScale,
                           color_variable_map = parameterColorMap)
dev.off()
```

```{r 5_RF-dependency_coefficient_humans-plot-print, dependson='5_RF-depend-plots', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficient_variableImportancePlotName)
```

### Timings

Only using those runs with successful human (`timing_humans`) and plant (`timing_.P_plants`) evolution.

```{r 5_RF-timing.H, include=FALSE, cache=TRUE}
exp_RF_timing_humans_dataFileName <- paste0(dataDirectory, "RF_timing_humans.RData")

if(!file.exists(exp_RF_timing_humans_dataFileName))
{
  RF_timing_humans <-
    randomForest::randomForest(
      as.formula(paste0("timing_humans ~ ", paste(LHS_parameter_names, collapse = '+'))),
      data = exp_LHS[humans_fullEvolved,], # filter out cases where humans did not evolved towards n
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  
  # save
  save(RF_timing_humans, file = exp_RF_timing_humans_dataFileName)
}
```

```{r 5_RF-timing.P, include=FALSE, cache=TRUE}
exp_RF_timing_plants_dataFileName <- paste0(dataDirectory, "RF_timing_plants.RData")

if(!file.exists(exp_RF_timing_plants_dataFileName))
{
  RF_timing_plants <-
    randomForest::randomForest(
      as.formula(paste0("timing_plants ~ ", paste(LHS_parameter_names, collapse = '+'))),
      data = exp_LHS[plants_fullEvolved,], # filter out cases where plants did not evolved towards n
      mtry = 5,
      ntree = 1000,
      importance = T
    )
  
  # save
  save(RF_timing_plants, file = exp_RF_timing_plants_dataFileName)
}
```

```{r 5_RF_timing-load, include=FALSE}
# load
load(exp_RF_timing_humans_dataFileName)
load(exp_RF_timing_plants_dataFileName)
```

```{r 5_RF-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_RF_timing-load')}
exp_LHS_timing_variableImportancePlotName = paste0(plotDirectory, "LHS_timing_variableImportancePlot.png")

plotScale = 2

png(exp_LHS_timing_variableImportancePlotName, width = 960 * plotScale, height = 360 * plotScale)
variableImportancePlotPair(RF_timing_humans, 
                           RF_timing_plants, 
                           plot_scale = plotScale,
                           color_variable_map = parameterColorMap)
dev.off()
```

```{r 5_RF-timing_humans-plot-print, dependson='5_RF-timing-plots', out.width = '100%'}
knitr::include_graphics(exp_LHS_timing_variableImportancePlotName)
```

\newpage

## Visualisation of parameter effect

### The effect on coevolution coefficients of the utility per capita of type n humans to plants ($\bar{U}_{H_{n}P}$)
\sectionmark{Visualising effect of $\bar{U}_{H_{n}P}$}

```{r 5_overview-collapsed-plot, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments-load') }
source("library/plotting/bifurcationPlot_twoVariables.R")

exp_LHS_coevolution_coefficients_bifurcationPlot_twoVariables_plotName = paste0(plotDirectory, "LHS_coevolution_coefficients_bifurcationPlot_twoVariables.png")

plotScale = 10

#svg('plots/5_collapsed.svg', width=10, height=10)
png(exp_LHS_coevolution_coefficients_bifurcationPlot_twoVariables_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
bifurcationPlot_twoVariables(exp_LHS,
                             parameter_x = 'utility_per_capita_type_n_humans_to_plants', 
                             variable_1 = 'coevolution_coefficient_humans', 
                             variable_2 = 'coevolution_coefficient_plants',
                             axis_x_label = '',
                             axis_y_label = 'coevolution coefficient',
                             variable_1_label = 'Humans',
                             variable_2_label = 'Plants',
                             plot_scale = plotScale)
dev.off()
```

```{r 5_overview-collapsed-plot-print, dependson='5_overview-collapsed-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_coevolution_coefficients_bifurcationPlot_twoVariables_plotName)
```

\newpage

### All parameters

**_Coevolution coefficients_**

```{r 5_scenarios-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter.R")

exp_LHS_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_plotName = paste0(plotDirectory, "LHS_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter.png")

plotScale = 10

png(exp_LHS_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_plotName,
    width = 200 * plotScale,
    height = 200 * plotScale
)
bifurcationPlot_twoVariables_per_parameter(exp_LHS, 
                                           LHS_parameter_names,
                                           variable_1 = 'coevolution_coefficient_humans', 
                                           variable_2 = 'coevolution_coefficient_plants',
                                           axis_x_label = 'parameter values',
                                           axis_y_label = 'coevolution coefficient',
                                           variable_1_label = 'Humans',
                                           variable_2_label = 'Plants',
                                           facet_wrap_number_of_rows = 4,
                                           plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-coevo-plot-print, dependson='5_scenarios-humansImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_plotName)
```

**_Dependency coefficients_**

```{r 5_scenarios-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter.R")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter.png")

plotScale = 10

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_plotName,
    width = 200 * plotScale,
    height = 200 * plotScale
)
bifurcationPlot_twoVariables_per_parameter(exp_LHS, 
                                           LHS_parameter_names,
                                           variable_1 = 'dependency_coefficient_humans', 
                                           variable_2 = 'dependency_coefficient_plants',
                                           axis_x_label = 'parameter values',
                                           axis_y_label = 'dependency coefficient',
                                           variable_1_label = 'Humans',
                                           variable_2_label = 'Plants',
                                           plot_scale = plotScale,
                                           facet_wrap_number_of_rows = 4,
                                           axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-depend-plot-print, dependson='5_scenarios-humansImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_plotName)
```

**_Timings_**

```{r 5_scenarios-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
exp_LHS_timing_bifurcationPlot_twoVariables_per_parameter_plotName = paste0(plotDirectory, "LHS_timing_bifurcationPlot_twoVariables_per_parameter.png")

plotScale = 10

png(exp_LHS_timing_bifurcationPlot_twoVariables_per_parameter_plotName,
    width = 200 * plotScale,
    height = 200 * plotScale
)
bifurcationPlot_twoVariables_per_parameter(exp_LHS, 
                                           LHS_parameter_names,
                                           variable_1 = 'timing_humans', 
                                           variable_2 = 'timing_plants',
                                           axis_x_label = 'parameter values',
                                           axis_y_label = 'timing of change',
                                           variable_1_label = 'Humans',
                                           variable_2_label = 'Plants',
                                           plot_scale = plotScale,
                                           facet_wrap_number_of_rows = 4,
                                           axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-timing-plot-print, dependson='5_scenarios-humansImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_timing_bifurcationPlot_twoVariables_per_parameter_plotName)
```

\newpage

## Parameter effect split by scenarios

**Scenario label**       | **Scenario condition**
 ------------------ | ----------------------------------
 plantsImprove | 'utility_per_capita_type_n_plants_to_humans > utility_per_capita_type_1_plants_to_humans'
 humansImprove | 'utility_per_capita_type_n_humans_to_plants > utility_per_capita_type_1_humans_to_plants'
 bothImprove | 'utility_per_capita_type_n_plants_to_humans > utility_per_capita_type_1_plants_to_humans ~~~ AND ~~~ utility_per_capita_type_n_humans_to_plants > utility_per_capita_type_1_humans_to_plants'
 plantsLessBase | 'utility_other_to_type_1_plants > utility_other_to_type_n_plants'
 humansLessBase | 'utility_other_to_type_1_humans > utility_other_to_type_n_humans'
 bothLessBase | 'utility_per_capita_type_n_plants_to_humans > utility_per_capita_type_1_plants_to_humans ~~~ AND ~~~ utility_per_capita_type_n_humans_to_plants > utility_per_capita_type_1_humans_to_plants'
 

```{r 5_split-scenarios, include=FALSE, cache=TRUE, dependson='5_run-experiments-load'}
# 'plantsImprove', 'humansImprove', 'bothImprove',
# 'plantsLessBase', 'humansLessBase', 'bothLessBase'

# # utility_per_capita_type_n_plants_to_humans > utility_per_capita_type_1_plants_to_humans (mutualistic plant types give more utility = TRUE, else = FALSE)
exp_LHS_plantsImprove <- factor(as.character(exp_LHS$utility_per_capita_type_n_plants_to_humans > exp_LHS$utility_per_capita_type_1_plants_to_humans),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('"plantsImprove = TRUE"', 
                                          '"plantsImprove = FALSE"')
                               )

# # utility_per_capita_type_n_humans_to_plants > utility_per_capita_type_1_humans_to_plants (mutualistic human types give more utility = TRUE, else = FALSE)
exp_LHS_humansImprove <- factor(as.character(exp_LHS$utility_per_capita_type_n_humans_to_plants > exp_LHS$utility_per_capita_type_1_humans_to_plants),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('"humansImprove = TRUE"',
                                          '"humansImprove = FALSE"'))

# # utility_per_capita_type_n_plants_to_humans > utility_per_capita_type_1_plants_to_humans AND utility_per_capita_type_n_humans_to_plants > utility_per_capita_type_1_humans_to_plants (mutualistic types give more utility = TRUE, else = FALSE)
exp_LHS_bothImprove <- factor(as.character(exp_LHS$utility_per_capita_type_n_plants_to_humans > exp_LHS$utility_per_capita_type_1_plants_to_humans & exp_LHS$utility_per_capita_type_n_humans_to_plants > exp_LHS$utility_per_capita_type_1_humans_to_plants),
                              levels = c('TRUE', 'FALSE'),
                              labels = c('"bothImprove = TRUE"', 
                                         '"bothImprove = FALSE"'))

# # utility_other_to_type_1_plants > utility_other_to_type_n_plants (non-mutualistic plant types obtain more utility from other resources = TRUE, else = FALSE)
exp_LHS_plantsLessBase <- factor(as.character(exp_LHS$utility_other_to_type_1_plants > exp_LHS$utility_other_to_type_n_plants),
                                levels = c('TRUE', 'FALSE'),
                                labels = c('"plantsLessBase = TRUE"',
                                           '"plantsLessBase = FALSE"'))

# # utility_other_to_type_1_humans > utility_other_to_type_n_humans (non-mutualistic human types obtain more utility from other resources = TRUE, else = FALSE)
exp_LHS_humansLessBase <- factor(as.character(exp_LHS$utility_other_to_type_1_humans > exp_LHS$utility_other_to_type_n_humans),
                                levels = c('TRUE', 'FALSE'),
                                labels = c('"humansLessBase = TRUE"',
                                           '"humansLessBase = FALSE"'))

# # utility_per_capita_type_n_plants_to_humans > utility_per_capita_type_1_plants_to_humans AND utility_per_capita_type_n_humans_to_plants > utility_per_capita_type_1_humans_to_plants (non-mutualistic types obtain more utility from other resources = TRUE, else = FALSE)
exp_LHS_bothLessBase <- factor(as.character(exp_LHS$utility_other_to_type_1_plants > exp_LHS$utility_other_to_type_n_plants & exp_LHS$utility_other_to_type_1_humans > exp_LHS$utility_other_to_type_n_humans),
                               levels = c('TRUE', 'FALSE'),
                               labels = c('"bothLessBase = TRUE"',
                                          '"bothLessBase = FALSE"'))

parameterNamesSplit <- c(1, (length(LHS_parameter_names) / 3), (2 * length(LHS_parameter_names) / 3), length(LHS_parameter_names))
```

### Mutualistic human type gives more utility ($\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$)
\sectionmark{Scenario: $\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$}

**_Coevolution coefficients_**

```{r 5_scenarios-humansImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-humansImprove-coevo-plot1-print, dependson='5_scenarios-humansImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-humansImprove-coevo-plot2-print, dependson='5_scenarios-humansImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-humansImprove-coevo-plot3-print, dependson='5_scenarios-humansImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```
**_Dependency coefficients_**

```{r 5_scenarios-humansImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-humansImprove-depend-plot1-print, dependson='5_scenarios-humansImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-humansImprove-depend-plot2-print, dependson='5_scenarios-humansImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-humansImprove-depend-plot3-print, dependson='5_scenarios-humansImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Timings_**

```{r 5_scenarios-humansImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_humansImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-humansImprove-timing-plot1-print, dependson='5_scenarios-humansImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-humansImprove-timing-plot2-print, dependson='5_scenarios-humansImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-humansImprove-timing-plot3-print, dependson='5_scenarios-humansImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

\newpage

### Mutualistic plant type gives more utility ($\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$)
\sectionmark{Scenario: $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$}

**_Coevolution coefficients_**

```{r 5_scenarios-plantsImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-plantsImprove-coevo-plot1-print, dependson='5_scenarios-plantsImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-plantsImprove-coevo-plot2-print, dependson='5_scenarios-plantsImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-plantsImprove-coevo-plot3-print, dependson='5_scenarios-plantsImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Dependency coefficients_**

```{r 5_scenarios-plantsImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-plantsImprove-depend-plot1-print, dependson='5_scenarios-plantsImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-plantsImprove-depend-plot2-print, dependson='5_scenarios-plantsImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-plantsImprove-depend-plot3-print, dependson='5_scenarios-plantsImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Timings_**

```{r 5_scenarios-plantsImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_plantsImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-plantsImprove-timing-plot1-print, dependson='5_scenarios-plantsImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-plantsImprove-timing-plot2-print, dependson='5_scenarios-plantsImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-plantsImprove-timing-plot3-print, dependson='5_scenarios-plantsImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

\newpage

### Mutualistic types (human and plant) give more utility ($\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$ AND $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$)
\sectionmark{$\bar{U}_{H_{n}P}> \bar{U}_{H_{1}P}$ AND $\bar{U}_{P_{n}H}> \bar{U}_{P_{1}H}$}

**_Coevolution coefficients_**

```{r 5_scenarios-bothImprove-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-bothImprove-coevo-plot1-print, dependson='5_scenarios-bothImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-bothImprove-coevo-plot2-print, dependson='5_scenarios-bothImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-bothImprove-coevo-plot3-print, dependson='5_scenarios-bothImprove-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothImprove_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Dependency coefficients_**

```{r 5_scenarios-bothImprove-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-bothImprove-depend-plot1-print, dependson='5_scenarios-bothImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-bothImprove-depend-plot2-print, dependson='5_scenarios-bothImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-bothImprove-depend-plot3-print, dependson='5_scenarios-bothImprove-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Timings_**

```{r 5_scenarios-bothImprove-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_bothImprove,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-bothImprove-timing-plot1-print, dependson='5_scenarios-bothImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-bothImprove-timing-plot2-print, dependson='5_scenarios-bothImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-bothImprove-timing-plot3-print, dependson='5_scenarios-bothImprove-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothImprove_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

\newpage

### Mutualistic human type gets less utility from other resources ($U_{bH_{1}}>U_{bH_{n}}$)
\sectionmark{Scenario: $U_{bH_{1}}>U_{bH_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-humansLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-humansLessBase-coevo-plot1-print, dependson='5_scenarios-humansLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-humansLessBase-coevo-plot2-print, dependson='5_scenarios-humansLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-humansLessBase-coevo-plot3-print, dependson='5_scenarios-humansLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Dependency coefficients_**

```{r 5_scenarios-humansLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-humansLessBase-depend-plot1-print, dependson='5_scenarios-humansLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-humansLessBase-depend-plot2-print, dependson='5_scenarios-humansLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-humansLessBase-depend-plot3-print, dependson='5_scenarios-humansLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Timings_**

```{r 5_scenarios-humansLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_humansLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-humansLessBase-timing-plot1-print, dependson='5_scenarios-humansLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-humansLessBase-timing-plot2-print, dependson='5_scenarios-humansLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-humansLessBase-timing-plot3-print, dependson='5_scenarios-humansLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_humansLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

\newpage

### Mutualistic plant type gets less utility from other resources ($U_{bP_{1}}>U_{bP_{n}}$)
\sectionmark{Scenario: $U_{bP_{1}}>U_{bP_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-plantsLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-plantsLessBase-coevo-plot1-print, dependson='5_scenarios-plantsLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-plantsLessBase-coevo-plot2-print, dependson='5_scenarios-plantsLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-plantsLessBase-coevo-plot3-print, dependson='5_scenarios-plantsLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Dependency coefficients_**

```{r 5_scenarios-plantsLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-plantsLessBase-depend-plot1-print, dependson='5_scenarios-plantsLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-plantsLessBase-depend-plot2-print, dependson='5_scenarios-plantsLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-plantsLessBase-depend-plot3-print, dependson='5_scenarios-plantsLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Timings_**

```{r 5_scenarios-plantsLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_plantsLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-plantsLessBase-timing-plot1-print, dependson='5_scenarios-plantsLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-plantsLessBase-timing-plot2-print, dependson='5_scenarios-plantsLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-plantsLessBase-timing-plot3-print, dependson='5_scenarios-plantsLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_plantsLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

\newpage

### Mutualistic types (human and plant) get less utility from other resources ($U_{bH_{1}}>U_{bH_{n}}$ AND $U_{bP_{1}}>U_{bP_{n}}$)
\sectionmark{Scenario: $U_{bH_{1}}>U_{bH_{n}}$ AND $U_{bP_{1}}>U_{bP_{n}}$}

**_Coevolution coefficients_**

```{r 5_scenarios-bothLessBase-coevo-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()

png(exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'coevolution_coefficient_humans', 
                                                        variable_2 = 'coevolution_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'coevolution coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale)
dev.off()
```

```{r 5_scenarios-bothLessBase-coevo-plot1-print, dependson='5_scenarios-bothLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-bothLessBase-coevo-plot2-print, dependson='5_scenarios-bothLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-bothLessBase-coevo-plot3-print, dependson='5_scenarios-bothLessBase-coevo-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothLessBase_coevolution_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Dependency coefficients_**

```{r 5_scenarios-bothLessBase-depend-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'dependency_coefficient_humans', 
                                                        variable_2 = 'dependency_coefficient_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'dependency coefficient',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-bothLessBase-depend-plot1-print, dependson='5_scenarios-bothLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-bothLessBase-depend-plot2-print, dependson='5_scenarios-bothLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-bothLessBase-depend-plot3-print, dependson='5_scenarios-bothLessBase-depend-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_dependency_coefficients_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```

**_Timings_**

```{r 5_scenarios-bothLessBase-timing-plots, include=FALSE, cache=TRUE, dependson=c('5_plot-functions', '5_run-experiments', '5_run-experiments-load', '5_split-scenarios')}
source("library/plotting/bifurcationPlot_twoVariables_per_parameter_and_scenario.R")

exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName = paste0(plotDirectory, "LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1.png")

exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName = paste0(plotDirectory, "LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2.png")

exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName = paste0(plotDirectory, "LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3.png")

plotScale = 10

png(exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[1]):(parameterNamesSplit[2])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[2] + 1):(parameterNamesSplit[3])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()

png(exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName,
    width = 200 * plotScale,
    height = 100 * plotScale
)
bifurcationPlot_twoVariables_per_parameter_and_scenario(exp_LHS, 
                                                        LHS_parameter_names[(parameterNamesSplit[3] + 1):(parameterNamesSplit[4])],
                                                        variable_1 = 'timing_humans', 
                                                        variable_2 = 'timing_plants',
                                                        scenario_splitter = exp_LHS_bothLessBase,
                                                        axis_x_label = 'parameter values',
                                                        axis_y_label = 'timing of change',
                                                        variable_1_label = 'Humans',
                                                        variable_2_label = 'Plants',
                                                        plot_scale = plotScale,
                                                        axis_y_log = TRUE)
dev.off()
```

```{r 5_scenarios-bothLessBase-timing-plot1-print, dependson='5_scenarios-bothLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part1_plotName)
```

```{r 5_scenarios-bothLessBase-timing-plot2-print, dependson='5_scenarios-bothLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part2_plotName)
```

```{r 5_scenarios-bothLessBase-timing-plot3-print, dependson='5_scenarios-bothLessBase-timing-plot', out.width = '100%'}
knitr::include_graphics(exp_LHS_bothLessBase_timing_bifurcationPlot_twoVariables_per_parameter_and_scenario_part3_plotName)
```


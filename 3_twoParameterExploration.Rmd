---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---

# Two parameter exploration

```{r 3_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, # hide code and messages
                      cache=TRUE, autodep=TRUE) 

source("library/hpcModel.run.R")
source("library/hpcModel.exploration.R")
source("library/hpcModel.plot.R")
require(reshape2)
require(ggplot2)
require(scales)
require(kableExtra)
```

```{r 3_table-functions}
source("library/plotting/printTableRun.R")
source("library/plotting/printTableExperiment.R")
```

```{r 3_default-values, cache=TRUE}
# this is the 'default' parameter setting (end state is 'fast coevolution'):
# initial populations
initial_population_humans_default = 10
initial_population_plants_default = 10
# number of discrete types
number_types_humans_default = 30
number_types_plants_default = 30    
# undirected variation 
undirected_variation_humans_default = 0.15
undirected_variation_plants_default = 0.15
# intrinsic growth rate 
intrinsic_growth_rate_humans_default = 0.04
intrinsic_growth_rate_plants_default = 0.1
# Utility per capita of individuals of type N
utility_per_capita_type_n_plants_to_humans_default = 1.5
utility_per_capita_type_n_humans_to_plants_default = 1
# Utility per capita of individuals of type 1
utility_per_capita_type_1_plants_to_humans_default = 0.15                           
utility_per_capita_type_1_humans_to_plants_default = 0                               
# basic resources:
# population of type N that can be sustained by resources independent of HP relationship
utility_other_to_type_n_humans_default = 10                               
utility_other_to_type_n_plants_default = 20
# population of type 1 that can be sustained by resources independent of HP relationship
utility_other_to_type_1_humans_default = 80                               
utility_other_to_type_1_plants_default = 100                                 
# maximum local area to be used by populations (multiplier or scaling effect)
max_area_default = 200
# settings 
# simulation flow & data
max_iterations_default = 5000
reltol_exponential_default = 6
coevolution_threshold_default = 0.5
messages_default = FALSE
```

```{r 3_plot-functions, include=FALSE}
# this chunk is specific for this exploration 

plotDirectory <- "plots/3_exp_"
dataDirectory <- "data/3_exp_"

source("library/plotting/tripleRaster_twoParameters.R")

```

\newpage

## Full example

### Utility per capita from type n humans and plants ($\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 3_utility_per_capita_type_n-values, cache=TRUE}
exp_utility_per_capita_type_n_name <- "utility_per_capita_type_n"

exp_utility_per_capita_type_n_expDataFileName = paste0(dataDirectory, exp_utility_per_capita_type_n_name,'.RData')
exp_utility_per_capita_type_n_plotName = paste0(plotDirectory, exp_utility_per_capita_type_n_name, "-tripleRaster_twoParameters.png")

exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 15)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 15)
```

```{r 3_utility_per_capita_type_n, cache=TRUE, dependson=c('3_default-values','3_utility_per_capita_type_n-values'), include=FALSE}
if(!file.exists(exp_utility_per_capita_type_n_expDataFileName))
{
  exp_utility_per_capita_type_n <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default, 
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_per_capita_type_n, file = exp_utility_per_capita_type_n_expDataFileName)
}
```


```{r 3_exp_utility_per_capita_type_n-load, include=FALSE}
# load
load(exp_utility_per_capita_type_n_expDataFileName)
```


```{r 3mUHnPmUPnHtablehtml, eval=!params$ispdf, cache=TRUE, dependson='3_utility_per_capita_type_n'}
source("library/plotting/printTableExperiment.R") # sometimes bookdown rendering will act up and ignore the chunks loading functions
printTableExperiment(exp_utility_per_capita_type_n, caption = 'Parameter setting')
```

```{r 3mUHnPmUPnHtablepdf, eval=params$ispdf, cache=TRUE, dependson='3_utility_per_capita_type_n'}
printTableExperiment(exp_utility_per_capita_type_n, caption = 'Parameter setting', output = 'latex')
```

\newpage

```{r 3_utility_per_capita_type_n-plot, include=FALSE, cache=TRUE, dependson='3_utility_per_capita_type_n'}
plotScale = 100 / length(exp_utility_per_capita_type_n_humans_to_plants_values)

png(exp_utility_per_capita_type_n_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_per_capita_type_n, 
                           parameter_x = 'utility_per_capita_type_n_humans_to_plants', 
                           parameter_y = 'utility_per_capita_type_n_plants_to_humans', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility per capita of type n humans to plants (', bar(U)['HnP'], ')')),
                           parameter_y_label = expression(paste('utility per capita of type n plants to humans (  ', bar(U)['PnH'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_utility_per_capita_type_n-plot-print, echo=FALSE, dependson='3_utility_per_capita_type_n-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_per_capita_type_n_plotName)
```

\newpage

## Exploration on 'default' setting for parameter pairs

### Number of types of humans and plants ($n_{H}$ x $n_{P}$)
\sectionmark{$n_{H}$ x $n_{P}$}

```{r 3_number_types-values, cache=TRUE}
exp_number_types_name <- "number_types"

exp_number_types_expDataFileName = paste0(dataDirectory, exp_number_types_name,'.RData')
exp_number_types_plotName = paste0(plotDirectory, exp_number_types_name, "-tripleRaster_twoParameters.png")


exp_number_types_humans_values <- seq(3, 42, by = 3)
exp_number_types_plants_values <- seq(3, 42, by = 3)
```

```{r 3_number_types, cache=TRUE, dependson=c('3_default-values','3_number_types-values'), include=FALSE}
if(!file.exists(exp_number_types_expDataFileName))
{
  exp_number_types <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = exp_number_types_humans_values, ###
    number_types_plants = exp_number_types_plants_values, ###
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_number_types, file = exp_number_types_expDataFileName)
}
```


```{r 3_exp_number_types-load, include=FALSE}
# load
load(exp_number_types_expDataFileName)
```

```{r 3_number_types-plot, include=FALSE, cache=TRUE, dependson='3_number_types'}
plotScale = 100 / length(exp_number_types_humans_values)

png(exp_number_types_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_number_types, 
                           parameter_x = 'number_types_humans', 
                           parameter_y = 'number_types_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end', 
                           parameter_x_label = expression(paste('number of human types (', n['H'], ')')),
                           parameter_y_label = expression(paste('number of plant types (', n['P'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_number_types-plot-print, echo=FALSE, dependson='3_number_types-plot', out.width = '100%'}
knitr::include_graphics(exp_number_types_plotName)
```

\newpage

### Undirected variation in humans and plants ($v_{H}$ x $v_{P}$)
\sectionmark{$v_{H}$ x $v_{P}$}

```{r 3_undirected_variation-values, cache=TRUE}
exp_undirected_variation_name <- "undirected_variation"


exp_undirected_variation_expDataFileName = paste0(dataDirectory, exp_undirected_variation_name,'.RData')
exp_undirected_variation_plotName = paste0(plotDirectory, exp_undirected_variation_name, "-tripleRaster_twoParameters.png")


exp_undirected_variation_humans_values <- seq(0.05, 0.25, length.out = 15)
exp_undirected_variation_plants_values <- seq(0.05, 0.25, length.out = 15)
```

```{r 3_undirected_variation, cache=TRUE, dependson=c('3_default-values','3_undirected_variation-values'), include=FALSE}
if(!file.exists(exp_undirected_variation_expDataFileName))
{
  exp_undirected_variation <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = exp_undirected_variation_humans_values, ###
    undirected_variation_plants = exp_undirected_variation_plants_values, ###
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default, 
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_undirected_variation, file = exp_undirected_variation_expDataFileName)
}
```


```{r 3_exp_undirected_variation-load, include=FALSE}
# load
load(exp_undirected_variation_expDataFileName)
```

```{r 3_undirected_variation-plot, include=FALSE, cache=TRUE, dependson='3_undirected_variation'}
plotScale = 100 / length(exp_undirected_variation_humans_values)

png(exp_undirected_variation_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_undirected_variation, 
                           parameter_x = 'undirected_variation_humans', 
                           parameter_y = 'undirected_variation_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('undirected variation in humans (', v['H'], ')')),
                           parameter_y_label = expression(paste('undirected variation in plants ( ', v['P'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_undirected_variation-plot-print, echo=FALSE, dependson='3_undirected_variation-plot', out.width = '100%'}
knitr::include_graphics(exp_undirected_variation_plotName)
```

\newpage

### Utility per capita from type 1 humans and plants ($\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$)
\sectionmark{$\bar{U}_{H_{1}P}$ x $\bar{U}_{P_{1}H}$}

```{r 3_utility_per_capita_type_1-values, cache=TRUE}
exp_utility_per_capita_type_1_name <- "utility_per_capita_type_1"

exp_utility_per_capita_type_1_expDataFileName = paste0(dataDirectory, exp_utility_per_capita_type_1_name,'.RData')
exp_utility_per_capita_type_1_plotName = paste0(plotDirectory, exp_utility_per_capita_type_1_name, "-tripleRaster_twoParameters.png")

exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 15)
exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 15)
```

```{r 3_utility_per_capita_type_1, cache=TRUE, dependson=c('3_default-values','3_utility_per_capita_type_1-values'), include=FALSE}
if(!file.exists(exp_utility_per_capita_type_1_expDataFileName))
{
  exp_utility_per_capita_type_1 <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_per_capita_type_1, file = exp_utility_per_capita_type_1_expDataFileName)
}
```

```{r 3_exp_utility_per_capita_type_1-load, include=FALSE}
# load
load(exp_utility_per_capita_type_1_expDataFileName)
```

```{r 3_utility_per_capita_type_1-plot, include=FALSE, cache=TRUE, dependson='3_utility_per_capita_type_1'}
plotScale = 100 / length(exp_utility_per_capita_type_1_humans_to_plants_values)

png(exp_utility_per_capita_type_1_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_per_capita_type_1, 
                           parameter_x = 'utility_per_capita_type_1_humans_to_plants', 
                           parameter_y = 'utility_per_capita_type_1_plants_to_humans', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility per capita of type 1 humans to plants (', bar(U)['H1P'], ')')),
                           parameter_y_label = expression(paste('utility per capita of type 1 plants to humans (  ', bar(U)['P1H'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_utility_per_capita_type_1-plot-print, echo=FALSE, dependson='3_utility_per_capita_type_1-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_per_capita_type_1_plotName)
```

\newpage

### Utility per capita from type n humans and plants ($\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{H_{n}P}$ x $\bar{U}_{P_{n}H}$}

```{r 3_utility_per_capita_type_n-plot-print2, echo=FALSE, dependson='3_utility_per_capita_type_n-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_per_capita_type_n_plotName)
```

\newpage

### Utility per capita from humans to plants ($\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$)
\sectionmark{$\bar{U}_{H_{1}P}$ x $\bar{U}_{H_{n}P}$}

```{r 3_utility_per_capita_type_humans_to_plants-values, cache=TRUE}
exp_utility_per_capita_type_humans_to_plants_name <- "utility_per_capita_type_humans_to_plants"

exp_utility_per_capita_type_humans_to_plants_expDataFileName = paste0(dataDirectory, exp_utility_per_capita_type_humans_to_plants_name,'.RData')
exp_utility_per_capita_type_humans_to_plants_plotName = paste0(plotDirectory, exp_utility_per_capita_type_humans_to_plants_name, "-tripleRaster_twoParameters.png")

exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 15)
exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 15)
```

```{r 3_utility_per_capita_type_humans_to_plants, cache=TRUE, dependson=c('3_default-values','3_utility_per_capita_type_humans_to_plants-values'), include=FALSE}
if(!file.exists(exp_utility_per_capita_type_humans_to_plants_expDataFileName))
{
  exp_utility_per_capita_type_humans_to_plants <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_per_capita_type_humans_to_plants, file = exp_utility_per_capita_type_humans_to_plants_expDataFileName)
}
```

```{r 3_exp_utility_per_capita_type_humans_to_plants-load, include=FALSE}
# load
load(exp_utility_per_capita_type_humans_to_plants_expDataFileName)
```

```{r 3_utility_per_capita_type_humans_to_plants-plot, include=FALSE, cache=TRUE, dependson='3_utility_per_capita_type_humans_to_plants'}
plotScale = 100 / length(exp_utility_per_capita_type_1_humans_to_plants_values)

png(exp_utility_per_capita_type_humans_to_plants_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_per_capita_type_humans_to_plants, 
                            parameter_x = 'utility_per_capita_type_1_humans_to_plants', 
                            parameter_y = 'utility_per_capita_type_n_humans_to_plants', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility per capita of type 1 humans to plants (', bar(U)['H1P'], ')')),
                            parameter_y_label = expression(paste('utility per capita of type n humans to plants (  ', bar(U)['HnP'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                            plot_scale = plotScale)
dev.off()
```

```{r 3_utility_per_capita_type_humans_to_plants-plot-print, echo=FALSE, dependson='3_utility_per_capita_type_humans_to_plants-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_per_capita_type_humans_to_plants_plotName)
```

\newpage

### Utility per capita from plants to humans ($\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$)
\sectionmark{$\bar{U}_{P_{1}H}$ x $\bar{U}_{P_{n}H}$}

```{r 3_utility_per_capita_type_plants_to_humans-values, cache=TRUE}
exp_utility_per_capita_type_plants_to_humans_name <- "utility_per_capita_type_plants_to_humans"

exp_utility_per_capita_type_plants_to_humans_expDataFileName = paste0(dataDirectory, exp_utility_per_capita_type_plants_to_humans_name,'.RData')
exp_utility_per_capita_type_plants_to_humans_plotName = paste0(plotDirectory, exp_utility_per_capita_type_plants_to_humans_name, "-tripleRaster_twoParameters.png")

exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 15)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 15)
```

```{r 3_utility_per_capita_type_plants_to_humans, cache=TRUE, dependson=c('3_default-values','3_utility_per_capita_type_plants_to_humans-values'), include=FALSE}
if(!file.exists(exp_utility_per_capita_type_plants_to_humans_expDataFileName))
{
  exp_utility_per_capita_type_plants_to_humans <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_per_capita_type_plants_to_humans, file = exp_utility_per_capita_type_plants_to_humans_expDataFileName)
}
```

```{r 3_exp_utility_per_capita_type_plants_to_humans-load, include=FALSE}
# load
load(exp_utility_per_capita_type_plants_to_humans_expDataFileName)
```

```{r 3_utility_per_capita_type_plants_to_humans-plot, include=FALSE, cache=TRUE, dependson='3_utility_per_capita_type_plants_to_humans'}
plotScale = 100 / length(exp_utility_per_capita_type_1_plants_to_humans_values)

png(exp_utility_per_capita_type_plants_to_humans_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_per_capita_type_plants_to_humans, 
                            parameter_x = 'utility_per_capita_type_1_plants_to_humans', 
                            parameter_y = 'utility_per_capita_type_n_plants_to_humans', 
                            variable_1 = 'coevolution_coefficient_humans', 
                            variable_2 = 'coevolution_coefficient_plants',
                            variable_3 = 'time_end',
                            parameter_x_label = expression(paste('utility per capita of type 1 plants to humans (', bar(U)['P1H'], ')')),
                            parameter_y_label = expression(paste('utility per capita of type n plants to humans (  ', bar(U)['PnH'], ')')),
                            variable_1_label = expression('coevo'[H]),
                            variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                            plot_scale = plotScale)
dev.off()
```

```{r 3_utility_per_capita_type_plants_to_humans-plot-print, echo=FALSE, dependson='3_utility_per_capita_type_plants_to_humans-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_per_capita_type_plants_to_humans_plotName)
```

\newpage

### Utility of other resources to type 1 humans and plants ($U_{bH_{1}}$ x $U_{bP_{1}}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bP_{1}}$}

```{r 3_utility_other_to_type_1-values, cache=TRUE}
exp_utility_other_to_type_1_name <- "utility_other_to_type_1"

exp_utility_other_to_type_1_expDataFileName = paste0(dataDirectory, exp_utility_other_to_type_1_name,'.RData')
exp_utility_other_to_type_1_plotName = paste0(plotDirectory, exp_utility_other_to_type_1_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_1_humans_values <- seq(5, 400, length.out = 15)
exp_utility_other_to_type_1_plants_values <- seq(5, 400, length.out = 15)
```

```{r 3_utility_other_to_type_1, cache=TRUE, dependson=c('3_default-values','3_utility_other_to_type_1-values'), include=FALSE}
if(!file.exists(exp_utility_other_to_type_1_expDataFileName))
{
  exp_utility_other_to_type_1 <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###
    max_area = max_area_default, 
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_other_to_type_1, file = exp_utility_other_to_type_1_expDataFileName)
}
```

```{r 3_exp_utility_other_to_type_1-load, include=FALSE}
# load
load(exp_utility_other_to_type_1_expDataFileName)
```

```{r 3_utility_other_to_type_1-plot, include=FALSE, cache=TRUE, dependson='3_utility_other_to_type_1'}
plotScale = 100 / length(exp_utility_other_to_type_1_humans_values)

png(exp_utility_other_to_type_1_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_other_to_type_1, 
                           parameter_x = 'utility_other_to_type_1_humans', 
                           parameter_y = 'utility_other_to_type_1_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                           parameter_y_label = expression(paste('utility of other to type 1 plants ( ', U['bP1'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_utility_other_to_type_1-plot-print, echo=FALSE, dependson='3_utility_other_to_type_1-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_other_to_type_1_plotName)
```

\newpage

### Utility of other resources to type n humans and plants ($U_{bH_{n}}$ x $U_{bP_{n}}$)
\sectionmark{$U_{bH_{n}}$ x $U_{bP_{n}}$}

```{r 3_utility_other_to_type_n-values, cache=TRUE}
exp_utility_other_to_type_n_name <- "utility_other_to_type_n"

exp_utility_other_to_type_n_expDataFileName = paste0(dataDirectory, exp_utility_other_to_type_n_name,'.RData')
exp_utility_other_to_type_n_plotName = paste0(plotDirectory, exp_utility_other_to_type_n_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_n_humans_values <- seq(5, 400, length.out = 15)
exp_utility_other_to_type_n_plants_values <- seq(5, 400, length.out = 15)
```

```{r 3_utility_other_to_type_n, cache=TRUE, dependson=c('3_default-values','3_utility_other_to_type_n-values'), include=FALSE}
if(!file.exists(exp_utility_other_to_type_n_expDataFileName))
{
  exp_utility_other_to_type_n <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ###
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_other_to_type_n, file = exp_utility_other_to_type_n_expDataFileName)
}
```

```{r 3_exp_utility_other_to_type_n-load, include=FALSE}
# load
load(exp_utility_other_to_type_n_expDataFileName)
```

```{r 3_utility_other_to_type_n-plot, include=FALSE, cache=TRUE, dependson='3_utility_other_to_type_n'}
plotScale = 100 / length(exp_utility_other_to_type_n_humans_values)

png(exp_utility_other_to_type_n_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_other_to_type_n, 
                           parameter_x = 'utility_other_to_type_n_humans', 
                           parameter_y = 'utility_other_to_type_n_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type n humans (', U['bHn'], ')')),
                           parameter_y_label = expression(paste('utility of other to type n plants ( ', U['bPn'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_utility_other_to_type_n-plot-print, echo=FALSE, dependson='3_utility_other_to_type_n-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_other_to_type_n_plotName)
```

\newpage

### Utility of other resources to humans ($U_{bH_{1}}$ x $U_{bH_{n}}$)
\sectionmark{$U_{bH_{1}}$ x $U_{bH_{n}}$}

```{r 3_utility_other_to_type_humans-values, cache=TRUE}
exp_utility_other_to_type_humans_name <- "utility_other_to_type_humans"

exp_utility_other_to_type_humans_expDataFileName = paste0(dataDirectory, exp_utility_other_to_type_humans_name,'.RData')
exp_utility_other_to_type_humans_plotName = paste0(plotDirectory, exp_utility_other_to_type_humans_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_1_humans_values <- seq(5, 400, length.out = 15)
exp_utility_other_to_type_n_humans_values <- seq(5, 400, length.out = 15)
```

```{r 3_utility_other_to_type_humans, cache=TRUE, dependson=c('3_default-values','3_utility_other_to_type_humans-values'), include=FALSE}
if(!file.exists(exp_utility_other_to_type_humans_expDataFileName))
{
  exp_utility_other_to_type_humans <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_other_to_type_humans, file = exp_utility_other_to_type_humans_expDataFileName)
}
```

```{r 3_exp_utility_other_to_type_humans-load, include=FALSE}
# load
load(exp_utility_other_to_type_humans_expDataFileName)
```

```{r 3_utility_other_to_type_humans-plot, include=FALSE, cache=TRUE, dependson='3_utility_other_to_type_humans'}
plotScale = 100 / length(exp_utility_other_to_type_n_humans_values)

png(exp_utility_other_to_type_humans_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_other_to_type_humans, 
                           parameter_x = 'utility_other_to_type_1_humans', 
                           parameter_y = 'utility_other_to_type_n_humans', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                           parameter_y_label = expression(paste('utility of other to type n humans ( ', U['bHn'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_utility_other_to_type_humans-plot-print, echo=FALSE, dependson='3_utility_other_to_type_humans-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_other_to_type_humans_plotName)
```

\newpage

### Utility of other resources to plants ($U_{bP_{1}}$ x $U_{bP_{n}}$)
\sectionmark{$U_{bP_{1}}$ x $U_{bP_{n}}$}

```{r 3_utility_other_to_type_plants-values, cache=TRUE}
exp_utility_other_to_type_plants_name <- "utility_other_to_type_plants"

exp_utility_other_to_type_plants_expDataFileName = paste0(dataDirectory, exp_utility_other_to_type_plants_name,'.RData')
exp_utility_other_to_type_plants_plotName = paste0(plotDirectory, exp_utility_other_to_type_plants_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_1_plants_values <- seq(5, 400, length.out = 15)
exp_utility_other_to_type_n_plants_values <- seq(5, 400, length.out = 15)
```

```{r 3_utility_other_to_type_plants, cache=TRUE, dependson=c('3_default-values','3_utility_other_to_type_plants-values'), include=FALSE}
if(!file.exists(exp_utility_other_to_type_plants_expDataFileName))
{
  exp_utility_other_to_type_plants <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                   
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,                                
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ###
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,                               
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_utility_other_to_type_plants, file = exp_utility_other_to_type_plants_expDataFileName)
}
```

```{r 3_exp_utility_other_to_type_plants-load, include=FALSE}
# load
load(exp_utility_other_to_type_plants_expDataFileName)
```

```{r 3_utility_other_to_type_plants-plot, include=FALSE, cache=TRUE, dependson='3_utility_other_to_type_plants'}
plotScale = 100 / length(exp_utility_other_to_type_n_plants_values)

png(exp_utility_other_to_type_plants_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_utility_other_to_type_plants, 
                           parameter_x = 'utility_other_to_type_1_plants', 
                           parameter_y = 'utility_other_to_type_n_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type 1 plants (', U['bP1'], ')')),
                           parameter_y_label = expression(paste('utility of other to type n plants ( ', U['bPn'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_utility_other_to_type_plants-plot-print, echo=FALSE, dependson='3_utility_other_to_type_plants-plot', out.width = '100%'}
knitr::include_graphics(exp_utility_other_to_type_plants_plotName)
```

### Utility of other resources to type 1 humans and utility per capita of type 1 humans  to plants ($U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$)
\sectionmark{$U_{bH_{1}}$ x $\bar{U}_{H_{1}P}$}

```{r 3_type_1_humans_traits-values, cache=TRUE}
exp_type_1_humans_traits_name <- "type_1_humans_traits"

exp_type_1_humans_traits_expDataFileName = paste0(dataDirectory, exp_type_1_humans_traits_name,'.RData')
exp_type_1_humans_traits_plotName = paste0(plotDirectory, exp_type_1_humans_traits_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_1_humans_values <- seq(5, 400, length.out = 15)
exp_utility_per_capita_type_1_humans_to_plants_values <- seq(0, 3, length.out = 15)
```

```{r 3_type_1_humans_traits, cache=TRUE, dependson=c('3_default-values','3_type_1_humans_traits-values'), include=FALSE}
if(!file.exists(exp_type_1_humans_traits_expDataFileName))
{
  exp_type_1_humans_traits <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default,
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                                  
    utility_per_capita_type_1_humans_to_plants = exp_utility_per_capita_type_1_humans_to_plants_values, ###                                 
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = exp_utility_other_to_type_1_humans_values, ###
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                                 
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_type_1_humans_traits, file = exp_type_1_humans_traits_expDataFileName)
}
```

```{r 3_exp_type_1_humans_traits-load, include=FALSE}
# load
load(exp_type_1_humans_traits_expDataFileName)
```

```{r 3_type_1_humans_traits-plot, include=FALSE, cache=TRUE, dependson='3_type_1_humans_traits'}
plotScale = 100 / length(exp_utility_per_capita_type_1_humans_to_plants_values)

png(exp_type_1_humans_traits_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_type_1_humans_traits, 
                           parameter_x = 'utility_other_to_type_1_humans', 
                           parameter_y = 'utility_per_capita_type_1_humans_to_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type 1 humans (', U['bH1'], ')')),
                           parameter_y_label = expression(paste('utility per capita of type 1 humans to plants (  ', bar(U)['H1P'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_type_1_humans_traits-plot-print, echo=FALSE, dependson='3_type_1_humans_traits-plot', out.width = '100%'}
knitr::include_graphics(exp_type_1_humans_traits_plotName)
```

\newpage

### Utility of other resources to type 1 plants and utility per capita of type 1 plants to humans ($U_{bP_{1}}$ x $\bar{U}_{P_{1}H}$)

```{r 3_type_1_plants_traits-values, cache=TRUE}
exp_type_1_plants_traits_name <- "type_1_plants_traits"

exp_type_1_plants_traits_expDataFileName = paste0(dataDirectory, exp_type_1_plants_traits_name,'.RData')
exp_type_1_plants_traits_plotName = paste0(plotDirectory, exp_type_1_plants_traits_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_1_plants_values <- seq(5, 400, length.out = 15)
exp_utility_per_capita_type_1_plants_to_humans_values <- seq(0, 3, length.out = 15)
```

```{r 3_type_1_plants_traits, cache=TRUE, dependson=c('3_default-values','3_type_1_plants_traits-values'), include=FALSE}
if(!file.exists(exp_type_1_plants_traits_expDataFileName))
{
  exp_type_1_plants_traits <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default,
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = exp_utility_per_capita_type_1_plants_to_humans_values, ###                              
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                 
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,
    utility_other_to_type_1_plants = exp_utility_other_to_type_1_plants_values, ###                             
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_type_1_plants_traits, file = exp_type_1_plants_traits_expDataFileName)
}
```

```{r 3_exp_type_1_plants_traits-load, include=FALSE}
# load
load(exp_type_1_plants_traits_expDataFileName)
```

```{r 3_type_1_plants_traits-plot, include=FALSE, cache=TRUE, dependson='3_type_1_plants_traits'}
plotScale = 100 / length(exp_utility_per_capita_type_1_humans_to_plants_values)

png(exp_type_1_plants_traits_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_type_1_plants_traits, 
                           parameter_x = 'utility_other_to_type_1_plants', 
                           parameter_y = 'utility_per_capita_type_1_plants_to_humans', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type 1 plants (', U['bP1'], ')')),
                           parameter_y_label = expression(paste('utility per capita of type 1 plants to humans (  ', bar(U)['P1H'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_type_1_plants_traits-plot-print, echo=FALSE, dependson='3_type_1_plants_traits-plot', out.width = '100%'}
knitr::include_graphics(exp_type_1_plants_traits_plotName)
```

\newpage

### Utility of other resources to type n humans and utility per capita of type n humans to plants ($U_{bH_{n}}$ x $\bar{U}_{H_{n}P}$)

```{r 3_type_n_humans_traits-values, cache=TRUE}
exp_type_n_humans_traits_name <- "type_n_humans_traits"

exp_type_n_humans_traits_expDataFileName = paste0(dataDirectory, exp_type_n_humans_traits_name,'.RData')
exp_type_n_humans_traits_plotName = paste0(plotDirectory, exp_type_n_humans_traits_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_n_humans_values <- seq(5, 400, length.out = 15)
exp_utility_per_capita_type_n_humans_to_plants_values <- seq(0, 3, length.out = 15)
```

```{r 3_type_n_humans_traits, cache=TRUE, dependson=c('3_default-values','3_type_n_humans_traits-values'), include=FALSE}
if(!file.exists(exp_type_n_humans_traits_expDataFileName))
{
  exp_type_n_humans_traits <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default,
    utility_per_capita_type_n_plants_to_humans = utility_per_capita_type_n_plants_to_humans_default,
    utility_per_capita_type_n_humans_to_plants = exp_utility_per_capita_type_n_humans_to_plants_values, ###
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                              
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                 
    utility_other_to_type_n_humans = exp_utility_other_to_type_n_humans_values, ###
    utility_other_to_type_n_plants = utility_other_to_type_n_plants_default, 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                             
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_type_n_humans_traits, file = exp_type_n_humans_traits_expDataFileName)
}
```

```{r 3_exp_type_n_humans_traitsload, include=FALSE}
# load
load(exp_type_n_humans_traits_expDataFileName)
```

```{r 3_type_n_humans_traits-plot, include=FALSE, cache=TRUE, dependson='3_type_n_humans_traits'}
plotScale = 100 / length(exp_utility_per_capita_type_1_humans_to_plants_values)

png(exp_type_n_humans_traits_plotName,
    width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_type_n_humans_traits, 
                           parameter_x = 'utility_other_to_type_n_humans', 
                           parameter_y = 'utility_per_capita_type_n_humans_to_plants', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type n humans (', U['bHn'], ')')),
                           parameter_y_label = expression(paste('utility per capita of type n humans to plants (  ', bar(U)['HnP'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_type_n_humans_traits-plot-print, echo=FALSE, dependson='3_type_n_humans_traits-plot', out.width = '100%'}
knitr::include_graphics(exp_type_n_humans_traits_plotName)
```

\newpage

### Utility of other resources to type n plants and utility per capita of type n plants to humans ($U_{bP_{n}}$ x $\bar{U}_{P_{n}H}$)

```{r 3_type_n_plants_traits-values, cache=TRUE}
exp_type_n_plants_traits_name <- "type_n_plants_traits"

exp_type_n_plants_traits_expDataFileName = paste0(dataDirectory, exp_type_n_plants_traits_name,'.RData')
exp_type_n_plants_traits_plotName = paste0(plotDirectory, exp_type_n_plants_traits_name, "-tripleRaster_twoParameters.png")

exp_utility_other_to_type_n_plants_values <- seq(5, 400, length.out = 15)
exp_utility_per_capita_type_n_plants_to_humans_values <- seq(0, 3, length.out = 15)
```

```{r 3_type_n_plants_traits, cache=TRUE, dependson=c('3_default-values','3_type_n_plants_traits-values'), include=FALSE}
if(!file.exists(exp_type_n_plants_traits_expDataFileName))
{
  exp_type_n_plants_traits <- hpcModel.exploration(
    initial_population_humans = initial_population_humans_default,
    initial_population_plants = initial_population_plants_default,
    number_types_humans = number_types_humans_default,         
    number_types_plants = number_types_plants_default,        
    undirected_variation_humans = undirected_variation_humans_default,
    undirected_variation_plants = undirected_variation_plants_default,
    intrinsic_growth_rate_humans = intrinsic_growth_rate_humans_default, 
    intrinsic_growth_rate_plants = intrinsic_growth_rate_plants_default, 
    utility_per_capita_type_n_plants_to_humans = exp_utility_per_capita_type_n_plants_to_humans_values, ###
    utility_per_capita_type_n_humans_to_plants = utility_per_capita_type_n_humans_to_plants_default,
    utility_per_capita_type_1_plants_to_humans = utility_per_capita_type_1_plants_to_humans_default,                              
    utility_per_capita_type_1_humans_to_plants = utility_per_capita_type_1_humans_to_plants_default,                                 
    utility_other_to_type_n_humans = utility_other_to_type_n_humans_default,
    utility_other_to_type_n_plants = exp_utility_other_to_type_n_plants_values, ### 
    utility_other_to_type_1_humans = utility_other_to_type_1_humans_default,
    utility_other_to_type_1_plants = utility_other_to_type_1_plants_default,                             
    max_area = max_area_default,
    # settings 
    # simulation flow & data
    max_iterations = max_iterations_default,
    reltol_exponential = reltol_exponential_default,
    coevolution_threshold = coevolution_threshold_default,
    messages = messages_default
  )
  # save
  save(exp_type_n_plants_traits, file = exp_type_n_plants_traits_expDataFileName)
}
```

```{r 3_exp_type_n_plants_traits.HnPload, include=FALSE}
# load
load(exp_type_n_plants_traits_expDataFileName)
```

```{r 3_type_n_plants_traits-plot, include=FALSE, cache=TRUE, dependson='3_type_n_plants_traits'}
plotScale = 100 / length(exp_utility_per_capita_type_1_humans_to_plants_values)

png(exp_type_n_plants_traits_plotName, width = 100 * plotScale, height = 100 * plotScale)
tripleRaster_twoParameters(exp_type_n_plants_traits, 
                           parameter_x = 'utility_other_to_type_n_plants', 
                           parameter_y = 'utility_per_capita_type_n_plants_to_humans', 
                           variable_1 = 'coevolution_coefficient_humans', 
                           variable_2 = 'coevolution_coefficient_plants',
                           variable_3 = 'time_end',
                           parameter_x_label = expression(paste('utility of other to type n plants (', U['bPn'], ')')),
                           parameter_y_label = expression(paste('utility per capita of type n plants to humans (  ', bar(U)['PnH'], ')')),
                           variable_1_label = expression('coevo'[H]),
                           variable_2_label = expression('coevo'[P]),
                           variable_3_label = expression(t['end']),
                           plot_scale = plotScale)
dev.off()
```

```{r 3_type_n_plants_traits-plot-print, echo=FALSE, dependson='3_type_n_plants_traits-plot', out.width = '100%'}
knitr::include_graphics(exp_type_n_plants_traits_plotName)
```

\newpage
